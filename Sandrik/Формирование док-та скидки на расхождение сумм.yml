%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 222916090_1816166686
  Name: "Формирование док-та скидки на расхождение сумм"
  Caption: "Формирование док-та скидки на расхождение сумм"
  Version: "1.0.0.1"
  Optional: False
  Internal: True
  MD5: 15A1863DFF1A95C6C277641E3DAFBEC1
Uses: 
  - "148919179_537677461 GS.Общее.Деноминация 2016"
Objects: 
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 222858069_1087481319
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "San_createDisc"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "UNKNOWN"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-01-17T10:35:09+03:00
      DISPLAYSCRIPT: | 
        SAN_CREATEDISC
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QEAAAAU0VMRgQAAABTRUxGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEZOU1RGTFBS
      SCRIPT: | 
        Option Explicit
        ' создает документ Предоставление скидки
        Function San_createDisc(Self)
        
          dim Creator, Counter, IBSQL, Object, DetailObject
          set Creator = new TCreator
          
          set Object = Self
          
          if not Assigned(Self.OwnerForm) Then exit function
          set DetailObject = Self.OwnerForm.gdcDetailObject
          
          
          
          set IBSQL = Creator.GetObject(nil, "TIBSQL", "")
          IBSQL.Transaction =  Self.ReadTransaction
          IBSQL.SQL.Text = _
          "EXECUTE BLOCK ( " & _
          "    DOCKEY INTEGER = :DOCKEY) " & _
          "RETURNS ( " & _
          "    SUMNCU DECIMAL(18, 8), " & _
          "    SUMBUYNCU DECIMAL(18, 4), " & _
          "    SUMVAT DECIMAL(18, 4), " & _
          "    SUMWITHVAT DECIMAL(18, 4), " & _
          "    RETAILSUM DECIMAL(18, 8)) " & _
          " AS " & _
          "DECLARE VARIABLE QUANTITY DECIMAL(18,4); " & _
          "DECLARE VARIABLE COSTRETAILNCU DECIMAL(18,4); " & _
          "DECLARE VARIABLE COSTTRWITHNDS DECIMAL(18,4); " & _
          "DECLARE VARIABLE COSTTRADE DECIMAL(18,4); " & _
          "DECLARE VARIABLE COSTBYUNCU DECIMAL(18,4); " & _
          "DECLARE VARIABLE COSTTRADENCU DECIMAL(18,4); " & _
          "DECLARE VARIABLE SUMNDS DECIMAL(18,4); " & _
          "DECLARE VARIABLE BUYSUM DECIMAL(18,4); " & _
          "DECLARE VARIABLE RETSUM DECIMAL(18,4); " & _
          "DECLARE VARIABLE VAT DECIMAL(18,4); " & _
          "DECLARE VARIABLE SUMTR DECIMAL(18,4); " & _
          "DECLARE VARIABLE SNCU DECIMAL(18,4); " & _
          "DECLARE VARIABLE DID INTEGER; " & _
          "BEGIN " & _
          "SNCU =0; " & _
          "RETAILSUM = 0; " & _
          "  RETSUM = 0; " & _
          "  SUMNCU = 0; " & _
          "  SUMVAT = 0; " & _
          "  SUMWITHVAT =0; " & _
          "  COSTTRADE = 0; " & _
          "  SUMBUYNCU = 0; " & _
          "  VAT = 0; " & _
          "  FOR " & _
          "    SELECT " & _
          "     l.DOCUMENTKEY, " & _
          "     L.quantity, " & _
          "     ROUND(c.USR$INV_COSTTRADENCU,2), " & _
          "     (L.quantity*coalesce(c.usr$INV_COSTBUYNCU,0)), " & _
          "      L.quantity*ROUND(c.USR$INV_COSTRETAILNCU,2), " & _
          "      /*(L.quantity*ROUND(c.USR$INV_COSTTRADENCU,2)), " & _
          "      (L.quantity*ROUND(c.USR$INV_COSTTRADENCU,2)* c.usr$inv_sellnds/100),*/ " & _
          "      SUM(l.USR$SUMNDSNCU), " & _
          "      SUM(l.USR$SUMNCU), " & _
          "      SUM(l.USR$SUMWITHNDSNCU) " & _
          "     FROM USR$INV_SELLBILLLINE L " & _
          "    JOIN inv_card c ON c.id = L.fromcardkey " & _
          "    join gd_good g on g.id = c.goodkey " & _
          "    WHERE L.masterkey = :DOCKEY " & _
          "    Group by 1,2,3,4,5 " & _
          "        INTO " & _
          "         :DID, " & _
          "         :QUANTITY, " & _
          "         :COSTTRADE, " & _
          "         :BUYSUM, " & _
          "         :RETSUM, " & _
          "         :VAT, " & _
          "         :SNCU, " & _
          "         :SUMTR " & _
          "  DO " & _
          "  BEGIN " & _
          "    SUMNCU = SUMNCU + ROUND(SNCU,2); " & _
          "    VAT= ROUND(VAT,2); " & _
          "    RETAILSUM = RETAILSUM + RETSUM; " & _
          "    SUMVAT = SUMVAT + VAT; " & _
          "    SUMVAT = ROUND(SUMVAT,2); " & _
          "    SUMBUYNCU = SUMBUYNCU + BUYSUM; " & _
          "    SUMWITHVAT = SUMWITHVAT + ROUND(SUMTR,2); " & _
          " " & _
          " " & _
          "    IF (COSTTRADE IS NOT NULL) THEN " & _
          "    BEGIN " & _
          " " & _
          "    END " & _
          "  END " & _
          "  SUSPEND; " & _
          "END "
          IBSQL.ParamByName("DOCKEY").AsInteger = Object.ID
          IBSQL.ExecQuery
          
          ' нашли расхождение - создаем документ
          IF IBSQL.FieldByName("RETAILSUM").asCurrency <> IBSQL.FieldByName("SUMWITHVAT").asCurrency Then
        
            dim Transaction
            set Transaction = Creator.GetObject(nil, "TIBTransaction", "")
            Transaction.DefaultDatabase = gdcBaseManager.Database
            Transaction.StartTransaction
        
            Dim gdcO, gdcUserDocumentDS
            Set gdcO = Creator.GetObject(nil, "TgdcUserDocument", "")
            gdcO.Transaction = Transaction
            gdcO.ReadTransaction = Transaction
            gdcO.SubType = "147077505_358651009"
          '  gdcO.ID = Object.ID
            gdcO.ExtraConditions.Clear
            gdcO.ExtraConditions.Add("  U.USR$SELLDOCKEY =" & CSTR(Object.ID))
            gdcO.Open
            
            set gdcUserDocumentDS = Creator.GetObject(nil, "TDataSource", "")
            set gdcUserDocumentDS.Dataset = gdcO
        
            Dim gdcDO
            Set gdcDO = Creator.GetObject(nil, "TgdcUserDocumentLine", "")
            gdcDO.Transaction = Transaction
            gdcDO.ReadTransaction = Transaction
            gdcDO.SubType = "147077505_358651009"
            gdcDO.DetailField = "Parent"
            gdcDO.MasterField = "ID"
            gdcDO.SubSet = "ByParent"
            'gdcDO.Parent = gdcO.ID
            gdcDO.MasterSource = gdcUserDocumentDS
            gdcDO.Open
            
            dim SumDisc
            SumDisc = IBSQL.FieldByName("SUMWITHVAT").asCurrency - IBSQL.FieldByName("RETAILSUM").asCurrency
            
            if gdcO.EOF Then
              gdcO.Insert
              gdcO.FieldByName("USR$SELLDOCKEY").asInteger =  Object.ID
              gdcO.FieldByName("DOCUMENTDATE").asDateTime = Object.FieldByName("DOCUMENTDATE").asDateTime
              gdcO.FieldByName("number").asString = Object.FieldByName("number").asString
              gdcO.FieldByName("USR$OBJECT").asString = "расхождение сумм с НДС и сумм в розн.ценах"
              gdcO.FieldByName("USR$SUMSKIDKA").asCurrency = SumDisc
              gdcO.FieldByName("USR$DEPOTKEY").asInteger =  Object.FieldByName("USR$MAINDEPOTKEY").asInteger
              gdcO.Post
              
                gdcDO.insert
                gdcDO.FieldByName("USR$GOODKEY").asInteger = gdcBaseManager.GetIDByRUIDString("222858858_1087481319")
                gdcDO.FieldByName("USR$RET_SUM").asCurrency = SumDisc
                gdcDO.Post
        
            else
              gdcO.Edit
                gdcO.FieldByName("USR$SUMSKIDKA").asCurrency = SumDisc
                gdcDO.Edit
                gdcDO.FieldByName("USR$RET_SUM").asCurrency = SumDisc
                gdcDO.Post
              gdcO.Post
            end if
            gdcO.CreateEntry
            
            if Transaction.inTransaction then Transaction.Commit
          END IF
        
        
        End Function
        
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147077540_358651009
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 210684657_640936098
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_frmUserComplexDocument147077505_358651009)"
      DESCRIPTION: ~
      USERGROUPNAME: "147077540_358651009"
      EDITIONDATE: 2000-01-01T00:00:00+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 147077539_358651009
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 210684657_640936098
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_frmUserComplexDocument147077505_358651009"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2005-04-20T22:45:45+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147077529_358651009
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 210684657_640936098
    Fields: 
      PARENT: ~
      NAME: "gdc_frmUserComplexDocument147077505_358651009"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "147077539_358651009 Локальные макросы"
      OBJECTNAME: "gdc_frmUserComplexDocument147077505_358651009"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "147077540_358651009 Отчеты(gdc_frmUserComplexDocument147077505_358651009)"
      SUBTYPE: ""
      EDITIONDATE: 2005-04-20T22:45:45+03:00
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 210684667_640936098
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 210684657_640936098
    Fields: 
      NAME: "Акт по переоценкам (роз. склад) учетная 1210684667_640936098"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR"
      EDITIONDATE: 2019-08-08T16:29:14+03:00
      TEMPLATEDATA: !!binary > 
        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
        AAAAAAAAAAAADgAABgBNZW1vMjMAAgCEAgAAxwIAAEEAAAAQAAAAQwAPAAEAAAAAAAAAAAD///8f
        LAICAQAAAAEAHgBbKC0xKSAqIFtUTkxJUy4iVVNSJFJFVF9TVU0iXV0AAAAA//8AAAAAAAIAAAAB
        AAAAABYFAEFyaWFsAAgAAAAAAAAAAAABAAAAzAACAAAAAAD///8AAAAAAgAAAAAAAAAAAJAOAAAG
        AE1lbW8yNAACAIQCAABcAgAAQQAAABwAAAADAA8AAQAAAAAAAAAAAP///x8sAgAAAAAAAQAQANHz
        7OzgIO/l8OXu9uXt6ugAAAAA//8AAAAAAAIAAAABAAAAABYFAEFyaWFsAAgAAAAAAAAAAAACAAAA
        zAACAAAAAAD///8AAAAAAgAAAAAAAAAAAHUPAAAGAE1lbW8yNQACAIQCAAD1AgAAQQAAABAAAABD
        AA8AAQAAAAAAAAAAAP///x8sAgIBAAAAAQAiAFtTVU0oKC0xKSAqW1ROTElTLiJVU1IkUkVUX1NV
        TSJdKV0AAwAFAGJlZ2luDTMAYWxsc3VtOj1yb3VuZChbU1VNKCgtMSkgKltUTkxJUy4iVVNSJFJF
        VF9TVU0iXSldLDIpDQMAZW5kAP//AAAAAAACAAAAAQAAAAAWBQBBcmlhbAAIAAAAAgAAAAAAAQAA
        AMwAAgAAAAAA////AAAAAAIAAAAAAAAACgsAVGZyUmljaFZpZXcAADUSAAAFAFJpY2gyAAIANgAA
        ALgBAACcAgAAKAAAAAEAAAABAAAAAAAAAAAA////HywCAAAAAAAAAAAAAAD//wAAAAAAAgAAAAEA
        AAAEFgE1EgAAe1xydGYxXGFuc2lcYW5zaWNwZzEyNTFcZGVmZjBcZGVmbGFuZzEwNDl7XGZvbnR0
        Ymx7XGYwXGZzd2lzc1xmcHJxMlxmY2hhcnNldDIwNHtcKlxmbmFtZSBBcmlhbDt9QXJpYWwgQ1lS
        O317XGYxXGZzd2lzc1xmcHJxMlxmY2hhcnNldDAgQXJpYWw7fX0NCntcY29sb3J0YmwgO1xyZWQw
        XGdyZWVuMFxibHVlMDt9DQpcdmlld2tpbmQ0XHVjMVxwYXJkXGYwXGZzMjBcJ2VkXCdlMCBcJ2Vl
        XCdmMVwnZWRcJ2VlXCdlMlwnZTBcJ2VkXCdlOFwnZTggXCdmMFwnZTBcJ2YxXCdlZlwnZWVcJ2Yw
        XCdmZlwnZTZcJ2U1XCdlZFwnZThcJ2ZmIFwnYjkgX19fX19fX19fX19fXyBcJ2VlXCdmMiBfX19f
        X19fX19fX19fX19fX19fX1xsYW5nMTAzM1xmMSAgXGxhbmcxMDQ5XGYwXCdlZlwnZjBcJ2VlXCdl
        OFwnZTdcJ2UyXCdlNVwnZWJcJ2UwIFwnZjFcJ2VkXCdmZlwnZjJcJ2U4XCdlNSBcJ2Y0XCdlMFwn
        ZWFcJ2YyXCdlOFwnZjdcJ2U1XCdmMVwnZWFcJ2U4XCdmNSBcJ2VlXCdmMVwnZjJcJ2UwXCdmMlwn
        ZWFcJ2VlXCdlMiBcJ2U4IFwnZWZcJ2U1XCdmMFwnZTVcJ2VlXCdmNlwnZTVcJ2VkXCdlYVwnZjMg
        XCdmMlwnZWVcJ2UyXCdlMFwnZjBcJ2VlXCdlMlxjZjEgDQpccGFyIH0NCgAAANUSAAAGAE1lbW8y
        OAACABwCAAAsAAAAtAAAABAAAAADAAAAAQAAAAAAAAAAAP///x8sAgAAAAAAAQAgAPHy8C4gW1BB
        R0UjXSDo5yAgW1RPVEFMUEFHRVNdICAgAAAAAP//AAAAAAACAAAAAQAAAAAWBQBBcmlhbAAIAAAA
        AAAAAAAAAQAAAMwAAgAAAAAA////AAAAAAIAAAAAAAAAAABWEwAABgBNZW1vMjkAAgA2AAAAXAIA
        ABgAAAAcAAAAAwAPAAEAAAAAAAAAAAD///8fLAIAAAAAAAEAAQC5AAAAAP//AAAAAAACAAAAAQAA
        AAAWBQBBcmlhbAAJAAAAAAAAAAAAAgAAAMwAAgAAAAAA////AAAAAAIAAAAAAAAAAADdEwAABgBN
        ZW1vMzAAAgA2AAAAxwIAABgAAAAQAAAAAwAPAAEAAAAAAAAAAAD///8fLAIAAAAAAAEABwBbTElO
        RSNdAAAAAP//AAAAAAACAAAAAQAAAAAWBQBBcmlhbAAHAAAAAAAAAAAAAAAAAMwAAgAAAAAA////
        AAAAAAIAAAAAAAAAAAB9FAAABgBNZW1vODMAAgBBAAAAVQAAAOwAAAAUAAAAAwAAAAEAAAAAAAAA
        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
        FgUAQXJpYWwACAAAAAAAAAAAAAoAAADMAAIAAAAAAP///wAAAAACAAAAAAAAAAABxjYAAAYATWVt
        bzI3AAIAJAAAAP8AAACYAgAAIQAAAAMAAAABAAAAAAAAAAAA////HywCAAAAAAABAD4A0fPs7OAg
        7+Xw5e725e3q6CA6IFthbGxzdW1dICBbU1VNY3VyclNUUjIoMjAwMDEwLGFsbHN1bSx0cnVlKV0A
        AwAFAGJlZ2luDVoAICAvL1tTVU0oKC0xKSAqW1ROTElTLiJVU1IkUkVUX1NVTSJdKV0gICAoW1NV
        TVJVQlNUUihbU1VNKCgtMSkgKltUTkxJUy4iVVNSJFJFVF9TVU0iXSldKV0pDQMAZW5kAP//AAAA
        AAACAAAAAQAAAAAWBQBBcmlhbAAJAAAAAwAAAAAAAAAAAMwAAgAAAAAA////AAAAAAIAAAAAAAAA
        AAHyNwAABgBNZW1vNDIAAgAkAAAAwQAAAJgCAAAeAAAAAwAAAAEAAAAAAAAAAAD///8fLAIAAAAA
        AAEASwDR8+zs4CDk7iDv5fDl7vbl7eroIDogW3N1bWJlZm9yZV0gW1tTVU1jdXJyU1RSMigyMDAw
        MTAsc3VtYmVmb3JlLHRydWUpXV0gICAAAwAFAGJlZ2luDVEALy9bU1VNKFtUTkxJUy4iVVNSJFJF
        VEFJTENPU1QiXSldICAoW1NVTVJVQlNUUihbU1VNKFtUTkxJUy4iVVNSJFJFVEFJTENPU1QiXSld
        KV0pDQMAZW5kAP//AAAAAAACAAAAAQAAAAAWBQBBcmlhbAAJAAAAAwAAAAAAAAAAAMwAAgAAAAAA
        ////AAAAAAIAAAAAAAAAAAFOOQAABgBNZW1vNDMAAgAkAAAA4AAAAJgCAAAeAAAAAwAAAAEAAAAA
        AAAAAAD///8fLAIAAAAAAAEARgDR8+zs4CDv7vHr5SDv5fDl7vbl7eroIDogW3N1bXBvc3RdICBb
        U1VNY3VyclNUUjIoMjAwMDEwLHN1bXBvc3QsdHJ1ZSldAAMABQBiZWdpbg2GACAvL1tTVU0oW1tU
        TkxJUy4iVVNSJFJFVEFJTENPU1QiXSArIFtUTkxJUy4iVVNSJFJFVF9TVU0iXV0pXSAgKFtTVU1S
        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
        rxOY+7VU5UA=
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 210684658_640936098
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 210684657_640936098
    Fields: 
      NAME: "RetailInv_NewCostReport_mat_Copy_11577291210684658_640936098"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147077529_358651009 gdc_frmUserComplexDocument147077505_358651009"
      OBJECTNAME: "gdc_frmUserComplexDocument147077505_358651009"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-01-12T11:24:01+03:00
      DISPLAYSCRIPT: | 
        RETAILINV_NEWCOSTREPORT_MAT_COPY_11577291210684658_640936098
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAYAAABJU1NFTEwRAAAA0u7r/OruIOTu6i3y+yDS0s0AAAAAAAAAAAAAAAAGAAAA
        AAAAAAAAAAAARk5TVFBSU1QJAAAAREVUQUJFR0lOCwAAAMTg8uAg7eD34OvgAAAAAAAAAAAAAAAA
        AgAAAAAAAAAAAgAAAF5SRk5TVFBSU1QHAAAAREFURUVORA4AAADE4PLgIO7q7u334O3o/wAAAAAA
        AAAAAAAAAAIAAAAAAAAAAAIAAABeUkZOU1RQUlNUBAAAAERFUFQNAAAAz+7k8ODn5OXr5e3o5Q4A
        AABnZF9jb250YWN0IGdnMQQAAABuYW1lAgAAAGlkB5kAAAAiZ2cxLmNvbnRhY3R0eXBlID0gNCBh
        bmQgRVhJU1RTIChTRUxFQ1QgY29uLmlkIEZST00gZ2RfY29udGFjdCBjb24gd2hlcmUgY29uLmxi
        IDw9IGdnMS5sYiBhbmQgY29uLnJiID49Z2cxLnJiIGFuZCBjb24uaWQgPSAiK0NTdHIoSUJMb2dp
        bi5Db21wYW55S2V5KSsiKSIIAAAAVkJTY3JpcHQAAAAARk5TVFBSU1QFAAAAUENPTVQVAAAAz/Dl
        5PHl5ODy5ev8IOru7Ojx8ejoDgAAAGdkX2NvbnRhY3QgZ2cxBAAAAE5BTUUCAAAASUQHmQAAACJn
        ZzEuY29udGFjdHR5cGUgPSAyIGFuZCBFWElTVFMgKFNFTEVDVCBjb24uaWQgRlJPTSBnZF9jb250
        YWN0IGNvbiB3aGVyZSBjb24ubGIgPD0gZ2cxLmxiIGFuZCBjb24ucmIgPj1nZzEucmIgYW5kIGNv
        bi5pZCA9ICIrQ1N0cihJQkxvZ2luLkNvbXBhbnlLZXkpKyIpIggAAABWQlNjcmlwdAAAAABGTlNU
        UFJTVAUAAABDT05UMQ0AAADX6+XtIOru7Ojx8ejoDgAAAGdkX2NvbnRhY3QgZ2cxBAAAAE5BTUUC
        AAAASUQHmQAAACJnZzEuY29udGFjdHR5cGUgPSAyIGFuZCBFWElTVFMgKFNFTEVDVCBjb24uaWQg
        RlJPTSBnZF9jb250YWN0IGNvbiB3aGVyZSBjb24ubGIgPD0gZ2cxLmxiIGFuZCBjb24ucmIgPj1n
        ZzEucmIgYW5kIGNvbi5pZCA9ICIrQ1N0cihJQkxvZ2luLkNvbXBhbnlLZXkpKyIpIggAAABWQlNj
        cmlwdAAAAABGTlNUUFJTVAUAAABDT05UMg0AAADX6+XtIOru7Ojx8ejoDgAAAGdkX2NvbnRhY3Qg
        Z2cxBAAAAE5BTUUCAAAASUQHmQAAACJnZzEuY29udGFjdHR5cGUgPSAyIGFuZCBFWElTVFMgKFNF
        TEVDVCBjb24uaWQgRlJPTSBnZF9jb250YWN0IGNvbiB3aGVyZSBjb24ubGIgPD0gZ2cxLmxiIGFu
        ZCBjb24ucmIgPj1nZzEucmIgYW5kIGNvbi5pZCA9ICIrQ1N0cihJQkxvZ2luLkNvbXBhbnlLZXkp
        KyIpIggAAABWQlNjcmlwdAAAAABGTlNUUFJTVAUAAABDT05UMw0AAADX6+XtIOru7Ojx8ejoDgAA
        AGdkX2NvbnRhY3QgZ2cxBAAAAE5BTUUCAAAASUQHmQAAACJnZzEuY29udGFjdHR5cGUgPSAyIGFu
        ZCBFWElTVFMgKFNFTEVDVCBjb24uaWQgRlJPTSBnZF9jb250YWN0IGNvbiB3aGVyZSBjb24ubGIg
        PD0gZ2cxLmxiIGFuZCBjb24ucmIgPj1nZzEucmIgYW5kIGNvbi5pZCA9ICIrQ1N0cihJQkxvZ2lu
        LkNvbXBhbnlLZXkpKyIpIggAAABWQlNjcmlwdAAAAABGTlNURkxQUg==
      SCRIPT: | 
        '#include GS_DNMNTODIVIDE
        function RetailInv_NewCostReport_mat_Copy_11577291210684658_640936098(OwnerForm, isSell, detabegin, dateend, dept, Pcomt, Cont1, Cont2, Cont3)
          BaseQueryList.Clear
          dim wherest
          wherest = " AND not dl.USR$SELLDOCKEY is null"
          if not isSell Then
            wherest =  " AND dl.USR$SELLDOCKEY is null "
          end if
          
          
          
          set e = BaseQueryList.Query(BaseQueryList.Add("Entry", 0))
          e.SQL = _
          "SELECT distinct " & _
          " C.ALIAS As Debit, " & _
          " C1.alias as Credit, " & _
          " SUM(IIF(R1.id IS NULL, R.DEBITNCU, iif (R1.issimple = 1, iif(r.id is null, R1.creditncu, R.DEBITNCU), R1.creditncu))) as SUMNCU, " & _
          " SUM(IIF(r1.ID IS NULL, R.DEBITCURR, iif (R1.issimple = 1, iif(r.id is null, R1.creditcurr, R.DEBITCURR), R1.creditcurr))) as SUMCURR, " & _
          " iif(CUR.SHORTNAME is null, cur1.shortname, cur.shortname) Shortname  FROM " & _
          " GD_DOCUMENT DOC " & _
          " join USR$NORMDISCARD dl on dl.documentkey = DOC.id " & wherest & " and dl.USR$DEPOTKEY = "  & dept(0) & _
          " JOIN AC_RECORD Z ON Z.DOCUMENTKEY = DOC.ID AND (DOC.documentdate >=:datebegin and DOC.documentdate <=:dateend)  " & _
          " LEFT JOIN AC_ENTRY R ON Z.ID = R.RECORDKEY AND r.debitncu <> 0 " & _
          " LEFT JOIN AC_ACCOUNT C ON R.ACCOUNTKEY = C.ID " & _
          " LEFT JOIN GD_CURR CUR ON R.CURRKEY = CUR.ID " & _
          " LEFT JOIN AC_ENTRY R1 ON Z.ID = R1.RECORDKEY AND r1.creditncu <> 0 " & _
          " LEFT JOIN AC_ACCOUNT C1 ON R1.ACCOUNTKEY = C1.ID " & _
          " LEFT JOIN GD_CURR CUR1 ON R1.CURRKEY = CUR1.ID " & _
          " GROUP BY " & _
          " C.ALIAS, C1.alias, CUR.SHORTNAME, cur1.shortname " & _
          " /*UNION ALL " & _
          " SELECT distinct " & _
          " C.ALIAS As Debit, " & _
          " C1.alias as Credit, " & _
          " SUM(IIF(R1.id IS NULL, R.DEBITNCU, iif (R1.issimple = 1, iif(r.id is null, R1.creditncu, R.DEBITNCU), R1.creditncu))) as SUMNCU, " & _
          " SUM(IIF(r1.ID IS NULL, R.DEBITCURR, iif (R1.issimple = 1, iif(r.id is null, R1.creditcurr, R.DEBITCURR), R1.creditcurr))) as SUMCURR, " & _
          " iif(CUR.SHORTNAME is null, cur1.shortname, cur.shortname) Shortname  FROM " & _
          " GD_DOCUMENT DOC " & _
          " join USR$NORMDISCARD dl on dl.documentkey = DOC.id " & wherest & " and dl.USR$DEPOTKEY = "  & dept(0) & _
          " JOIN AC_RECORD Z ON Z.DOCUMENTKEY = DOC.ID AND (DOC.documentdate >=:datebegin and DOC.documentdate <=:dateend)  " & _
          " LEFT JOIN AC_ENTRY R ON Z.ID = R.RECORDKEY AND r.debitncu <> 0 " & _
          " LEFT JOIN AC_ACCOUNT C ON R.ACCOUNTKEY = C.ID " & _
          " LEFT JOIN GD_CURR CUR ON R.CURRKEY = CUR.ID " & _
          " LEFT JOIN AC_ENTRY R1 ON Z.ID = R1.RECORDKEY AND r1.creditncu <> 0 " & _
          " LEFT JOIN AC_ACCOUNT C1 ON R1.ACCOUNTKEY = C1.ID " & _
          " LEFT JOIN GD_CURR CUR1 ON R1.CURRKEY = CUR1.ID " & _
          " GROUP BY  " & _
          " C.ALIAS, C1.alias, CUR.SHORTNAME, cur1.shortname */"
         e.ParamByName("datebegin").asdatetime = detabegin
         e.ParamByName("dateend").asdatetime = dateend
         e.Open
        
          dim ToDivide
          ToDivide = gs_DnmnToDivide
        
        
             dim RET_SUM, retailcost, newcost,newsum , perc
             RET_SUM =   "  cline.USR$RET_SUM, "
             retailcost=  "  cline.usr$retailcost, "
             newcost =   "  cline.usr$newcost, "
             newsum =  "  SUM(cline.usr$newsum) as usr$newsum"
             perc = " ABS(round(cline.USR$RET_SUM*100/cast(cline.usr$retailcost*SUM(cline.usr$quantity) AS numeric(15,4)),0)) AS PERC,  "
        
        ' Просчет позиций
             set w = BaseQueryList.Query(BaseQueryList.Add("TNlis", 0))
             w.SQL =   "SELECT " & _
               "  doc.documentdate,cline.documentkey, " & _
               "  doc.number, " & _
               "  cline.usr$goodkey, " & _
               "  g.name, " & _
               "  g.usr$sdr_ecrcode, " & _
               "  cline.usr$sdr_erccode, " & _
               RET_SUM & _
               retailcost & _
               newcost & _
               perc & _
               "  SUM(cline.usr$quantity) as usr$quantity, " & _
               newsum & _
               " " & _
               "from USR$NORMDISCARDLine cline " & _
               " join gd_document h on h.id = cline.masterkey " & _
               " left join USR$NORMDISCARD dl on dl.documentkey = h.id "  & _
               " LEFT JOIN gd_document doc ON cline.documentkey = doc.id  " & _
               " LEFT JOIN gd_good g ON cline.usr$goodkey = g.id  " & _
               " LEFT JOIN GD_VALUE V  ON  V.ID  =  g.VALUEKEY " & _
               "WHERE (h.documentdate >=:datebegin and h.documentdate <=:dateend) " & _
               wherest & _
               "  AND dl.USR$DEPOTKEY = "  & dept(0) & _
               " group by 1,2,3,4,5,6,7,8,9, 10 "  & _
               "order by g.name "
            w.ParamByName("datebegin").asdatetime = detabegin
            w.ParamByName("dateend").asdatetime = dateend
            w.Open
            w.IsResult = 1
        
        
        
            set z = BaseQueryList.Query(BaseQueryList.Add("Tmain", 0))
             compid = System.company.id
               z.SQL = " Select * from GD_V_COMPANY cf " +_
                     " where cf.id = " + CSTr(compid)
             z.open
             z.IsResult = 1
             
               set tdept = BaseQueryList.Query(BaseQueryList.Add("TDept", 0))
              tdept.SQL = "select ct.NAME from " & _
                " USR$NORMDISCARD nc " & _
                " left join gd_contact ct on ct.ID = nc.USR$DEPOTKEY " & _
                " where nc.USR$DEPOTKEY = " & dept(0)
                
             tdept.open
             tdept.IsResult = 1
        
          set Pcom = BaseQueryList.Query(BaseQueryList.Add("Pcomtt", 0))
          Pcom.SQL = " select con.name, p.rank from gd_contact con JOIN gd_people p on p.contactkey = con.id where con.id = :id "
          Pcom.ParamByName("id").AsInteger = Pcomt(0)
          Pcom.Open
        
          set Con1 = BaseQueryList.Query(BaseQueryList.Add("Contt1", 0))
          Con1.SQL = " select con.name, p.rank from gd_contact con JOIN gd_people p on p.contactkey = con.id where con.id = :id "
          Con1.ParamByName("id").AsInteger = Cont1(0)
          Con1.Open
        
          set Con2 = BaseQueryList.Query(BaseQueryList.Add("Contt2", 0))
          Con2.SQL = " select con.name, p.rank from gd_contact con JOIN gd_people p on p.contactkey = con.id where con.id = :id "
          Con2.ParamByName("id").AsInteger = Cont2(0)
          Con2.Open
        
          set Con3 = BaseQueryList.Query(BaseQueryList.Add("Contt3", 0))
          Con3.SQL = " select con.name, p.rank from gd_contact con JOIN gd_people p on p.contactkey = con.id where con.id = :id "
          Con3.ParamByName("id").AsInteger = Cont3(0)
          Con3.Open
        
        set DopInf = BaseQueryList.Query(BaseQueryList.Add("DopINFO", 0))
           DopInf.Sql = " select p.RANK, con.NAME from GD_COMPANY g " & _
             "left join gd_contact con on con.ID=g.DIRECTORKEY " & _
             "left join gd_people p on p.CONTACTKEY = con.ID " & _
             "where g.CONTACTKEY = <companykey/> "
           DopInf.Open
             
        
          set q2 = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          CALL Q2.AddField("DateBegin", "ftDate", 0, 0)
          CALL Q2.AddField("DateEnd", "ftDate", 0, 0)
          CALL Q2.AddField("Description", "ftString", 1024, 0)
          Q2.Open
          Q2.Edit
          Q2.FieldByName("DateBegin").AsDateTime= detabegin
          Q2.FieldByName("DateEnd").AsDateTime = DateEnd
          Q2.FieldByName("Description").AsString = Description
          Q2.Post
        
          set RetailInv_NewCostReport_mat_Copy_11577291210684658_640936098 = BaseQueryList
          
        end function
        
    Set: 
      - 
        Table: "RP_ADDITIONALFUNCTION"
        Items: 
          - 
            ADDFUNCTIONKEY: "148919176_537677461 gs_DnmnToDivide"
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 210684657_640936098
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "02. Акт по переоценке (за период)"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "210684658_640936098 RetailInv_NewCostReport_mat_Copy_11577291210684658_640936098"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147077540_358651009 Отчеты(gdc_frmUserComplexDocument147077505_358651009)"
      SERVERKEY: ~
      TEMPLATEKEY: "210684667_640936098 Акт по переоценкам (роз. склад) учетная 1210684667_640936098"
      EDITIONDATE: 2022-01-12T11:24:01+03:00