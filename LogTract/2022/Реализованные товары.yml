%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 235087456_1833050115
  Name: "Реализованные товары"
  Caption: "Реализованные товары"
  Version: "1.0.0.4"
  Optional: False
  Internal: True
  MD5: 94547989395B837400C0A7E57B62BF55
Objects: 
  - 
    Properties: 
      Class: "TgdcExplorer"
      RUID: 147037633_28608304
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 235087146_1833050115
    Fields: 
      PARENT: "147013028_109092844 Исследователь\\01.Торговля"
      NAME: "Отчеты"
      CLASSNAME: ~
      CMD: "147037633_28608304"
      CMDTYPE: 0
      HOTKEY: ~
      IMGINDEX: 88
      ORDR: ~
      SUBTYPE: ~
      EDITIONDATE: 2000-01-01T00:00:00+03:00
      DISABLED: 0
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 235087284_1833050115
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 235087146_1833050115
    Fields: 
      NAME: "Реализованные товары. По поставщику"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2022-04-15T11:57:01+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44662,7466727546" ReportOptions.Description.Text="" ReportOptions.LastChange="44662,7466727546" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2C00000020446174615365743D22435553544F4D4552532220446174615365744E616D653D22435553544F4D4552532200010C1C00000020446174615365743D22512220446174615365744E616D653D22512200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="68,03154" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="0" Top="15,11812" Width="718,1107" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Р РµР°Р»РёР·РѕРІР°РЅРЅС‹Рµ С‚РѕРІР°СЂС‹ Р·Р° РїРµСЂРёРѕРґ СЃ [TITLE.&#34;DateBegin&#34;] РїРѕ [TITLE.&#34;DateEnd&#34;] &#13;&#10;[CUSTOMERS.&#34;NAME&#34;]"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="34,01577" Left="0" Top="147,40167" Width="718,1107">
              <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="26,45671" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Рї.Рї. "/>
              <TfrxMemoView Name="Memo3" Left="26,45671" Top="0" Width="317,48052" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/>
              <TfrxMemoView Name="Memo4" Left="495,5436" Top="0" Width="26,45671" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
              <TfrxMemoView Name="Memo5" Left="522,00031" Top="0" Width="45,35436" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР°"/>
              <TfrxMemoView Name="Memo10" Left="620,26809" Top="0" Width="49,13389" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР° РќР”РЎ"/>
              <TfrxMemoView Name="Memo11" Left="669,29963" Top="0" Width="49,13389" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР° СЃ РќР”РЎ"/>
              <TfrxMemoView Name="Memo16" Left="344,3624" Top="0" Width="79,37013" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЁРљ"/>
              <TfrxMemoView Name="Memo25" Left="423,73253" Top="0" Width="71,81107" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕРґ"/>
              <TfrxMemoView Name="Memo14" Left="567,35467" Top="2,8421709430404E-14" Width="52,91342" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°"/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="204,09462" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Q" DataSetName="Q" RowCount="0">
              <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="26,45671" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line#]"/>
              <TfrxMemoView Name="Memo7" Left="26,45671" Top="0" Width="317,48052" Height="18,89765" ShowHint="False" DataField="GNAME" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;GNAME&#34;]"/>
              <TfrxMemoView Name="Memo8" Left="495,5436" Top="0" Width="26,45671" Height="18,89765" ShowHint="False" DataField="SUMQUANTITY" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;SUMQUANTITY&#34;]"/>
              <TfrxMemoView Name="Memo9" Left="522,00031" Top="0" Width="45,35436" Height="18,89765" ShowHint="False" DataField="COSTBYNCU" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;COSTBYNCU&#34;]"/>
              <TfrxMemoView Name="Memo12" Left="620,26809" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;Q.&#34;SUMWITHNDSNCU&#34;&#62;-&#60;Q.&#34;SUMBUYNCU&#34;&#62;]"/>
              <TfrxMemoView Name="Memo13" Left="669,29963" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" DataField="SUMWITHNDSNCU" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;SUMWITHNDSNCU&#34;]"/>
              <TfrxMemoView Name="Memo15" Left="567,35467" Top="0" Width="52,91342" Height="18,89765" ShowHint="False" DataField="SUMBUYNCU" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;SUMBUYNCU&#34;]"/>
              <TfrxMemoView Name="Memo23" Left="344,3624" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataField="BARCODE" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;BARCODE&#34;]"/>
              <TfrxMemoView Name="Memo26" Left="423,73253" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataField="GOODCODE" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;GOODCODE&#34;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer1" Height="18,89765" Left="0" Top="245,66945" Width="718,1107">
              <TfrxMemoView Name="Memo17" Left="0" Top="0" Width="343,93723" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ:"/>
              <TfrxMemoView Name="Memo18" Left="495,5436" Top="0" Width="26,45671" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;SUMQUANTITY&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo19" Left="522,00031" Top="0" Width="45,35436" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РҐ"/>
              <TfrxMemoView Name="Memo20" Left="620,26809" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;SUMWITHNDSNCU&#34;&#62;-&#60;Q.&#34;SUMBUYNCU&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo21" Left="669,29963" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;SUMWITHNDSNCU&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo22" Left="567,35467" Top="0" Width="52,91342" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;SUMBUYNCU&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo24" Left="344,3624" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РҐ"/>
              <TfrxMemoView Name="Memo27" Left="423,73253" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РҐ"/>
            </TfrxFooter>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 235087147_1833050115
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 235087146_1833050115
    Fields: 
      NAME: "rp_Main235087147_1833050115"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-04-15T11:57:02+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN235087147_1833050115
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAUEVSSU9EBgAAAM/l8Oju5AAAAAAAAAAAAAAAAAwAAAAAAAAAABoAAADP5fDo
        7uQg8OXg6+jn4Pbo6CDy7uLg8OBeUkZOU1RQUlNUBAAAAENVU1QKAAAAz+7x8uDi+ejqIAoAAABn
        ZF9jb250YWN0BAAAAG5hbWUCAAAAaWQIAAAAAAAAAAAEAAAAXlJeQUZOU1RGTFBS
      SCRIPT: | 
        Option Explicit
        Function rp_Main235087147_1833050115(period, cust)
          BaseQueryList.Clear
          
          dim S, q1
          set q1 = BaseQueryList.Query(BaseQueryList.Add("contact", 0))
          q1.SQL = "SELECT * FROM gd_contact WHERE id = :id"
          q1.ParamByName("id").AsInteger = IBLogin.CompanyKey
          q1.Open
          q1.IsResult = 0
          
          S = "(" & gdcBaseManager.GetIDByRUIDString(stGoodSpendAct) & "," & _
           gdcBaseManager.GetIDByRUIDString(stGoodRetProvBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stSpendBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stAddwBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stInwBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stSellBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stRetProvBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stNewCostBill) & "," & _
           gdcBaseManager.GetIDByRUIDString(stInventBill) & ")"
        
          Dim q
          Set q = BaseQueryList.Query(BaseQueryList.Add("q", 0))
          q.SQL = "SELECT " & _
          "CAST(g.Name as varchar(60)) as gName, g.BARCODE,  " & _
          "/*card.FIRSTDATE, fdoc.NUMBER as FIRSTDOCNUMBER,*/ " & _
          "round(card.usr$inv_costbuyncu,2) as COSTBYNCU, " & _
          "CAST(COALESCE(g.USR$SDR_ECRCODE,'') as VARCHAR(20)) || CAST(COALESCE(card.USR$SDR_ECRCODE,'')  as VARCHAR(5)) as GOODCODE, " & _
          "SUM(m.debit) as SUMQUANTITY, " & _
          "SUM(m.debit * round(card.usr$inv_costbuyncu,2)) as SUMBUYNCU, " & _
          "/*SUM(m.debit * card.USR$INV_COSTNDSNCU) as SUMNDSNCU,*/ " & _
          "ROUND(SUM(m.debit * (card.usr$inv_costwithndsncu)),2) as SUMWITHNDSNCU /*, " & _
          "SUM(m.debit * card.usr$inv_costncu) as SUMNCU, " & _
          "SUM(m.debit * (card.usr$inv_costfullncu)) as SUMWITHSALENCU, " & _
          "SUM(m.debit * card.usr$inv_costoptncu) as SUMOPTNCU, " & _
           " */ " & _
          "FROM inv_movement m " & _
          "JOIN inv_movement m1 ON m.movementkey = m1.movementkey AND m.id <> m1.id AND m.debit > 0 " & _
          "JOIN gd_contact dept ON m1.contactkey = dept.id " & _
          "JOIN gd_contact cust ON m.contactkey = cust.id " & _
          "JOIN inv_card card ON m.cardkey = card.id " & _
          "JOIN gd_good g ON card.goodkey = g.id " & _
          "JOIN gd_contact prov ON card.usr$inv_provider = prov.id " & _
          "JOIN gd_goodgroup gr ON g.groupkey = gr.id " & _
          "JOIN gd_document doc ON m.documentkey = doc.id " & _
          "JOIN gd_document fdoc on fdoc.ID = card.FIRSTDOCUMENTKEY " & _
          "WHERE   m.debit > 0 and m.movementdate >= :datebegin and m.movementdate <= :dateend " & _
          "   AND  (CUST.LB < :LB or CUST.RB > :RB)  AND  (DEPT.LB >= :LB and DEPT.RB <= :RB) " & _
          "   AND  NOT (DOC.DOCUMENTTYPEKEY in (147031027,147031012,147020833,147020787,147020705,147021042,147020886,147020963,147020922)) " & _
          "   AND prov.id IN (" & join(cust,",") &") " & _
          "GROUP BY g.Name ,/* card.FIRSTDATE, fdoc.NUMBER,*/ card.usr$inv_costbuyncu, g.BARCODE, g.USR$SDR_ECRCODE, card.USR$SDR_ECRCODE  " & _
          "ORDER BY g.Name "
          q.ParamByName("LB").AsInteger = q1.FieldByName("LB").AsInteger
          q.ParamByName("RB").AsInteger = q1.FieldByName("RB").AsInteger
          q.ParamByName("datebegin").AsDateTime = period(0)
          q.ParamByName("dateend").AsDateTime = period(1)
          q.Open
          
          dim Cont
          set Cont = BaseQueryList.Query(BaseQueryList.Add("Customers", 0))
          Cont.SQL = "SELECT NAME as NAME FROM gd_contact WHERE id IN (" & join(cust,",") &") " & _
                     "GROUP BY NAME "
          Cont.Open
          
          dim Title
          set Title = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          CALL Title.AddField("DateBegin", "ftDate", 0, 0)
          CALL Title.AddField("DateEnd", "ftDate", 0, 0)
          Title.Open
          Title.Edit
          Title.FieldByName("DateBegin").AsVariant = period(0)
          Title.FieldByName("DateEnd").AsVariant = period(1)
          Title.Post
        
          Set rp_Main235087147_1833050115 = BaseQueryList
        End Function
        
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 153885245_528513206
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 235087146_1833050115
    Fields: 
      PARENT: ~
      NAME: "01.Сандрик"
      DESCRIPTION: ~
      USERGROUPNAME: "153885245"
      EDITIONDATE: 2000-01-01T00:00:00+03:00
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 235087146_1833050115
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Реализованные товары по поставщику"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: "147037633_28608304 Исследователь\\01.Торговля\\Отчеты"
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "235087147_1833050115 rp_Main235087147_1833050115"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "153885245_528513206 01.Сандрик"
      SERVERKEY: ~
      TEMPLATEKEY: "235087284_1833050115 Реализованные товары. По поставщику"
      EDITIONDATE: 2022-04-15T11:57:02+03:00