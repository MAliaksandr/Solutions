%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 151303918_2128701727
  Name: "Дооценка реализации. Документ"
  Caption: "Дооценка реализации. Документ"
  Version: "1.0.0.3"
  Optional: False
  Internal: True
  MD5: 86895E7FA65A1B6CB7C912751281900F
Uses: 
  - "147755479_69526485 GS.Общие.EVT_OBJECT"
  - "148509668_396646306 Торговля - исследователь"
  - "147233705_244600472 GS.PositiveCash.Склад.Обмен с кассовым сервером.Списание скидки"
  - "147753351_73094925 GS.Общие.Метаданные.Домены"
  - "147753062_69526485 GS.Общие.Хранилище"
  - "147978914_215642201 Торговля - evt_object"
Objects: 
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 151281525_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: "147006462_486813904 Документы пользователя"
      NAME: "14. Дооценка реализации"
      DESCRIPTION: "14. Дооценка реализации"
      USERGROUPNAME: "151281525_1959566044"
      EDITIONDATE: 2023-06-30T17:54:42+03:00
  - 
    Properties: 
      Class: "TgdcExplorer"
      RUID: 151281526_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: "147013028_109092844 Исследователь\\Торговля"
      NAME: "14. Дооценка реализации"
      CLASSNAME: "TgdcUserDocument"
      CMD: "151281524_1959566044"
      CMDTYPE: 0
      HOTKEY: ~
      IMGINDEX: 0
      ORDR: ~
      SUBTYPE: "151281524_1959566044"
      EDITIONDATE: 2023-07-01T15:47:29+03:00
      DISABLED: 0
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 151291401_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "USR$DOCKEY"
      FIELDNAME: "USR$DOCKEY"
      FIELDSOURCE: "DINTEGER"
      FIELDSOURCEKEY: "147000096_486813904 Целое число, DINTEGER"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Ссылка на документ"
      LSHORTNAME: "Ссылка на документ"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "151770502_2115439882 Учёт скидок, USR$MHP_DISCOUNTS"
      RELATIONNAME: "USR$MHP_DISCOUNTS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2023-06-30T17:59:30+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcUserDocumentType"
      RUID: 151281524_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      PARENT: "151770501_2115439882 13. Списание скидки"
      NAME: "14. Дооценка реализации"
      ADDNUMBER: 1
      BRANCHKEY: "151281526_1959566044 Исследователь\\Торговля\\14. Дооценка реализации"
      CLASSNAME: "TgdcUserDocumentType"
      DESCRIPTION: ~
      DOCUMENTTYPE: "D"
      FIXLENGTH: ~
      HEADERFUNCTIONKEY: ~
      HEADERRELKEY: "151770502_2115439882 Учёт скидок, USR$MHP_DISCOUNTS"
      ISCHECKNUMBER: 0
      ISCOMMON: 0
      LINEFUNCTIONKEY: ~
      LINERELKEY: ~
      MASK: "\"NUMBER\""
      REPORTGROUPKEY: "151281525_1959566044 Документы пользователя\\14. Дооценка реализации"
      RUID: "151281524_1959566044"
      EDITIONDATE: 2023-07-01T15:47:29+03:00
      DISABLED: 0
      HEADERFUNCTIONTEMPLATE: ~
      LINEFUNCTIONTEMPLATE: ~
      OPTIONS: ~
  - 
    Properties: 
      Class: "TgdcStorageFolder"
      RUID: 151291793_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: "990010_17 USER - Administrator"
      NAME: "gdc_frmUserSimpleDocument151281524_1959566044(Tgdc_frmUserSimpleDocument)"
      CURR_DATA: ~
      DATA_TYPE: "F"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2023-06-30T18:41:02+03:00
      BLOB_DATA: ~
  - 
    Properties: 
      Class: "TgdcStorageFolder"
      RUID: 151291794_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: "151291793_2128701727 USER - Administrator\\gdc_frmUserSimpleDocument151281524_1959566044(Tgdc_frmUserSimpleDocument)"
      NAME: "ibgrMain(TgsIBGrid)"
      CURR_DATA: ~
      DATA_TYPE: "F"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2023-06-30T18:41:02+03:00
      BLOB_DATA: ~
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 151291795_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: "151291794_2128701727 USER - Administrator\\gdc_frmUserSimpleDocument151281524_1959566044(Tgdc_frmUserSimpleDocument)\\ibgrMain(TgsIBGrid)"
      NAME: "data"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2023-07-01T16:27:10+03:00
      BLOB_DATA: !!binary > 
        VFBGMAYNR1JJRF9TVFJFQU1fNAEGBlRhaG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABghjbFdp
        bmRvdwEGBlRhaG9tYQYPY2xIaWdobGlnaHRUZXh0AvUAAggAAgEABgtjbEhpZ2hsaWdodAEGBlRh
        aG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABgljbEJ0bkZhY2UJBgkkMDBFN0YzRjcGCSQwMEQ2
        RTdFNw4ACAgOAAgOAQhFeHBhbmRlZAgJRmllbGROYW1lBgxET0NVTUVOVERBVEUIUmVhZE9ubHkI
        DVRpdGxlLkNhcHRpb24GBMTg8uAFV2lkdGgCQQdWaXNpYmxlCQABCEV4cGFuZGVkCAlGaWVsZE5h
        bWUGDlVTUiRTT1JUTlVNQkVSCFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBhTN7uzl8CDk6/8g8e7w
        8ujw7uLq6AVXaWR0aAOCAAdWaXNpYmxlCQABCEV4cGFuZGVkCAlGaWVsZE5hbWUGCFVTUiRTVU1N
        CFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgzR8+zs4CDx6ujk6ugFV2lkdGgDggAHVmlzaWJsZQkJ
        VG90YWxUeXBlBwV0dFN1bQABCEV4cGFuZGVkCAlGaWVsZE5hbWUGFlVfVVNSJERFUE9US0VZX0FE
        RFJFU1MIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GBcDk8OXxBVdpZHRoAwQBB1Zpc2libGUJAAEI
        RXhwYW5kZWQICUZpZWxkTmFtZQYCSUQIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GBMrr/vcFV2lk
        dGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGBlBBUkVOVAhSZWFkT25seQgNVGl0
        bGUuQ2FwdGlvbgYI0O7k6PLl6/wFV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5h
        bWUGD0RPQ1VNRU5UVFlQRUtFWQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYN0ujvIOTu6vPs5e3y
        4AVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYJVFJUWVBFS0VZCFJlYWRP
        bmx5CA1UaXRsZS5DYXB0aW9uBg7S6O8g8vDg7efg6vbo6AVXaWR0aAL/B1Zpc2libGUIAAEIRXhw
        YW5kZWQICUZpZWxkTmFtZQYOVFJBTlNBQ1RJT05LRVkIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24G
        CtLw4O3n4Or26P8FV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGBk5VTUJF
        UghSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYFze7s5fAFV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFu
        ZGVkCAlGaWVsZE5hbWUGC0RFU0NSSVBUSU9OCFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgjO7+jx
        4O3o5QVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYGU1VNTkNVCFJlYWRP
        bmx5CA1UaXRsZS5DYXB0aW9uBgvR8+zs4CDiIM3ExQVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5k
        ZWQICUZpZWxkTmFtZQYHU1VNQ1VSUghSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYO0fPs7OAg4iDi
        4Ov+8uUFV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGBVNVTUVRCFJlYWRP
        bmx5CA1UaXRsZS5DYXB0aW9uBhPR8+zs4CDiIP3q4uji4Ovl7fLlBVdpZHRoAv8HVmlzaWJsZQgA
        AQhFeHBhbmRlZAgJRmllbGROYW1lBgdERUxBWUVECFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgrO
        8uvu5uXt7fvpBVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBgdDVVJSS0VZ
        CFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgbC4Ov+8uAFV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFu
        ZGVkCAlGaWVsZE5hbWUGCkNPTVBBTllLRVkIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GCMru7O/g
        7ej/BVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBgpDUkVBVE9SS0VZCFJl
        YWRPbmx5CA1UaXRsZS5DYXB0aW9uBgrK8u4g8e7n5ODrBVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBh
        bmRlZAgJRmllbGROYW1lBgxDUkVBVElPTkRBVEUIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GDcTg
        8uAg8e7n5ODt6P8FV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGCUVESVRP
        UktFWQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYMyvLuIOjx7/Dg4ujrBVdpZHRoAv8HVmlzaWJs
        ZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBgtFRElUSU9OREFURQhSZWFkT25seQgNVGl0bGUuQ2Fw
        dGlvbgYOxODy4CDo5+zl7eXt6P8FV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5h
        bWUGCVBSSU5UREFURQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYLxODy4CDv5ffg8ugFV2lkdGgC
        /wdWaXNpYmxlCAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGCERJU0FCTEVECFJlYWRPbmx5CA1UaXRs
        ZS5DYXB0aW9uBghESVNBQkxFRAVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFt
        ZQYIUkVTRVJWRUQIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GD8fg8OXn5fDi6PDu4uDt7gVXaWR0
        aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYLRE9DVU1FTlRLRVkNVGl0bGUuQ2Fw
        dGlvbgYNyOTl7fLo9Ojq4PLu8AVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFt
        ZQYJUkVTRVJWRUQxDVRpdGxlLkNhcHRpb24GHcfg8OXn5fDi6PDu4uDt7iAo0/e48iDx6ujk7uop
        BVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBgtVU1IkQ0FTSEtFWQhSZWFk
        T25seQgNVGl0bGUuQ2FwdGlvbgYFyuDx8eAFV2lkdGgC/wdWaXNpYmxlCAABCEV4cGFuZGVkCAlG
        aWVsZE5hbWUGDFVTUiRERVBPVEtFWQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYNz+7k8ODn5OXr
        5e3o5QVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYKVVNSJERPQ0tFWQhS
        ZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYS0fH76+rgIO3gIOTu6vPs5e3yBVdpZHRoAv8HVmlzaWJs
        ZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBgpVU1IkRVFSQVRFCFJlYWRPbmx5CA1UaXRsZS5DYXB0
        aW9uBhDK8/DxIP3q4uji4Ovl7fLgBVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGRO
        YW1lBhlVX1VTUiRDQVNIS0VZX1VTUiRCTl9OQU1FCFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBhDK
        4PHx7uL76SDg7+/g8ODyBVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBhNV
        X1VTUiRERVBPVEtFWV9OQU1FCFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgzN4Ojs5e3u4uDt6OUF
        V2lkdGgC/wdWaXNpYmxlCAABCUFsaWdubWVudAcOdGFSaWdodEp1c3RpZnkIRXhwYW5kZWQICUZp
        ZWxkTmFtZQYFQUZVTEwNVGl0bGUuQ2FwdGlvbgYNz+7r7fvpIOTu8fLz7wVXaWR0aAL/B1Zpc2li
        bGUIAAEJQWxpZ25tZW50Bw50YVJpZ2h0SnVzdGlmeQhFeHBhbmRlZAgJRmllbGROYW1lBgVBQ0hB
        Rw1UaXRsZS5DYXB0aW9uBhnP8O7x7O7y8CDoIPDl5ODq8ujw7uLg7ejlBVdpZHRoAv8HVmlzaWJs
        ZQgAAQlBbGlnbm1lbnQHDnRhUmlnaHRKdXN0aWZ5CEV4cGFuZGVkCAlGaWVsZE5hbWUGBUFWSUVX
        DVRpdGxlLkNhcHRpb24GD9Lu6/zq7iDv8O7x7O7y8AVXaWR0aAL/B1Zpc2libGUIAAAICLQeCQg=
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 151291438_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: ~
      NAME: "gdc_dlgUserSimpleDocument151281524_1959566044"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: ~
      OBJECTNAME: "gdc_dlgUserSimpleDocument151281524_1959566044"
      OBJECTTYPE: 0
      REPORTGROUPKEY: ~
      SUBTYPE: ""
      EDITIONDATE: 2023-06-30T18:16:59+03:00
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 151294165_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_frmUserSimpleDocument151281524_1959566044)"
      DESCRIPTION: ~
      USERGROUPNAME: "151294165_1959566044"
      EDITIONDATE: 2023-07-01T14:06:14+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 151294164_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_frmUserSimpleDocument151281524_1959566044"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2023-07-01T14:06:14+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 151291418_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: ~
      NAME: "gdc_frmUserSimpleDocument151281524_1959566044"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "151294164_1959566044 Локальные макросы"
      OBJECTNAME: "gdc_frmUserSimpleDocument151281524_1959566044"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "151294165_1959566044 Отчеты(gdc_frmUserSimpleDocument151281524_1959566044)"
      SUBTYPE: ""
      EDITIONDATE: 2023-07-01T14:06:14+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 151258880_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      NAME: "TrEntryScript151258880_1959566044"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "ENTRY"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-06-30T17:56:10+03:00
      DISPLAYSCRIPT: | 
        TRENTRYSCRIPT151258880_1959566044
        EXCEPTTRENTRYSCRIPT151258880_1959566044
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QIAAAAZ2RjRW50cnkLAAAAzeUg8+Tg6//y/CEAAAAAAAAAAAAAAAAAAAAAAAAAAAAW
        AAAAwejn7eXxIO7h+uXq8iDv8O7i7uTq6EZOU1RQUlNUCwAAAGdkY0RvY3VtZW50CwAAAM3lIPPk
        4Ov/8vwhAAAAAAAAAAAAAAAAAAAAAAAAAAAAFwAAAMHo5+3l8SDu4frl6vIg5O7q8+zl7fLgRk5T
        VEZMUFI=
      SCRIPT: | 
        'Данная скрипт-функция создана конструктором функций.
        'Все изменения, произведённые вручную, будут потеряны
        'при следующей генерации скрипт-функции.
        Sub TrEntryScript151258880_1959566044(gdcEntry, gdcDocument)
          Dim IsZero, Result, BeginDate, EndDate, EntryDate, Transaction, Creator
          
          IsZero = True
          Result = False
          BeginDate = gdcDocument.FieldByName("documentdate").AsDateTime
          EndDate = BeginDate
          EntryDate = EndDate
          TrRecordKey = gdcBaseManager.GetIDByRUIDString("151258879_1959566044")
          Set Transaction = gdcDocument.Transaction
          GS.Transaction = Transaction
          Set Creator = New TCreator
          Except ExceptTrEntryScript151258880_1959566044(gdcEntry)
          RecordKey = gdcEntry.GetNextId(True)
          DebitNcu = 0
          CreditNcu = 0
          DebitCurr = 0
          CreditCurr = 0
          DebitEq = 0
          CreditEq = 0
          'Позиция типовой проводки Кредит 41.02
          gdcEntry.Insert
          gdcEntry.FieldByName("recordkey").AsInteger = RecordKey
          'Присвоение счета и типа счета проводки
          gdcEntry.FieldByName("accountkey").AsInteger = gdcBaseManager.GetIdByRUIDString("344102_17")
          'Тип счета
          gdcEntry.FieldByName("accountpart").AsString = "C"
          gdcEntry.FieldByName("creditncu").AsCurrency = -1*gdcDocument.FieldByName("USR$SUMM").AsCurrency
          CreditNcu = CreditNcu + gdcEntry.FieldByName("creditncu").AsCurrency
          'Присвоение значения аналитик
          gdcEntry.FieldByName("USR$GS_DEPARTMENT").AsVariant = gdcDocument.FieldByName("USR$DEPOTKEY").Value
          gdcEntry.FieldByName("trrecordkey").AsInteger = TrRecordKey
          gdcEntry.Post
          'Позиция типовой проводки Дебет 90.04
          gdcEntry.Insert
          gdcEntry.FieldByName("recordkey").AsInteger = RecordKey
          'Присвоение счета и типа счета проводки
          gdcEntry.FieldByName("accountkey").AsInteger = gdcBaseManager.GetIdByRUIDString("147301267_441235478")
          'Тип счета
          gdcEntry.FieldByName("accountpart").AsString = "D"
          gdcEntry.FieldByName("debitncu").AsCurrency = CreditNCU
          DebitNcu = DebitNcu + gdcEntry.FieldByName("debitncu").AsCurrency
          gdcEntry.FieldByName("trrecordkey").AsInteger = TrRecordKey
          gdcEntry.Post
          If (DebitNcu <> CreditNcu) Then
            Call Exception.Raise("Exception", "Сумма по дебету не равна сумме по кредиту!" & Chr(13) & Chr(10) & _
              "Проверьте настройку типовой операции." & Chr(13) & Chr(10))
          End If
          IsZero = (DebitNcu = 0) and (CreditNcu = 0) and _ 
            (DebitCurr = 0) and (CreditCurr = 0) and _ 
            (DebitEq = 0) and (CreditEq = 0)
          If IsZero Then 
            call gdcBaseManager.ExecSingleQuery("DELETE FROM ac_record WHERE id = (" & _ 
              CStr(RecordKey) & ")", Transaction )
          End If
          'Скрипт финализации процедуры
          Result = True
        End Sub
        'Функция обработки исключения
        Sub ExceptTrEntryScript151258880_1959566044 (gdcEntry)
          If (gdcEntry.State = 2) Or (gdcEntry.State = 3) Then gdcEntry.Cancel
        End Sub
        
        
        
  - 
    Properties: 
      Class: "TgdcAcctTransaction"
      RUID: 151258878_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      PARENT: ~
      NAME: "Дооценка реализации"
      AUTOTRANSACTION: 0
      COMPANYKEY: ~
      DESCRIPTION: ~
      ISINTERNAL: 0
      EDITIONDATE: 2023-06-30T17:28:27+03:00
      DISABLED: 0
  - 
    Properties: 
      Class: "TgdcAcctTransactionEntry"
      RUID: 151258879_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      ACCOUNTKEY: "300001_17 План счетов"
      ACCOUNTNAME: "План счетов"
      DBEGIN: ~
      DEND: ~
      DESCRIPTION: "Дооценка реализации"
      DOCUMENTNAME: "14. Дооценка реализации"
      DOCUMENTPART: "шапка"
      DOCUMENTTYPEKEY: "151281524_1959566044 13. Списание скидки\\14. Дооценка реализации"
      FUNCTIONKEY: "151258880_1959566044 TrEntryScript151258880_1959566044"
      FUNCTIONNAME: "TrEntryScript151258880_1959566044"
      ISSAVENULL: 0
      TRANSACTIONKEY: "151258878_1959566044 Дооценка реализации"
      TRANSACTIONNAME: "Дооценка реализации"
      USR$BANK_ACCOUNT: ~
      USR$FA_GROUPKEY: ~
      USR$FA_INVCARDKEY: ~
      USR$FA_TYPEKEY: ~
      USR$GROUP_TMC: ~
      USR$GSM_CAR: ~
      USR$GSM_DRIVER: ~
      USR$GS_CONTRACT: ~
      USR$GS_CUSTOMER: ~
      USR$GS_DEPARTMENT: ~
      USR$GS_DOCUMENT: ~
      USR$GS_ECONOMICACTIVITY: ~
      USR$GS_EMPLOYEE: ~
      USR$GS_EXPENSES: ~
      USR$GS_GOOD: ~
      USR$GS_SALETAXRATE: ~
      USR$GS_SERVICE: ~
      USR$INV_CUSTPERMITKEY: ~
      USR$VATTYPE_KEY: ~
      USR$WG_FEETYPEKEY: ~
      EDITIONDATE: 2023-06-30T17:56:10+03:00
      DISABLED: 0
      FUNCTIONTEMPLATE: !!binary > 
        RldpegEAAAAMAAAAVFNjcmlwdEJsb2NrEgAAAAAAAAAAAAAAAAAAAAAAAAAAMQEAAFoCAAABAAAA
        AAAAAAABAAAAFQAAAFRUckVudHJ5RnVuY3Rpb25CbG9jaxIAAAAhAAAAVHJFbnRyeVNjcmlwdDE1
        MTI1ODg4MF8xOTU5NTY2MDQ0AAAAAAEKAAAABQAAABgBAACMAAAAAQAAAAAAAAAAAFNMUFJQUlNU
        CAAAAGdkY0VudHJ5CwAAAM3lIPPk4Ov/8vwhAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAAAMHo5+3l
        8SDu4frl6vIg7/Du4u7k6uhGTlNUAAAAAFBSU1QLAAAAZ2RjRG9jdW1lbnQLAAAAzeUg8+Tg6//y
        /CEAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAwejn7eXxIO7h+uXq8iDk7urz7OXt8uBGTlNUAAAA
        AEZMUFIAAAAADQAAAFJlc3VsdCA9IFRydWUUAAAAMTUxMjU4ODc4XzE5NTk1NjYwNDQUAAAAMTUx
        MjU4ODc5XzE5NTk1NjYwNDQAFAAAADE1MTI4MTUyNF8xOTU5NTY2MDQ0AAEAAAANAAAAVFRyRW50
        cnlCbG9jaxIAAAAJAAAAVHJFbnRyeV8xAAAAAAEKAAAAHAAAALcAAABUAAAAAAAAAAAAAAAAAAAA
        AAAAAAAAAAAAAAAAAAIAAAAVAAAAVFRyRW50cnlQb3NpdGlvbkJsb2NrEgAAAAwAAABUclBvc0Vu
        dHJ5XzIAAAAAAAoAAAAcAAAAVAAAABcAAAAAAAAAAAwAAADK8OXk6PIgNDEuMDIAAAAAAQAAAEMk
        AAAAVVNSJEdTX0RFUEFSVE1FTlQ9W0guVVNSJERFUE9US0VZXQ0KAAAAAAAAAAAJAAAAMzQ0MTAy
        XzE3DwAAAC0xKltILlVTUiRTVU1NXQAAAAAAAAAAAAAAABUAAABUVHJFbnRyeVBvc2l0aW9uQmxv
        Y2sSAAAADAAAAFRyUG9zRW50cnlfMQAAAAAACgAAADgAAABOAAAAFwAAAAAAAAAACwAAAMTl4eXy
        IDkwLjA0AAAAAAEAAABEAAAAAAAAAAAAAAAAEwAAADE0NzMwMTI2N180NDEyMzU0NzgJAAAAQ3Jl
        ZGl0TkNVAAAAAAAAAAAAAAAA
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 151294215_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      NAME: "Дооценка за перод. Реализация"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2023-07-01T14:39:25+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="45108,5936319907" ReportOptions.Description.Text="" ReportOptions.LastChange="45108,5936319907" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2E00000020446174615365743D224445504152544D454E542220446174615365744E616D653D224445504152544D454E542200010C2600000020446174615365743D224D41544F54562220446174615365744E616D653D224D41544F54562200010C2800000020446174615365743D224D41544F5456322220446174615365744E616D653D224D41544F5456322200010C1C00000020446174615365743D22512220446174615365744E616D653D22512200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="83,14966" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="0" Top="37,7953" Width="718,1107" Height="37,7953" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РѕРѕС†РµРЅРєР° СЂРµР°Р»РёР·РѕРІР°РЅРЅРѕРіРѕ С‚РѕРІР°СЂР° &#13;&#10;Р·Р° РїРµСЂРёРѕРґ СЃ [TITLE.&#34;DateBegin&#34;]  РїРѕ [TITLE.&#34;DateEnd&#34;]"/>
              <TfrxMemoView Name="Memo20" Left="37,7953" Top="3,77953" Width="298,58287" Height="18,89765" ShowHint="False" Text="[COMPANYNAME], [DEPARTMENT.&#34;NAME&#34;]"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="18,89765" Left="0" Top="162,51979" Width="718,1107">
              <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° "/>
              <TfrxMemoView Name="Memo3" Left="264,5671" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°"/>
              <TfrxMemoView Name="Memo21" Left="151,1812" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ"/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Height="18,89765" Left="0" ParentFont="False" Top="204,09462" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Q" DataSetName="Q" RowCount="0">
              <TfrxMemoView Name="Memo4" Left="37,7953" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" DataField="DOCUMENTDATE" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;DOCUMENTDATE&#34;]"/>
              <TfrxMemoView Name="Memo5" Left="264,5671" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" DataField="ALLSUM" DataSet="Q" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;ALLSUM&#34;]"/>
              <TfrxMemoView Name="Memo22" Left="151,1812" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;NUMBER&#34;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer1" Height="18,89765" Left="0" Top="245,66945" Width="718,1107">
              <TfrxMemoView Name="Memo6" Left="37,7953" Top="0" Width="226,7718" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ:"/>
              <TfrxMemoView Name="Memo7" Left="264,5671" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;ALLSUM&#34;&#62;,MasterData1)]"/>
            </TfrxFooter>
            <TfrxReportSummary Name="ReportSummary1" Height="128,50402" Left="0" Top="325,03958" Width="718,1107">
              <TfrxMemoView Name="Memo8" Left="41,57483" Top="30,23624" Width="83,14966" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РџРѕРґРіРѕС‚РѕРІРёР»"/>
              <TfrxMemoView Name="Memo9" Left="124,72449" Top="45,35436" Width="166,29932" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РґРѕР»Р¶РЅРѕСЃС‚СЊ)"/>
              <TfrxMemoView Name="Memo10" Left="299,14193" Top="45,35436" Width="75,5906" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/>
              <TfrxMemoView Name="Memo11" Left="382,29159" Top="45,35436" Width="234,33086" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(С„РёРѕ)"/>
              <TfrxMemoView Name="Memo12" Left="124,72449" Top="18,89765" Width="166,29932" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[MATOTV.&#34;RANK&#34;]"/>
              <TfrxMemoView Name="Memo13" Left="382,29159" Top="18,89765" Width="234,33086" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[MATOTV.&#34;NAME&#34;]"/>
              <TfrxMemoView Name="Memo14" Left="41,57483" Top="79,37013" Width="83,14966" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РџСЂРѕРІРµСЂРёР»"/>
              <TfrxMemoView Name="Memo15" Left="124,72449" Top="94,48825" Width="166,29932" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РґРѕР»Р¶РЅРѕСЃС‚СЊ)"/>
              <TfrxMemoView Name="Memo16" Left="299,14193" Top="94,48825" Width="75,5906" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/>
              <TfrxMemoView Name="Memo17" Left="382,29159" Top="94,48825" Width="234,33086" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(С„РёРѕ)"/>
              <TfrxMemoView Name="Memo18" Left="124,72449" Top="68,03154" Width="166,29932" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[MATOTV2.&#34;RANK&#34;]"/>
              <TfrxMemoView Name="Memo19" Left="382,29159" Top="68,03154" Width="234,33086" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[MATOTV2.&#34;NAME&#34;]"/>
            </TfrxReportSummary>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 151294167_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      NAME: "rp_Main151294167_1959566044"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "151291418_2128701727 gdc_frmUserSimpleDocument151281524_1959566044"
      OBJECTNAME: "gdc_frmUserSimpleDocument151281524_1959566044"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-07-01T14:39:27+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN151294167_1959566044
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAYAAABQRVJJT0QGAAAAz+Xw6O7kAAAAAAAAAAAAAAAADAAAAAAAAAAAAgAAAF5S
        Rk5TVFBSU1QJAAAATUFUT1RWS0VZCgAAAM/u5OPu8u7i6OsOAAAAR0RfQ09OVEFDVCBnZzEEAAAA
        bmFtZQIAAABJRAeZAAAAImdnMS5jb250YWN0dHlwZSA9IDIgYW5kIEVYSVNUUyAoU0VMRUNUIGNv
        bi5pZCBGUk9NIGdkX2NvbnRhY3QgY29uIHdoZXJlIGNvbi5sYiA8PSBnZzEubGIgYW5kIGNvbi5y
        YiA+PWdnMS5yYiBhbmQgY29uLmlkID0gIitDU3RyKElCTG9naW4uQ29tcGFueUtleSkrIikiCAAA
        AFZCU2NyaXB0AgAAAF5ERk5TVFBSU1QKAAAATUFUT1RWS0VZMggAAADP8O7i5fDo6w4AAABHRF9D
        T05UQUNUIGdnMQQAAABuYW1lAgAAAElEB5kAAAAiZ2cxLmNvbnRhY3R0eXBlID0gMiBhbmQgRVhJ
        U1RTIChTRUxFQ1QgY29uLmlkIEZST00gZ2RfY29udGFjdCBjb24gd2hlcmUgY29uLmxiIDw9IGdn
        MS5sYiBhbmQgY29uLnJiID49Z2cxLnJiIGFuZCBjb24uaWQgPSAiK0NTdHIoSUJMb2dpbi5Db21w
        YW55S2V5KSsiKSIIAAAAVkJTY3JpcHQCAAAAXkFGTlNURkxQUg==
      SCRIPT: | 
        Option Explicit
        Function rp_Main151294167_1959566044(OwnerForm, period, MatOtvKey, MatOtvKey2)
          BaseQueryList.Clear
        
          Dim q
          Set q = BaseQueryList.Query(BaseQueryList.Add("q", 0))
          q.SQL = "SELECT " & _
            "D.DOCUMENTDATE, d.NUMBER, " & _
            "DEP.NAME AS DEPORTNAME, " & _
            "SUM(DD.USR$SUMM) as ALLSUM " & _
            " " & _
            "FROM GD_DOCUMENT D " & _
            "JOIN USR$MHP_DISCOUNTS DD ON  DD.DOCUMENTKEY  =  D.ID " & _
            "LEFT JOIN GD_CONTACT DEP ON  DEP.ID  =  DD.USR$DEPOTKEY " & _
            "WHERE D.DOCUMENTDATE BETWEEN :DB AND :DE " & _
            "group by 1, 2,3 " & _
            "having SUM(DD.USR$SUMM)<>0 " & _
            "order by 1,2"
          q.ParamByName("DB").asDateTime = Period(0)
          q.ParamByName("DE").asDateTime = Period(1)
          q.Open
          
          dim qMatOtv : set qMatOtv = BaseQueryList.Query(BaseQueryList.Add("MatOtv", 0))
          qMatOtv.SQL = _
            "select " & _
            "  P.NICKNAME as NAME " & _
            ", POS.NAME as RANK " & _
            "from " & _
            "  GD_CONTACT CON " & _
            "  left join GD_PEOPLE P on CON.ID = P.CONTACTKEY " & _
            "  left join WG_POSITION POS on POS.ID = P.WPOSITIONKEY " & _
            "where " & _
            "  CON.ID = :ID    "
          qMatOtv.ParamByName("id").AsInteger = MatOtvKey(0)
          qMatOtv.Open
          
          dim qMatOtv2 : set qMatOtv2 = BaseQueryList.Query(BaseQueryList.Add("MatOtv2", 0))
          qMatOtv2.SQL = _
            "select " & _
            "  P.NICKNAME as NAME " & _
            ", POS.NAME as RANK " & _
            "from " & _
            "  GD_CONTACT CON " & _
            "  left join GD_PEOPLE P on CON.ID = P.CONTACTKEY " & _
            "  left join WG_POSITION POS on POS.ID = P.WPOSITIONKEY " & _
            "where " & _
            "  CON.ID = :ID    "
          qMatOtv2.ParamByName("id").AsInteger = MatOtvKey2(0)
          qMatOtv2.Open
          
          dim dep : set dep = BaseQueryList.Query(BaseQueryList.Add("Department", 0))
          dep.SQL = _
            "SELECT * FROM GD_CONTACT WHERE ID = :DEPKEY"
          dep.ParamByName("DEPKEY").AsInteger = OwnerForm.gdcObject.FieldByName("USR$DEPOTKEY").asInteger
          dep.Open
          
          dim q2 : set q2 = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          CALL Q2.AddField("DateBegin", "ftDate", 0, 0)
          CALL Q2.AddField("DateEnd", "ftDate", 0, 0)
          Q2.Open
          Q2.Edit
          Q2.FieldByName("DateBegin").AsVariant = Period(0)
          Q2.FieldByName("DateEnd").AsVariant = Period(1)
          Q2.Post
        
          Set rp_Main151294167_1959566044 = BaseQueryList
        End Function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 151294166_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151281524_1959566044
    Fields: 
      NAME: "Дооценка за период"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "151294167_1959566044 rp_Main151294167_1959566044"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "151294165_1959566044 Отчеты(gdc_frmUserSimpleDocument151281524_1959566044)"
      SERVERKEY: ~
      TEMPLATEKEY: "151294215_1959566044 Дооценка за перод. Реализация"
      EDITIONDATE: 2023-07-01T14:39:27+03:00
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 151303937_2128701727
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      PARENT: "147057828_1220615315 GLOBAL\\DFM\\Tgdc_frmUserSimpleDocument"
      NAME: "151281524_1959566044"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2023-07-04T17:22:57+03:00
      BLOB_DATA: | 
        object gdc_frmUserSimpleDocument151281524_1959566044: Tgdc_frmUserSimpleDocument
          PixelsPerInch = 96
          TextHeight = 13
          object sbMain: TStatusBar
            Panels = <
              item
                Text = 'Нет фильтрации'
                Width = 1449
              end
              item
                Width = 160
              end>
          end
          object TBDockTop: TTBDock
            object tbMainToolbar: TTBToolbar
              SavedAtRunTime = True
              object tbiNew: TTBItem
              end
              object tbiEdit: TTBItem
              end
              object tbiDelete: TTBItem
              end
              object tbiDuplicate: TTBItem
              end
              object tbiReduction: TTBItem
              end
              object tbsiMainOne: TTBSeparatorItem
              end
              object tbiEditInGrid: TTBItem
              end
              object tbiCopy: TTBItem
              end
              object tbiCut: TTBItem
              end
              object tbiPaste: TTBItem
              end
              object tbsiMainOneAndHalf: TTBSeparatorItem
              end
              object tbiLoadFromFile: TTBItem
              end
              object tbiSaveToFile: TTBItem
              end
              object tbsiMainTwo: TTBSeparatorItem
              end
              object tbiFind: TTBItem
              end
              object tbiFilter: TTBItem
              end
              object tbiPrint: TTBItem
              end
              object tbiOnlySelected: TTBItem
              end
              object tbiLinkObject: TTBItem
              end
              object tbsiMainThreeAndAHalf: TTBSeparatorItem
              end
              object tbiHelp: TTBItem
              end
            end
            object tbMainCustom: TTBToolbar
              SavedAtRunTime = True
            end
            object tbMainMenu: TTBToolbar
              SavedAtRunTime = True
              object tbsiMainMenuObject: TTBSubmenuItem
                object tbi_mm_New: TTBItem
                end
                object tbi_mm_Edit: TTBItem
                end
                object tbi_mm_Delete: TTBItem
                end
                object tbi_mm_Duplicate: TTBItem
                end
                object tbi_mm_Reduction: TTBItem
                end
                object tbi_mm_sep1_1: TTBSeparatorItem
                end
                object tbi_mm_Copy: TTBItem
                end
                object tbi_mm_Cut: TTBItem
                end
                object tbi_mm_Paste: TTBItem
                end
                object tbi_mm_sep2_2_: TTBSeparatorItem
                end
                object tbi_mm_AddToSelected: TTBItem
                end
                object tbi_mm_RemoveFromSelected: TTBItem
                end
                object tbi_mm_sep2_1: TTBSeparatorItem
                end
                object tbi_mm_Load: TTBItem
                end
                object tbi_mm_Save: TTBItem
                end
                object tbi_mm_sep3_1: TTBSeparatorItem
                end
                object tbi_mm_Commit: TTBItem
                end
                object tbi_mm_Rollback: TTBItem
                end
                object tbi_mm_sep4_1: TTBSeparatorItem
                end
                object tbi_mm_Find: TTBItem
                end
                object tbi_mm_Filter: TTBItem
                end
                object tbi_mm_Print: TTBItem
                end
                object tbi_mm_Macro: TTBItem
                end
                object tbi_mm_OnlySelected: TTBItem
                end
                object tbi_mm_LinkObject: TTBItem
                end
                object tbi_mm_sep5_1: TTBSeparatorItem
                end
                object tbi_mm_MainToSetting: TTBItem
                end
                object tbi_mm_sep5_2_: TTBSeparatorItem
                end
                object tbi_mm_CopySettings: TTBItem
                end
                object tbiDistributeSettings: TTBItem
                end
                object tbiDontSaveSettings: TTBItem
                end
              end
              object tbsiMainMenuHelp: TTBSubmenuItem
                object tbiMainMenuHelp: TTBItem
                end
              end
            end
            object tbMainInvariant: TTBToolbar
              SavedAtRunTime = True
              object tbiCommit: TTBItem
              end
              object tbiRollback: TTBItem
              end
              object tbsiMainThree: TTBSeparatorItem
              end
              object tbiMacros: TTBItem
              end
              object TBItem2: TTBItem
              end
              object TBItem1: TTBItem
              end
            end
            object tbChooseMain: TTBToolbar
              SavedAtRunTime = True
              object tbiSelectAll: TTBItem
              end
              object tbiUnSelectAll: TTBItem
              end
              object tbiClearSelection: TTBItem
              end
            end
          end
          object TBDockLeft: TTBDock
          end
          object TBDockRight: TTBDock
          end
          object TBDockBottom: TTBDock
          end
          object pnlWorkArea: TPanel
            object spChoose: TSplitter
              Top = 652
              Width = 1609
            end
            object pnlMain: TPanel
              object pnlSearchMain: TPanel
                Height = 557
                object sbSearchMain: TScrollBox
                  Height = 530
                end
                object pnlSearchMainButton: TPanel
                  object btnSearchMain: TButton
                  end
                  object btnSearchMainClose: TButton
                  end
                  object chbxFuzzyMatch: TCheckBox
                  end
                end
              end
              object ibgrMain: TgsIBGrid
                Expands = <>
                Conditions = <>
                ColumnEditors = <>
                Aliases = <>
                Columns = <
                  item
                    Expanded = False
                    FieldName = 'DOCUMENTDATE'
                    ReadOnly = False
                    Title.Caption = 'Дата'
                    Width = 65
                    Visible = True
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$SORTNUMBER'
                    ReadOnly = False
                    Title.Caption = 'Номер для сортировки'
                    Width = 130
                    Visible = True
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$SUMM'
                    ReadOnly = False
                    Title.Caption = 'Сумма скидки'
                    Width = 130
                    Visible = True
                    TotalType = ttSum
                  end
                  item
                    Expanded = False
                    FieldName = 'U_USR$DEPOTKEY_ADDRESS'
                    ReadOnly = False
                    Title.Caption = 'Адрес'
                    Width = 260
                    Visible = True
                  end
                  item
                    Expanded = False
                    FieldName = 'ID'
                    ReadOnly = False
                    Title.Caption = 'Ключ'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'PARENT'
                    ReadOnly = False
                    Title.Caption = 'Родитель'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'DOCUMENTTYPEKEY'
                    ReadOnly = False
                    Title.Caption = 'Тип документа'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'TRTYPEKEY'
                    ReadOnly = False
                    Title.Caption = 'Тип транзакции'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'TRANSACTIONKEY'
                    ReadOnly = False
                    Title.Caption = 'Транзакция'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'NUMBER'
                    ReadOnly = False
                    Title.Caption = 'Номер'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'DESCRIPTION'
                    ReadOnly = False
                    Title.Caption = 'Описание'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'SUMNCU'
                    ReadOnly = False
                    Title.Caption = 'Сумма в НДЕ'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'SUMCURR'
                    ReadOnly = False
                    Title.Caption = 'Сумма в валюте'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'SUMEQ'
                    ReadOnly = False
                    Title.Caption = 'Сумма в эквиваленте'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'DELAYED'
                    ReadOnly = False
                    Title.Caption = 'Отложенный'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'CURRKEY'
                    ReadOnly = False
                    Title.Caption = 'Валюта'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'COMPANYKEY'
                    ReadOnly = False
                    Title.Caption = 'Компания'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'CREATORKEY'
                    ReadOnly = False
                    Title.Caption = 'Кто создал'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'CREATIONDATE'
                    ReadOnly = False
                    Title.Caption = 'Дата создания'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'EDITORKEY'
                    ReadOnly = False
                    Title.Caption = 'Кто исправил'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'EDITIONDATE'
                    ReadOnly = False
                    Title.Caption = 'Дата изменения'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'PRINTDATE'
                    ReadOnly = False
                    Title.Caption = 'Дата печати'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'DISABLED'
                    ReadOnly = False
                    Title.Caption = 'DISABLED'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'RESERVED'
                    ReadOnly = False
                    Title.Caption = 'Зарезервировано'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'DOCUMENTKEY'
                    Title.Caption = 'Идентификатор'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'RESERVED1'
                    Title.Caption = 'Зарезервировано (Учёт скидок)'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$CASHKEY'
                    ReadOnly = False
                    Title.Caption = 'Касса'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$DEPOTKEY'
                    ReadOnly = False
                    Title.Caption = 'Подразделение'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$DOCKEY'
                    ReadOnly = False
                    Title.Caption = 'Ссылка на документ'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'USR$EQRATE'
                    ReadOnly = False
                    Title.Caption = 'Курс эквивалента'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'U_USR$CASHKEY_USR$BN_NAME'
                    ReadOnly = False
                    Title.Caption = 'Кассовый аппарат'
                    Width = -1
                    Visible = False
                  end
                  item
                    Expanded = False
                    FieldName = 'U_USR$DEPOTKEY_NAME'
                    ReadOnly = False
                    Title.Caption = 'Наименование'
                    Width = -1
                    Visible = False
                  end
                  item
                    Alignment = taRightJustify
                    Expanded = False
                    FieldName = 'AFULL'
                    ReadOnly = False
                    Title.Caption = 'Полный доступ'
                    Width = -1
                    Visible = False
                  end
                  item
                    Alignment = taRightJustify
                    Expanded = False
                    FieldName = 'ACHAG'
                    ReadOnly = False
                    Title.Caption = 'Просмотр и редактирование'
                    Width = -1
                    Visible = False
                  end
                  item
                    Alignment = taRightJustify
                    Expanded = False
                    FieldName = 'AVIEW'
                    ReadOnly = False
                    Title.Caption = 'Только просмотр'
                    Width = -1
                    Visible = False
                  end>
              end
            end
            object pnChoose: TPanel
              Top = 557
              Width = 1609
              object pnButtonChoose: TPanel
                Left = 1504
                object btnCancelChoose: TButton
                end
                object btnOkChoose: TButton
                end
                object btnDeleteChoose: TButton
                end
              end
              object ibgrChoose: TgsIBGrid
                Width = 1504
                Expands = <>
                Conditions = <>
                ColumnEditors = <>
                Aliases = <>
              end
              object pnlChooseCaption: TPanel
                Width = 1609
              end
            end
          end
          object alMain: TActionList
            Left = 92
            Top = 136
            object actNew: TAction
            end
            object actEdit: TAction
            end
            object actDelete: TAction
            end
            object actDuplicate: TAction
            end
            object actHlp: TAction
            end
            object actPrint: TAction
            end
            object actCut: TAction
            end
            object actCopy: TAction
            end
            object actPaste: TAction
            end
            object actCommit: TAction
            end
            object actRollback: TAction
            end
            object actMacros: TAction
            end
            object actFind: TAction
            end
            object actMainReduction: TAction
            end
            object actFilter: TAction
            end
            object actProperties: TAction
            end
            object actLoadFromFile: TAction
            end
            object actSaveToFile: TAction
            end
            object actSearchMain: TAction
            end
            object actSearchMainClose: TAction
            end
            object actOnlySelected: TAction
            end
            object actAddToSelected: TAction
            end
            object actRemoveFromSelected: TAction
            end
            object actQExport: TAction
            end
            object actMainToSetting: TAction
            end
            object actChooseOk: TAction
            end
            object actDeleteChoose: TAction
            end
            object actCopySettingsFromUser: TAction
            end
            object actSelectAll: TAction
            end
            object actUnSelectAll: TAction
            end
            object actClearSelection: TAction
            end
            object actEditInGrid: TAction
            end
            object actLinkObject: TAction
            end
            object actDistributeSettings: TAction
            end
            object actDontSaveSettings: TAction
            end
            object actAddToSelectedFromClipboard: TAction
            end
            object actCreateEntry: TAction
            end
            object actGotoEntry: TAction
            end
          end
          object pmMain: TPopupMenu
            Left = 124
            Top = 204
            object nNew_OLD: TMenuItem
            end
            object nEdit_OLD: TMenuItem
            end
            object nDel_OLD: TMenuItem
            end
            object nDublicate_OLD: TMenuItem
            end
            object nProperties_OLD: TMenuItem
            end
            object nQExport_OLD: TMenuItem
            end
            object nSeparator1_OLD: TMenuItem
            end
            object actCopy1_OLD: TMenuItem
            end
            object actCut1_OLD: TMenuItem
            end
            object actPaste1_OLD: TMenuItem
            end
            object nSepartor2_OLD: TMenuItem
            end
            object nFind_OLD: TMenuItem
            end
            object nReduction_OLD: TMenuItem
            end
            object nSeparator3_OLD: TMenuItem
            end
            object actAddToSelected1: TMenuItem
            end
            object actAddToSelectedFromClipboard1: TMenuItem
            end
            object actRemoveFromSelected1: TMenuItem
            end
            object sprSetting: TMenuItem
            end
            object miMainToSetting: TMenuItem
            end
          end
          object dsMain: TDataSource
            Left = 92
            Top = 204
          end
          object gdMacrosMenu: TgdMacrosMenu
            Left = 249
            Top = 103
          end
          object dsChoose: TDataSource
            Left = 153
            Top = 306
          end
          object pmFind: TPopupMenu
            Left = 17
            Top = 78
            object miRemoveFromSearch: TMenuItem
            end
          end
          object gdcUserDocument: TgdcUserDocument
            Left = 169
            Top = 105
          end
          object IBTransaction: TIBTransaction
            Params.Strings = (
              'read_committed'
              'rec_version'
              'nowait')
            Left = 217
            Top = 105
          end
        end
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 151296311_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151296309_1959566044
    Fields: 
      NAME: "Macros151291400_1959566044151296311_1959566044"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "MACROS"
      MODULECODE: "147014551_23783130 gdc_frmInvDocument147006557_63934951"
      OBJECTNAME: "gdc_frmInvDocument147006557_63934951"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-07-01T15:54:36+03:00
      DISPLAYSCRIPT: | 
        MACROS151291400_1959566044151296311_1959566044
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNURkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub Macros151291400_1959566044151296311_1959566044(OwnerForm)
          dim Obj, Creator, ibSQL, q
          set Creator = new TCreator
          set Obj = OwnerForm.gdcObject
          
          if Application.MessageBox("По документу будет создан документ дооценки. Продолжить?", "Внимание", vbYEsNo + vbSystemModal+ vbInformation)=vbNo Then
             call Application.MessageBox("Операция прервана!", "Внимание", vbOkOnly + vbSystemModal+ vbInformation)
             exit sub
          end if
          Obj.First
          
          set q = Creator.GetObject(nil, "TIBSQL", "")
          q.Transaction = gdcBaseManager.ReadTransaction
          q.SQL.Text = _
          "SELECT " & _
          "SUM(L.USR$SUMROUND) as SUMROUND " & _
          "FROM USR$INV_RETAILLINE L " & _
          "where l.MASTERKEY = :dockey "
        
          
          dim todocsales
          set todocsales = Creator.GetObject(nil, "TgdcUserDocument", "")
          todocsales.SubType = "151281524_1959566044"
          todocsales.open
          
          q.Close
          q.ParamByname("dockey").AsInteger = Obj.ID
          q.ExecQuery
             
             if not Obj.EOF Then
               if q.FieldByName("SUMROUND").asCurrency <> 0 Then
                  todocsales.Insert
                  todocsales.FieldByname("documentdate").AsDateTime = Obj.FieldByName("DOCUMENTDATE").asDateTime
                  todocsales.FieldByname("USR$CASHKEY").AsVariant = null
                  todocsales.FieldByname("USR$DOCKEY").AsInteger = Obj.ID
                  todocsales.FieldByname("USR$DEPOTKEY").AsInteger = Obj.FieldByName("USR$CONTACTKEY").AsInteger
                  todocsales.FieldByname("USR$SUMM").AsCurrency = -1*q.FieldByName("SUMROUND").asCurrency
                  todocsales.Post
                  todocsales.CreateEntry
               end if
             end if
        
        End Sub
        
  - 
    Properties: 
      Class: "TgdcMacros"
      RUID: 151296309_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Сформировать дооценку по документу"
      DISPLAYINMENU: 1
      EXECUTEDATE: ~
      FUNCTIONKEY: "151296311_1959566044 Macros151291400_1959566044151296311_1959566044"
      ISLOCALEXECUTE: 0
      ISREBUILD: 0
      MACROSGROUPKEY: "147014573_23783130 Локальные макросы"
      OBJECTNAME: "gdc_frmInvDocument147006557_63934951"
      SERVERKEY: ~
      SHORTCUT: 0
      EDITIONDATE: 2023-07-01T15:54:36+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 151291400_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 151291398_1959566044
    Fields: 
      NAME: "Macros151291400_1959566044"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "MACROS"
      MODULECODE: "147014551_23783130 gdc_frmInvDocument147006557_63934951"
      OBJECTNAME: "gdc_frmInvDocument147006557_63934951"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-07-01T15:50:22+03:00
      DISPLAYSCRIPT: | 
        MACROS151291400_1959566044
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNURkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub Macros151291400_1959566044(OwnerForm)
          dim Obj, Creator, ibSQL, q
          set Creator = new TCreator
          set Obj = OwnerForm.gdcObject
          
          if Application.MessageBox("По списку документов будет созданы документы дооценки. Продолжить?", "Внимание", vbYEsNo + vbSystemModal+ vbInformation)=vbNo Then
             call Application.MessageBox("Операция прервана!", "Внимание", vbOkOnly + vbSystemModal+ vbInformation)
             exit sub
          end if
          Obj.First
          
          set q = Creator.GetObject(nil, "TIBSQL", "")
          q.Transaction = gdcBaseManager.ReadTransaction
          q.SQL.Text = _
          "SELECT " & _
          "SUM(L.USR$SUMROUND) as SUMROUND " & _
          "FROM USR$INV_RETAILLINE L " & _
          "where l.MASTERKEY = :dockey "
        
          
          dim todocsales
          set todocsales = Creator.GetObject(nil, "TgdcUserDocument", "")
          todocsales.SubType = "151281524_1959566044"
          todocsales.open
          
          
        
        
          
          While not Obj.EOF
             q.Close
             q.ParamByname("dockey").AsInteger = Obj.ID
             q.ExecQuery
             
             if not Obj.EOF Then
               if q.FieldByName("SUMROUND").asCurrency <> 0 Then
                  todocsales.Insert
                  todocsales.FieldByname("documentdate").AsDateTime = Obj.FieldByName("DOCUMENTDATE").asDateTime
                  todocsales.FieldByname("USR$CASHKEY").AsVariant = null
                  todocsales.FieldByname("USR$DOCKEY").AsInteger = Obj.ID
                  todocsales.FieldByname("USR$DEPOTKEY").AsInteger = Obj.FieldByName("USR$CONTACTKEY").AsInteger
                  todocsales.FieldByname("USR$SUMM").AsCurrency = -1*q.FieldByName("SUMROUND").asCurrency
                  todocsales.Post
                  todocsales.CreateEntry
               end if
             end if
             Obj.next
          wend
        
        End Sub
        
  - 
    Properties: 
      Class: "TgdcMacros"
      RUID: 151291398_1959566044
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Сформировать дооценку по списку документов"
      DISPLAYINMENU: 1
      EXECUTEDATE: ~
      FUNCTIONKEY: "151291400_1959566044 Macros151291400_1959566044"
      ISLOCALEXECUTE: 0
      ISREBUILD: 0
      MACROSGROUPKEY: "147014573_23783130 Локальные макросы"
      OBJECTNAME: "gdc_frmInvDocument147006557_63934951"
      SERVERKEY: ~
      SHORTCUT: 0
      EDITIONDATE: 2023-07-01T15:50:22+03:00