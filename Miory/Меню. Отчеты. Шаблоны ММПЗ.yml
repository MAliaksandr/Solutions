%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 160950163_1836100572
  Name: "Меню. Отчеты. Шаблоны ММПЗ"
  Caption: "Меню. Отчеты. Шаблоны ММПЗ"
  Version: "1.0.0.2"
  Optional: False
  Internal: True
  MD5: 874123675FFC6796E3B604D4EDCF247B
Uses: 
  - "147070091_311980179 GS new. Общепит бэк. Документы. Меню"
Objects: 
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 147066955_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147066945_1606276715
    Fields: 
      NAME: "Меню147066955_1606276715"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR"
      EDITIONDATE: 2022-02-21T16:30:46+03:00
      TEMPLATEDATA: !!binary > 
        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
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147066946_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147066945_1606276715
    Fields: 
      NAME: "rp_Main147015402_9263644147066946_1606276715"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147014299_9263644 gdc_frmUserComplexDocument147014188_52143670"
      OBJECTNAME: "gdc_frmUserComplexDocument147014188_52143670"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-02-21T16:31:13+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147015402_9263644147066946_1606276715
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAQAAABRRElSCQAAANPy4uXw5uTg/goAAABHRF9DT05UQUNUBAAAAG5hbWUCAAAA
        aWQHDwAAAGNvbnRhY3R0eXBlID0gMgAAAAACAAAAXkFGTlNUUFJTVAMAAABNT0wMAAAA0PPq7uLu
        5Ojy5ev8CgAAAEdEX0NPTlRBQ1QEAAAAbmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAA
        AAIAAABeQUZOU1RQUlNUAwAAAFpBVg0AAADO8uLl8vHy4uXt7fvpCgAAAEdEX0NPTlRBQ1QEAAAA
        bmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAAAAIAAABeQUZOU1RGTFBS
      SCRIPT: | 
        function rp_Main147015402_9263644147066946_1606276715(OwnerForm, qDir, Mol, Zav)
        
          doc = OwnerForm.SelectedKey
          id = "(" + Join(doc(0), ",") + ")"
          
          BaseQueryList.Clear
          
          set Contact2 = BaseQueryList.Query(BaseQueryList.Add("Responsible2", 0))
          Contact2.SQL = _
            "SELECT " & _
            "con.name , " & _
            "p.NICKNAME, ps.NAME as rank " & _
            "FROM gd_contact con " & _
            "JOIN gd_people p on p.contactkey = con.id " & _
            "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
            "WHERE con.id = :id "
          Contact2.ParamByName("id").AsInteger = Zav(0)
          Contact2.Open
        
          set qMol = BaseQueryList.Query(BaseQueryList.Add("Mol", 0))
          qMol.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          qMol.ParamByName("id").AsInteger = Mol(0)
          qMol.Open
        
          set aDir = BaseQueryList.Query(BaseQueryList.Add("qDir", 0))
          aDir.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          aDir.ParamByName("id").AsInteger = qDir(0)
          aDir.Open
        
        
          set q = BaseQueryList.Query(BaseQueryList.Add("Menu", 0))
          q.SQL = " SELECT mn.usr$name, mm.usr$todate, con.name depotname, doc.documentdate, mm.documentkey " + _
              "  FROM usr$mn_menu mm " + _
              " JOIN usr$mn_menuname mn on mm.usr$menunamekey = mn.id " + _
              " JOIN gd_contact con on mm.usr$depotkey = con.id " + _
              " JOIN GD_DOCUMENT doc ON doc.id = mm.documentkey " + _
              " WHERE doc.id IN " + ID
        
          set qmenu = BaseQueryList.Query(BaseQueryList.Add("Menuline", 0))
          qmenu.SQL =  _
            " SELECT g_s_delchar(g.alias) as goodalias, g.description, " & _
            " coalesce(mc.usr$outputstr, '1шт.') as usr$outputstr, ml.usr$cost, g.name, " + _
            " max(gg.name) as groupname, max(gg.alias) as groupalias, " & _
            " ml.masterkey, mc.documentkey as cardkey, ml.documentkey " + _
            " FROM usr$mn_menuline ml " + _
            " join gd_document d on d.id = ml.documentkey " & _
            " left JOIN usr$mn_menu mm on mm.documentkey = ml.masterkey " + _
            " left JOIN gd_good g on g.id = ml.usr$goodkey " + _
            " left JOIN usr$mn_calccard mc on mc.documentkey = ml.usr$cardkey " + _
            " left JOIN GD_GOODGROUP gg on gg.id = g.groupkey " + _
            " WHERE d.DISABLED <> 1 and ml.masterkey in"  + ID + _
            "group by 1, 2, 3, 4, 5, 8, 9, 10 " & _
            " ORDER BY 7, 5 "
          q.Open
          q.IsResult = 1
          qmenu.Open
          qmenu.IsResult = 1
        
        
          BaseQueryList.AddMasterDetail "Menu","documentkey", "Menuline", "masterkey;groupalias;goodalias"
        
          set rp_Main147015402_9263644147066946_1606276715 = BaseQueryList
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 147066945_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Меню \"ММПЗ-групп\""
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "147066946_1606276715 rp_Main147015402_9263644147066946_1606276715"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147014580_9263644 Отчеты(gdc_frmUserComplexDocument147014188_52143670)"
      SERVERKEY: ~
      TEMPLATEKEY: "147066955_1606276715 Меню147066955_1606276715"
      EDITIONDATE: 2022-02-21T16:31:13+03:00
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 149788735_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 149788725_1606276715
    Fields: 
      NAME: "Меню147066955_1606276715149788735_1606276715"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR"
      EDITIONDATE: 2022-02-21T16:23:15+03:00
      TEMPLATEDATA: !!binary > 
        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
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 149788726_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 149788725_1606276715
    Fields: 
      NAME: "rp_Main147015402_9263644147066946_160627149788726_1606276715"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147014299_9263644 gdc_frmUserComplexDocument147014188_52143670"
      OBJECTNAME: "gdc_frmUserComplexDocument147014188_52143670"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-02-21T16:28:08+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147015402_9263644147066946_160627149788726_1606276715
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAQAAABRRElSCQAAANPy4uXw5uTg/goAAABHRF9DT05UQUNUBAAAAG5hbWUCAAAA
        aWQHDwAAAGNvbnRhY3R0eXBlID0gMgAAAAACAAAAXkFGTlNUUFJTVAMAAABNT0wMAAAA0PPq7uLu
        5Ojy5ev8CgAAAEdEX0NPTlRBQ1QEAAAAbmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAA
        AAIAAABeQUZOU1RQUlNUAwAAAFpBVg0AAADO8uLl8vHy4uXt7fvpCgAAAEdEX0NPTlRBQ1QEAAAA
        bmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAAAAIAAABeQUZOU1RGTFBS
      SCRIPT: | 
        function rp_Main147015402_9263644147066946_160627149788726_1606276715(OwnerForm, qDir, Mol, Zav)
        
          doc = OwnerForm.SelectedKey
          id = "(" + Join(doc(0), ",") + ")"
          
          BaseQueryList.Clear
          
          set Contact2 = BaseQueryList.Query(BaseQueryList.Add("Responsible2", 0))
          Contact2.SQL = _
            "SELECT " & _
            "con.name , " & _
            "p.NICKNAME, ps.NAME as rank " & _
            "FROM gd_contact con " & _
            "JOIN gd_people p on p.contactkey = con.id " & _
            "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
            "WHERE con.id = :id "
          Contact2.ParamByName("id").AsInteger = Zav(0)
          Contact2.Open
        
          set qMol = BaseQueryList.Query(BaseQueryList.Add("Mol", 0))
          qMol.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          qMol.ParamByName("id").AsInteger = Mol(0)
          qMol.Open
          
          set aDir = BaseQueryList.Query(BaseQueryList.Add("qDir", 0))
          aDir.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          aDir.ParamByName("id").AsInteger = qDir(0)
          aDir.Open
          
          
          set q = BaseQueryList.Query(BaseQueryList.Add("Menu", 0))
          q.SQL = " SELECT mn.usr$name, mm.usr$todate, con.name depotname, doc.documentdate, mm.documentkey " + _
              "  FROM usr$mn_menu mm " + _
              " JOIN usr$mn_menuname mn on mm.usr$menunamekey = mn.id " + _
              " JOIN gd_contact con on mm.usr$depotkey = con.id " + _
              " JOIN GD_DOCUMENT doc ON doc.id = mm.documentkey " + _
              " WHERE doc.id IN " + ID
        
          set qmenu = BaseQueryList.Query(BaseQueryList.Add("Menuline", 0))
          qmenu.SQL =  _
            " SELECT g_s_delchar(g.alias) as goodalias, " & _
            " CAST(LIST(lower(TRIM(COALESCE(CAST(rc.GOODNAME as VARCHAR(60)),' ')))) as  VARCHAR(500)) as description, " & _
            " coalesce(mc.usr$outputstr, '1шт.') as usr$outputstr, ml.usr$cost, g.name, " + _
            " max(gg.name) as groupname, max(gg.alias) as groupalias, " & _
            " ml.masterkey, mc.documentkey as cardkey, ml.documentkey " + _
            " FROM usr$mn_menuline ml " + _
            " join gd_document d on d.id = ml.documentkey " & _
            " left JOIN usr$mn_menu mm on mm.documentkey = ml.masterkey " + _
            " left JOIN gd_good g on g.id = ml.usr$goodkey " + _
            " left JOIN usr$mn_calccard mc on mc.documentkey = ml.usr$cardkey " + _
            " LEFT JOIN USR$MN_GET_RECEIPT_COMPONENTS(mc.USR$RECEIPTKEY) rc on 1=1 and rc.subheader = 0 " & _
            " left JOIN GD_GOODGROUP gg on gg.id = g.groupkey " + _
            " WHERE d.DISABLED <> 1 and ml.masterkey in"  + ID + _
            "group by 1, 3, 4, 5, 8, 9, 10 " & _
            " ORDER BY 7, 5 "
          q.Open
          'q.IsResult = 1
          qmenu.Open
         ' qmenu.IsResult = 1
          
           dim qcon
           set qcon = BaseQueryList.Query(BaseQueryList.Add("comp",0))
          qcon.SQL = "SELECT * FROM gd_contact WHERE id = :id "
          qcon.ParamByName("id").AsInteger = IBLogin.CompanyKey
          qcon.Open
        
        
          BaseQueryList.AddMasterDetail "Menu","documentkey", "Menuline", "masterkey;groupalias;goodalias"
        
          set rp_Main147015402_9263644147066946_160627149788726_1606276715 = BaseQueryList
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 149788725_1606276715
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Меню \"ММПЗ-групп\" группы"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "149788726_1606276715 rp_Main147015402_9263644147066946_160627149788726_1606276715"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147014580_9263644 Отчеты(gdc_frmUserComplexDocument147014188_52143670)"
      SERVERKEY: ~
      TEMPLATEKEY: "149788735_1606276715 Меню147066955_1606276715149788735_1606276715"
      EDITIONDATE: 2022-02-21T16:28:08+03:00
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 147099863_1616313806
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147099829_1616313806
    Fields: 
      NAME: "План-меню \"ММПЗ-групп\""
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2022-02-21T16:37:30+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44239,5803163079" ReportOptions.Description.Text="" ReportOptions.LastChange="44239,5803163079" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2200000020446174615365743D22434F4D502220446174615365744E616D653D22434F4D502200010C2400000020446174615365743D22434F4D50312220446174615365744E616D653D22434F4D50312200010C2200000020446174615365743D224D454E552220446174615365744E616D653D224D454E552200010C2A00000020446174615365743D224D454E554C494E452220446174615365744E616D653D224D454E554C494E452200010C2000000020446174615365743D224D4F4C2220446174615365744E616D653D224D4F4C2200010C2200000020446174615365743D22514449522220446174615365744E616D653D22514449522200010C3200000020446174615365743D22524553504F4E5349424C45322220446174615365744E616D653D22524553504F4E5349424C4532220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="309,92146" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="585,82715" Top="19,89765" Width="132,28355" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РљРѕРґ"/>
              <TfrxMemoView Name="Memo2" Left="585,82715" Top="38,7953" Width="132,28355" Height="18,89765" GroupIndex="1" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo3" Left="585,82715" Top="57,69295" Width="132,28355" Height="18,89765" GroupIndex="1" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo4" Left="585,82715" Top="76,5906" Width="132,28355" Height="18,89765" GroupIndex="1" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo5" Left="585,82715" Top="95,48825" Width="132,28355" Height="18,89765" GroupIndex="1" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo6" Left="585,82715" Top="114,3859" Width="132,28355" Height="18,89765" GroupIndex="1" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo7" Left="464,32313" Top="37,7953" Width="109,60637" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haRight" ParentFont="False" Text="Р¤РѕСЂРјР° РїРѕ РћРљРЈР”"/>
              <TfrxMemoView Name="Memo8" Left="464,88219" Top="56,69295" Width="109,60637" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haRight" ParentFont="False" Text="РїРѕ РћРљРџРћ"/>
              <TfrxMemoView Name="Memo9" Left="18,89765" Top="49,69295" Width="445,98454" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[COMP.&#34;NAME&#34;]"/>
              <TfrxMemoView Name="Memo10" Left="18,89765" Top="68,5906" Width="445,98454" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(РѕСЂРіР°РЅРёР·Р°С†РёСЏ)"/>
              <TfrxMemoView Name="Memo11" Left="18,89765" Top="75,5906" Width="445,98454" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[MENU.&#34;DEPOTNAME&#34;]"/>
              <TfrxMemoView Name="Memo12" Left="18,89765" Top="95,48825" Width="445,98454" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(СЃС‚СЂСѓРєС‚СѓСЂРЅРѕРµ РїРѕРґСЂР°Р·РґРµР»РµРЅРёРµ)"/>
              <TfrxMemoView Name="Memo13" Left="392,07112" Top="96,26778" Width="181,41744" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haRight" ParentFont="False" Text="Р’РёРґ РґРµСЏС‚РµР»СЊРЅРѕСЃС‚Рё РїРѕ РћРљР”Рџ"/>
              <TfrxMemoView Name="Memo14" Left="394,07112" Top="113,3859" Width="177,63791" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haRight" ParentFont="False" Text="Р’РёРґ РѕРїРµСЂР°С†РёРё"/>
              <TfrxMemoView Name="Memo17" Left="532,91373" Top="181,41744" Width="185,19697" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[QDIR.&#34;RANK&#34;]"/>
              <TfrxMemoView Name="Memo19" Left="532,91373" Top="200,31509" Width="185,19697" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(РґРѕР»Р¶РЅРѕСЃС‚СЊ)"/>
              <TfrxMemoView Name="Memo18" Left="532,91373" Top="207,87415" Width="64,25201" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo20" Left="532,91373" Top="226,7718" Width="64,25201" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/>
              <TfrxMemoView Name="Memo21" Left="604,7248" Top="207,87415" Width="113,3859" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[RESPONSIBLE2.&#34;NICKNAME&#34;]"/>
              <TfrxMemoView Name="Memo22" Left="604,7248" Top="226,7718" Width="113,3859" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(СЂР°СЃС€РёС„СЂРѕРІРєР° РїРѕРґРїРёСЃРё)"/>
              <TfrxMemoView Name="Memo24" Left="532,91373" Top="240,44898" Width="181,41744" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="[DATESTR(&#60;MENU.&#34;DOCUMENTDATE&#34;&#62;)]Рі."/>
              <TfrxMemoView Name="Memo23" Left="415,7483" Top="249,44898" Width="90,70872" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="1,5" HAlign="haCenter" ParentFont="False" Text="[MENU.&#34;DOCUMENTDATE&#34;]"/>
              <TfrxMemoView Name="Memo25" Left="415,7483" Top="214,21274" Width="90,70872" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="Р”Р°С‚Р° СЃРѕСЃС‚Р°РІР»РµРЅРёСЏ"/>
              <TfrxMemoView Name="Memo26" Left="325,03958" Top="249,44898" Width="90,70872" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="1,5" HAlign="haCenter" ParentFont="False" Text="[MENU.&#34;NUMBER&#34;]"/>
              <TfrxMemoView Name="Memo27" Left="325,03958" Top="214,21274" Width="90,70872" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="РќРѕРјРµСЂ РґРѕРєСѓРјРµРЅС‚Р°"/>
              <TfrxMemoView Name="Memo28" Left="188,9765" Top="246,66945" Width="120,94496" Height="22,67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="1" Frame.Width="1,5" HAlign="haCenter" ParentFont="False" Text="РџР›РђРќ - РњР•РќР®"/>
              <TfrxMemoView Name="Memo29" Left="183,75603" Top="272,12616" Width="124,72449" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="[DATESTR(&#60;MENU.&#34;DOCUMENTDATE&#34;&#62;)]Рі."/>
              <TfrxMemoView Name="Memo30" Left="162,51979" Top="272,12616" Width="18,89765" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="1,5" HAlign="haRight" ParentFont="False" Text="РЅР°"/>
              <TfrxMemoView Name="Memo63" Left="465,10266" Top="75,5906" Width="120,94496" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo64" Left="574,48856" Top="3,77953" Width="143,62214" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="12632256" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Date] [Time]"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="79,37013" Left="0" Top="389,29159" Width="718,1107">
              <TfrxMemoView Name="Memo31" Left="3,77953" Top="0" Width="26,45671" Height="64,25201" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ Рї/Рї"/>
              <TfrxMemoView Name="Memo32" Left="30,23624" Top="0" Width="480,00031" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р‘Р»СЋРґРѕ Рё РіР°СЂРЅРёСЂ"/>
              <TfrxMemoView Name="Memo33" Left="30,23624" Top="15,11812" Width="245,66945" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЅР°РёРјРµРЅРѕРІР°РЅРёРµ Рё РєСЂР°С‚РєР°СЏ С…Р°СЂР°РєС‚РµСЂРёСЃС‚РёРєР°"/>
              <TfrxMemoView Name="Memo34" Left="275,90569" Top="15,11812" Width="37,7953" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРѕРґ"/>
              <TfrxMemoView Name="Memo35" Left="313,70099" Top="15,11812" Width="124,72449" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЅРѕРјРµСЂ Р±Р»СЋРґР° РїРѕ СЃР±РѕСЂРЅРёРєСѓ СЂРµС†РµРїС‚СѓСЂ, РїРѕ РўРўРљ, РЎРўРџ"/>
              <TfrxMemoView Name="Memo36" Left="438,42548" Top="15,11812" Width="71,81107" Height="49,13389" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РІС‹С…РѕРґ РѕРґРЅРѕРіРѕ Р±Р»СЋРґР°, Рі."/>
              <TfrxMemoView Name="Memo37" Left="510,23655" Top="0" Width="71,81107" Height="64,25201" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ"/>
              <TfrxMemoView Name="Memo38" Left="582,04762" Top="0" Width="56,69295" Height="64,25201" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР° РїСЂРѕРґР°Р¶Рё, СЂСѓР±. РєРѕРї."/>
              <TfrxMemoView Name="Memo39" Left="638,74057" Top="0" Width="79,37013" Height="64,25201" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°, СЂСѓР±. РєРѕРї."/>
              <TfrxMemoView Name="Memo40" Left="3,77953" Top="64,25201" Width="26,45671" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1"/>
              <TfrxMemoView Name="Memo41" Left="30,23624" Top="64,25201" Width="245,66945" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2"/>
              <TfrxMemoView Name="Memo42" Left="275,90569" Top="64,25201" Width="37,7953" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3"/>
              <TfrxMemoView Name="Memo43" Left="313,70099" Top="64,25201" Width="124,72449" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4"/>
              <TfrxMemoView Name="Memo44" Left="438,42548" Top="64,25201" Width="71,81107" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5"/>
              <TfrxMemoView Name="Memo45" Left="510,23655" Top="64,25201" Width="71,81107" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6"/>
              <TfrxMemoView Name="Memo46" Left="582,04762" Top="64,25201" Width="56,69295" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7"/>
              <TfrxMemoView Name="Memo47" Left="638,74057" Top="64,25201" Width="79,37013" Height="15,11812" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="8"/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="491,3389" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="MENULINE" DataSetName="MENULINE" RowCount="0" Stretched="True">
              <TfrxMemoView Name="Memo48" Left="3,77953" Top="0" Width="26,45671" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line#]"/>
              <TfrxMemoView Name="Memo49" Left="30,23624" Top="0" Width="245,66945" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="NAME" DataSet="MENULINE" DataSetName="MENULINE" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;NAME&#34;]"/>
              <TfrxMemoView Name="Memo50" Left="275,90569" Top="0" Width="37,7953" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="GOODALIAS" DataSet="MENULINE" DataSetName="MENULINE" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;GOODALIAS&#34;]"/>
              <TfrxMemoView Name="Memo51" Left="313,70099" Top="0" Width="124,72449" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="USR$COLLECTIONNUM" DataSet="MENULINE" DataSetName="MENULINE" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;USR$COLLECTIONNUM&#34;]"/>
              <TfrxMemoView Name="Memo52" Left="438,42548" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="USR$OUTPUTSTR" DataSet="MENULINE" DataSetName="MENULINE" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;USR$OUTPUTSTR&#34;]"/>
              <TfrxMemoView Name="Memo53" Left="510,23655" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="USR$QUANTITY" DataSet="MENULINE" DataSetName="MENULINE" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;USR$QUANTITY&#34;]"/>
              <TfrxMemoView Name="Memo54" Left="582,04762" Top="0" Width="56,69295" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="USR$COST" DataSet="MENULINE" DataSetName="MENULINE" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MENULINE.&#34;USR$COST&#34;]"/>
              <TfrxMemoView Name="Memo55" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;MENULINE.&#34;SUMNCU&#34;&#62;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer1" Height="37,7953" Left="0" Top="532,91373" Width="718,1107">
              <TfrxMemoView Name="Memo56" Left="638,74057" Top="0" Width="79,37013" Height="22,67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="0,1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;MENULINE.&#34;SUMNCU&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo57" Left="525,35467" Top="0" Width="113,3859" Height="22,67718" ShowHint="False" AllowExpressions="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ"/>
            </TfrxFooter>
            <TfrxReportSummary Name="ReportSummary1" Height="75,5906" Left="0" Top="631,18151" Width="718,1107">
              <TfrxMemoView Name="Memo58" Left="18,89765" Top="11,33859" Width="188,9765" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MOL.&#34;RANK&#34;]"/>
              <TfrxMemoView Name="Memo59" Left="207,87415" Top="11,33859" Width="132,28355" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text=""/>
              <TfrxMemoView Name="Memo60" Left="207,87415" Top="30,23624" Width="132,28355" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/>
              <TfrxMemoView Name="Memo61" Left="355,27582" Top="11,33859" Width="287,24428" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="[MOL.&#34;NICKNAME&#34;]"/>
              <TfrxMemoView Name="Memo62" Left="355,27582" Top="30,23624" Width="287,24428" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Width="0,1" HAlign="haCenter" ParentFont="False" Text="(СЂР°СЃС€РёС„СЂРѕРІРєР° РїРѕРґРїРёСЃРё)"/>
            </TfrxReportSummary>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147099830_1616313806
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147099829_1616313806
    Fields: 
      NAME: "rp_Main147015402_9263644147066946_160627147099830_1616313806"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147014299_9263644 gdc_frmUserComplexDocument147014188_52143670"
      OBJECTNAME: "gdc_frmUserComplexDocument147014188_52143670"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-02-21T16:37:30+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147015402_9263644147066946_160627147099830_1616313806
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAQAAABRRElSCQAAANPy4uXw5uTg/goAAABHRF9DT05UQUNUBAAAAG5hbWUCAAAA
        aWQHDwAAAGNvbnRhY3R0eXBlID0gMgAAAAACAAAAXkFGTlNUUFJTVAMAAABNT0wMAAAA0PPq7uLu
        5Ojy5ev8CgAAAEdEX0NPTlRBQ1QEAAAAbmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAA
        AAIAAABeQUZOU1RQUlNUAwAAAFpBVg0AAADO8uLl8vHy4uXt7fvpCgAAAEdEX0NPTlRBQ1QEAAAA
        bmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAAAAIAAABeQUZOU1RGTFBS
      SCRIPT: | 
        function rp_Main147015402_9263644147066946_160627147099830_1616313806(OwnerForm, qDir, Mol, Zav)
        
          doc = OwnerForm.SelectedKey
          id = "(" + Join(doc(0), ",") + ")"
          
          BaseQueryList.Clear
          
          set Contact2 = BaseQueryList.Query(BaseQueryList.Add("Responsible2", 0))
          Contact2.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          Contact2.ParamByName("id").AsInteger = Zav(0)
          Contact2.Open
        
          set qMol = BaseQueryList.Query(BaseQueryList.Add("Mol", 0))
          qMol.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          qMol.ParamByName("id").AsInteger = Mol(0)
          qMol.Open
        
          set aDir = BaseQueryList.Query(BaseQueryList.Add("qDir", 0))
          aDir.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          aDir.ParamByName("id").AsInteger = qDir(0)
          aDir.Open
        
        
          set q = BaseQueryList.Query(BaseQueryList.Add("Menu", 0))
          q.SQL = " SELECT mn.usr$name, mm.usr$todate, con.name depotname, doc.documentdate,doc.number,  mm.documentkey " + _
              "  FROM usr$mn_menu mm " + _
              " JOIN usr$mn_menuname mn on mm.usr$menunamekey = mn.id " + _
              " JOIN gd_contact con on mm.usr$depotkey = con.id " + _
              " JOIN GD_DOCUMENT doc ON doc.id = mm.documentkey " + _
              " WHERE doc.id IN " + ID
        
          set qmenu = BaseQueryList.Query(BaseQueryList.Add("Menuline", 0))
          qmenu.SQL =  _
            " SELECT g_s_delchar(g.alias) as goodalias, g.description, " & _
            " coalesce(mc.usr$outputstr, '1шт.') as usr$outputstr, ml.usr$cost, g.name, " & _
            " CAST(1 as Integer) as usr$quantity, " + _
            " max(gg.name) as groupname, max(gg.alias) as groupalias, " & _
            " ml.masterkey, mc.documentkey as cardkey, ml.documentkey, rec.USR$COLLECTIONNUM, " + _
            " SUM(1*ml.usr$cost) as SUMNCU " & _
            " FROM usr$mn_menuline ml " + _
            " join gd_document d on d.id = ml.documentkey " & _
            " left JOIN usr$mn_menu mm on mm.documentkey = ml.masterkey " + _
            " left JOIN gd_good g on g.id = ml.usr$goodkey " + _
            " left JOIN usr$mn_calccard mc on mc.documentkey = ml.usr$cardkey " + _
            " left join usr$mn_receipt rec on rec.documentkey = mc.USR$RECEIPTKEY " & _
            " left JOIN GD_GOODGROUP gg on gg.id = g.groupkey " + _
            " WHERE d.DISABLED <> 1 and ml.masterkey in"  + ID + _
            "group by 1, 2, 3, 4, 5,6,  9, 10, 11, 12 " & _
            " ORDER BY 7, 5 "
          q.Open
          q.IsResult = 1
          qmenu.Open
          qmenu.IsResult = 1
          
           set qcon = BaseQueryList.Query(BaseQueryList.Add("comp",0))
          qcon.SQL = "SELECT * FROM gd_contact WHERE id = :id "
          qcon.ParamByName("id").AsInteger = IBLogin.CompanyKey
          qcon.Open
        
          set qcon1 = BaseQueryList.Query(BaseQueryList.Add("comp1",0))
          qcon1.SQL = "SELECT c.name FROM usr$mn_pilot p " & _
          "left join gd_contact c on c.id = p.usr$contactkey " & _
          " where p.documentkey in  " & ID
          qcon1.Open
        
        
          BaseQueryList.AddMasterDetail "Menu","documentkey", "Menuline", "masterkey;groupalias;goodalias"
        
          set rp_Main147015402_9263644147066946_160627147099830_1616313806 = BaseQueryList
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 147099829_1616313806
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "План-меню \"ММПЗ-групп\""
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "147099830_1616313806 rp_Main147015402_9263644147066946_160627147099830_1616313806"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147014580_9263644 Отчеты(gdc_frmUserComplexDocument147014188_52143670)"
      SERVERKEY: ~
      TEMPLATEKEY: "147099863_1616313806 План-меню \"ММПЗ-групп\""
      EDITIONDATE: 2022-02-21T16:37:30+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147100112_1616313806
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147100111_1616313806
    Fields: 
      NAME: "rp_Main147416974_629495083147594579_6330147100112_1616313806"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147103191_546801707 gdc_frmUserComplexDocument147103186_546801707"
      OBJECTNAME: "gdc_frmUserComplexDocument147103186_546801707"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-02-21T16:59:18+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147416974_629495083147594579_6330147100112_1616313806
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAQAAABRRElSCQAAANPy4uXw5uTg/goAAABnZF9jb250YWN0BAAAAG5hbWUCAAAA
        aWQHDwAAAGNvbnRhY3R0eXBlID0gMgAAAAACAAAAXkFGTlNUUFJTVAMAAABNT0wMAAAA0PPq7uLu
        5Ojy5ev8CgAAAGdkX2NvbnRhY3QEAAAAbmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAA
        AAIAAABeQUZOU1RQUlNUAwAAAFpBVg0AAADO8uLl8vHy4uXt7fvpCgAAAGdkX2NvbnRhY3QEAAAA
        bmFtZQIAAABpZAcPAAAAY29udGFjdHR5cGUgPSAyAAAAAAIAAABeQUZOU1RGTFBS
      SCRIPT: | 
        function rp_Main147416974_629495083147594579_6330147100112_1616313806(OwnerForm, qDir, Mol, Zav)
        
          doc = OwnerForm.SelectedKey
          id = "(" + join(doc(0), ",") + ")"
        
          BaseQueryList.Clear
        
          if id = "" then
            set rp_Main154019548_320055258 = BaseQueryList
            exit function
          end if
          
          set Contact2 = BaseQueryList.Query(BaseQueryList.Add("Responsible2", 0))
          Contact2.SQL = _
            "SELECT " & _
            "con.name , " & _
            "p.NICKNAME, ps.NAME as rank " & _
            "FROM gd_contact con " & _
            "JOIN gd_people p on p.contactkey = con.id " & _
            "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
            "WHERE con.id = :id "
          Contact2.ParamByName("id").AsInteger = Zav(0)
          Contact2.Open
        
          set qMol = BaseQueryList.Query(BaseQueryList.Add("Mol", 0))
          qMol.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          qMol.ParamByName("id").AsInteger = Mol(0)
          qMol.Open
        
          set aDir = BaseQueryList.Query(BaseQueryList.Add("qDir", 0))
          aDir.SQL = _
          "SELECT " & _
          "con.name , " & _
          "p.NICKNAME, ps.NAME as rank " & _
          "FROM gd_contact con " & _
          "JOIN gd_people p on p.contactkey = con.id " & _
          "LEFT JOIN WG_POSITION ps on ps.ID = p.WPOSITIONKEY " & _
          "WHERE con.id = :id "
          aDir.ParamByName("id").AsInteger = qDir(0)
          aDir.Open
        
        
          set q = BaseQueryList.Query(BaseQueryList.Add("MENU", 0))
          q.SQL =  _
              " SELECT " & _
              " mn.usr$name, " & _
              " mm.usr$todate, " & _
              " con.name depotname, " & _
              " doc.documentdate,doc.NUMBER, " & _
              " mm.documentkey " & _
              " FROM GD_DOCUMENT doc " & _
              " left JOIN usr$mn_menu mm ON doc.id = mm.documentkey " & _
              " left JOIN usr$mn_menuname mn on mm.usr$menunamekey = mn.id " & _
              " LEFT JOIN USR$MN_PILOT p ON p.DOCUMENTKEY  =  doc.ID " & _
              " left JOIN gd_contact con on COALESCE(mm.usr$depotkey,p.USR$DEPOTKEY) = con.id "  & _
              " WHERE doc.id IN " + ID
          q.Open
          q.IsResult = 1
        
          set S = BaseQueryList.Query(BaseQueryList.Add("Menuline", 0))
          S.SQl = _
            " select " & _
            "   gg.name as name, " & _
            "   gg.alias as goodalias, " & _
            "   coalesce(rec.usr$output, '1шт.') as usr$outputstr, " & _
            "   gd.documentdate, " & _
            "   gd.number, rec.USR$COLLECTIONNUM, " & _
            "   dep.name as departname, " & _
            "   ROUND(c.usr$costcource,2) as usr$cost, " & _
            "   pl.usr$quantity, " & _
            "   round( ROUND(c.usr$costcource,2) * pl.usr$quantity, 2) as sumncu " & _
            " from " & _
            "   usr$mn_pilot p " & _
            "   left JOIN usr$mn_pilotline pl on pl.masterkey = p.documentkey " & _
            "   left JOIN usr$mn_receipt rec on rec.documentkey = pl.usr$receiptkey " & _
            "   left join gd_document gd on gd.id = p.documentkey " & _
            "   left join gd_good gg on gg.id = rec.usr$goodkey " & _
            "   left join gd_contact gc on gc.id = gd.companykey   " & _
            "   LEFT JOIN gd_contact dep on dep.id = p.USR$DEPOTKEY " & _
            "   Left join usr$mn_calccard c on c.USR$PILOTLINEKEY = pl.documentkey " & _
            " where p.documentkey in  " & ID & _
            " ORDER BY gg.Name "
          s.Open
          
          set qcon = BaseQueryList.Query(BaseQueryList.Add("comp",0))
          qcon.SQL = "SELECT * FROM gd_contact WHERE id = :id "
          qcon.ParamByName("id").AsInteger = IBLogin.CompanyKey
          qcon.Open
          
          set qcon1 = BaseQueryList.Query(BaseQueryList.Add("comp1",0))
          qcon1.SQL = "SELECT c.name FROM usr$mn_pilot p " & _
          "left join gd_contact c on c.id = p.usr$contactkey " & _
          " where p.documentkey in  " & ID
          qcon1.Open
          
          set rp_Main147416974_629495083147594579_6330147100112_1616313806 = BaseQueryList
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 147100111_1616313806
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "План-меню \"ММПЗ-групп\""
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "147100112_1616313806 rp_Main147416974_629495083147594579_6330147100112_1616313806"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147103195_557262679 Отчеты(gdc_frmUserComplexDocument147103186_546801707)"
      SERVERKEY: ~
      TEMPLATEKEY: "147099863_1616313806 План-меню \"ММПЗ-групп\""
      EDITIONDATE: 2022-02-21T16:59:18+03:00