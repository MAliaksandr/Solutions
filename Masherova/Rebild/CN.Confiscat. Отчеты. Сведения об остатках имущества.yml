%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 147135277_2119873798
  Name: "CN.Confiscat. Отчеты. Сведения об остатках имущества"
  Caption: "CN.Confiscat. Отчеты. Сведения об остатках имущества"
  Version: "1.0.0.3"
  Optional: False
  Internal: True
  MD5: 64E782E62E829F830D8CDAC5B21E24F9
Uses: 
  - "148509668_396646306 Торговля - исследователь"
  - "147059933_2089375573 CN.Confiscat. Таблицы, поля, домены и справочники"
Objects: 
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147053281_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147135177_2119873798
    Fields: 
      PARENT: ~
      NAME: "TgdcExplorer"
      DESCRIPTION: ~
      USERGROUPNAME: "TGDCEXPLORER"
      EDITIONDATE: 2023-04-29T15:14:08+02:00
  - 
    Properties: 
      Class: "TgdcExplorer"
      RUID: 147135175_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147135177_2119873798
    Fields: 
      PARENT: "147047538_2082756242 Исследователь\\Торговля\\00.Конфискат"
      NAME: "Отчеты конфискат"
      CLASSNAME: ~
      CMD: "147135175_2119873798"
      CMDTYPE: 0
      HOTKEY: ~
      IMGINDEX: 15
      ORDR: ~
      SUBTYPE: ~
      EDITIONDATE: 2023-06-20T11:19:12+02:00
      DISABLED: 0
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 147135243_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147135177_2119873798
    Fields: 
      NAME: "Конфискат. Сведения об остатках имущества прошлых лет"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2023-06-20T13:49:46+02:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="45097,5216518287" ReportOptions.Description.Text="" ReportOptions.LastChange="45097,5216518287" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C1C00000020446174615365743D22512220446174615365744E616D653D22512200010C2800000020446174615365743D2251504552494F442220446174615365744E616D653D2251504552494F442200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="34,01577" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="3,77953" Top="3,77953" Width="710,55164" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РЎРІРµРґРµРЅРёСЏ РѕР± РѕСЃС‚Р°С‚РєР°С… РёРјСѓС‰РµСЃС‚РІР° РїСЂРѕС€Р»С‹С… Р»РµС‚"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="68,03154" Left="0" Top="113,763853" Width="718,1107">
              <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="151,1812" Height="68,03154" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р“РѕРґ РїРѕР»СѓС‡РµРЅРёСЏ РёРјСѓС‰РµСЃС‚РІР° РґР»СЏ СЂРµР°Р»РёР·Р°С†РёРё"/>
              <TfrxMemoView Name="Memo3" Left="188,9765" Top="0" Width="283,46475" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє РЅРµСЂРµР°Р»РёР·РѕРІР°РЅРЅРѕРіРѕ РёРјСѓС‰РµСЃС‚РІР° РЅР° [TITLE.&#34;onDate&#34;]"/>
              <TfrxMemoView Name="Memo4" Left="188,9765" Top="34,01577" Width="283,46475" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р°РєС‚С‹ РїРµСЂРµРґР°С‡Рё РёРјСѓС‰РµСЃС‚РІР°"/>
              <TfrxMemoView Name="Memo5" Left="188,9765" Top="49,13389" Width="132,28355" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРѕР»РёС‡РµСЃС‚РІРѕ"/>
              <TfrxMemoView Name="Memo6" Left="321,26005" Top="49,13389" Width="151,1812" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЅР° СЃСѓРјРјСѓ, СЂСѓР±."/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="204,850526" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Q" DataSetName="Q" RowCount="0">
              <TfrxMemoView Name="Memo7" Left="188,9765" Top="0" Width="132,28355" Height="18,89765" ShowHint="False" DataField="DOCCOUNT" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;DOCCOUNT&#34;]"/>
              <TfrxMemoView Name="Memo8" Left="321,26005" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataField="SUMRET" DataSet="Q" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;SUMRET&#34;]"/>
              <TfrxMemoView Name="Memo9" Left="37,7953" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataField="Y" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;Y&#34;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer1" Height="18,89765" Left="0" Top="246,803309" Width="718,1107">
              <TfrxMemoView Name="Memo10" Left="188,9765" Top="0" Width="132,28355" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;DOCCOUNT&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo11" Left="321,26005" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Q.&#34;SUMRET&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo12" Left="37,7953" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РРўРћР“Рћ:"/>
            </TfrxFooter>
            <TfrxHeader Name="Header2" Height="120,94496" Left="0" Top="288,756092" Width="718,1107">
              <TfrxMemoView Name="Memo13" Left="37,7953" Top="52,91342" Width="151,1812" Height="68,03154" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРµСЂРёРѕРґ"/>
              <TfrxMemoView Name="Memo14" Left="188,9765" Top="52,91342" Width="283,46475" Height="34,01577" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє РЅРµСЂРµР°Р»РёР·РѕРІР°РЅРЅРѕРіРѕ РёРјСѓС‰РµСЃС‚РІР° РЅР° РЅР°С‡Р°Р»Рѕ РїРµСЂРёРѕРґР°"/>
              <TfrxMemoView Name="Memo15" Left="188,9765" Top="86,92919" Width="283,46475" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р°РєС‚С‹ РїРµСЂРµРґР°С‡Рё РёРјСѓС‰РµСЃС‚РІР°"/>
              <TfrxMemoView Name="Memo16" Left="188,9765" Top="102,04731" Width="132,28355" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРѕР»РёС‡РµСЃС‚РІРѕ"/>
              <TfrxMemoView Name="Memo17" Left="321,26005" Top="102,04731" Width="151,1812" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЅР° СЃСѓРјРјСѓ, СЂСѓР±."/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData2" Height="18,89765" Left="0" Top="432,756185" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="QPERIOD" DataSetName="QPERIOD" RowCount="0">
              <TfrxMemoView Name="Memo18" Left="188,9765" Top="0" Width="132,28355" Height="18,89765" ShowHint="False" DataSet="QPERIOD" DataSetName="QPERIOD" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QPERIOD.&#34;DOCCOUNT&#34;]"/>
              <TfrxMemoView Name="Memo19" Left="321,26005" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataField="SUMRET" DataSet="QPERIOD" DataSetName="QPERIOD" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[QPERIOD.&#34;SUMRET&#34;]"/>
              <TfrxMemoView Name="Memo20" Left="37,7953" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataField="P" DataSet="QPERIOD" DataSetName="QPERIOD" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QPERIOD.&#34;P&#34;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer2" Height="18,89765" Left="0" Top="474,708968" Width="718,1107">
              <TfrxMemoView Name="Memo21" Left="188,9765" Top="0" Width="132,28355" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QPERIOD.&#34;DOCCOUNT&#34;&#62;,MasterData2)]"/>
              <TfrxMemoView Name="Memo22" Left="321,26005" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QPERIOD.&#34;SUMRET&#34;&#62;,MasterData2)]"/>
              <TfrxMemoView Name="Memo23" Left="37,7953" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataSet="Q" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РРўРћР“Рћ:"/>
            </TfrxFooter>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147135178_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147135177_2119873798
    Fields: 
      NAME: "rp_Main147135178_2119873798"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-06-20T13:49:46+02:00
      DISPLAYSCRIPT: | 
        RP_MAIN147135178_2119873798
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAT05EQVRFDwAAAM7x8uDy6ugg7eAg5ODy8wAAAAAAAAAAAAAAAAIAAAAAAAAA
        AAIAAABeUkZOU1RGTFBS
      SCRIPT: | 
        Option Explicit
        Function rp_Main147135178_2119873798(onDate)
          BaseQueryList.Clear
          
          dim Creator, ibsql, ibGroup
          set Creator = new TCreator
          set ibsql = Creator.GetObject(nil, "TIBSQL", "")
          ibsql.Transaction = gdcBaseManager.ReadTransaction
          ibsql.SQL.Text = _
          " SELECT LB, RB FROM GD_CONTACT WHERE ID = " & IBLogin.ComPanyKey
          ibsql.ExecQuery
          
          set ibGroup = Creator.GetObject(nil, "TIBSQL", "")
          ibGroup.Transaction = gdcBaseManager.ReadTransaction
          ibGroup.SQL.Text = _
          " SELECT LB, RB FROM GD_GOODGROUP WHERE ID = " & gdcBaseManager.GetIDByRUIDString("147047409_2082756242")
          ibGroup.ExecQuery
          
          
          Dim q
          Set q = BaseQueryList.Query(BaseQueryList.Add("q", 0))
          q.SQL = "SELECT " & vbCrLf & _
            " T.Y, " & vbCrLf & _
            " SUM(T.REMAINS) AS ALLREMAINS, " & vbCrLf & _
            " SUM(T.DOC) AS DOCCOUNT, " & vbCrLf & _
            " SUM(T.SUM_RETAILNCU) AS SUMRET, " & vbCrLf & _
            " SUM(T.SUM_PROVIDER) AS SUMPROV " & vbCrLf & _
            "FROM " & vbCrLf & _
            "(SELECT " & vbCrLf & _
            "  SUM ( M.BALANCE ) AS REMAINS, " & vbCrLf & _
            "  ACT.USR$DOCNUMBER, " & vbCrLf & _
            "  IIF(NOT ACT.USR$DOCNUMBER IS NULL,1,0) as DOC, " & vbCrLf & _
            "  EXTRACT(YEAR FROM C.USR$INV_DATERECEIVE) as Y, " & vbCrLf & _
            "  SUM ( M.BALANCE * CAST ( C.USR$INV_COSTRETAILNCU AS DOUBLE PRECISION ) ) AS SUM_RETAILNCU, " & vbCrLf & _
            "  SUM ( M.BALANCE * CAST ( C.USR$INV_COSTPROVIDER AS DOUBLE PRECISION ) ) AS SUM_PROVIDER " & vbCrLf & _
            " " & vbCrLf & _
            "FROM " & vbCrLf & _
            "  ( SELECT " & vbCrLf & _
            "    M.CARDKEY, " & vbCrLf & _
            "    M.CONTACTKEY, " & vbCrLf & _
            "    M.BALANCE " & vbCrLf & _
            "  FROM " & vbCrLf & _
            "    INV_BALANCE M " & vbCrLf & _
            "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND         CON.LB  >=  :SubLB AND         CON.RB  <=  :SubRB " & vbCrLf & _
            "    JOIN GD_GOOD G ON ( G.ID  =  M.GOODKEY ) " & vbCrLf & _
            "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
            "  WHERE " & vbCrLf & _
            "    M.BALANCE  <>  0 " & vbCrLf & _
            "    AND ( GG.LB  >=  :LB AND     GG.RB  <=  :RB ) " & vbCrLf & _
            "UNION ALL " & vbCrLf & _
            "SELECT " & vbCrLf & _
            "    M.CARDKEY, " & vbCrLf & _
            "    M.CONTACTKEY, " & vbCrLf & _
            "    SUM ( M.CREDIT - M.DEBIT ) AS BALANCE " & vbCrLf & _
            "  FROM " & vbCrLf & _
            "    INV_MOVEMENT M " & vbCrLf & _
            "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND         CON.LB  >=  :SubLB AND         CON.RB  <=  :SubRB " & vbCrLf & _
            "    JOIN GD_GOOD G ON ( G.ID  =  M.GOODKEY ) " & vbCrLf & _
            "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
            "  WHERE " & vbCrLf & _
            "    M.DISABLED  =  0 " & vbCrLf & _
            "    AND M.MOVEMENTDATE  >  :REMAINSDATE " & vbCrLf & _
            "    AND ( GG.LB  >=  :LB AND     GG.RB  <=  :RB ) " & vbCrLf & _
            "GROUP BY " & vbCrLf & _
            "  1, 2 ) M " & vbCrLf & _
            "    LEFT JOIN INV_CARD C ON C.ID  =  M.CARDKEY " & vbCrLf & _
            "    LEFT JOIN GD_GOOD G ON ( G.ID  =  C.GOODKEY ) " & vbCrLf & _
            "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND       CON.LB  >=  :SubLB AND       CON.RB  <=  :SubRB " & vbCrLf & _
            "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
            "    LEFT JOIN USR$CN_ACTVALUATION ACT ON C.USR$CN_ACTVALUATION  =  ACT.ID " & vbCrLf & _
            " " & vbCrLf & _
            " " & vbCrLf & _
            "WHERE " & vbCrLf & _
            "  M.BALANCE  <>  0 " & vbCrLf & _
            "  AND ( GG.LB  >=  :LB AND   GG.RB  <=  :RB ) " & vbCrLf & _
            "  /*AND ((G.ALIAS <> ACT.USR$DOCNUMBER))*/ " & vbCrLf & _
            " " & vbCrLf & _
            "GROUP BY " & vbCrLf & _
            "  C.USR$CN_ACTVALUATION, " & vbCrLf & _
            "  ACT.USR$DOCNUMBER, " & vbCrLf & _
            "  C.USR$INV_DATERECEIVE " & vbCrLf & _
            "HAVING " & vbCrLf & _
            "  SUM ( M.BALANCE )  >  0) T " & vbCrLf & _
            "GROUP BY T.Y " & vbCrLf & _
            "ORDER BY T.Y "
          q.ParamByName("REMAINSDATE").asDateTime = onDate
          q.ParamByName("SubLB").asInteger = ibSQL.FieldByName("LB").asInteger
          q.ParamByName("SubRB").asInteger = ibSQL.FieldByName("RB").asInteger
          q.ParamByName("LB").asInteger = ibGroup.FieldByName("LB").asInteger
          q.ParamByName("RB").asInteger = ibGroup.FieldByName("RB").asInteger
          q.Open
          
          dim q2
          set q2 = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          CALL Q2.AddField("onDate", "ftDate", 0, 0)
          Q2.Open
          Q2.Edit
          Q2.FieldByName("onDate").AsVariant = onDate
          Q2.Post
          
          
          Dim qpR
          Set qpR = BaseQueryList.Query(BaseQueryList.Add("qPeriod", 0))
          qpR.SQL = _
          "SELECT " & vbCrLf & _
          " IIF(T.M BETWEEN 1 AND 6, 1, 2) AS KV, " & vbCrLf & _
          " T.Y, " & vbCrLf & _
          " IIF(T.M BETWEEN 1 AND 6, '01'||'.'||'01'||'.'|| cast(T.Y AS VARCHAR(4)) || '-' || '30'||'.'||'06'||'.'|| cast(T.Y AS VARCHAR(4)), '01'||'.'||'07'||'.'|| cast(T.Y AS VARCHAR(4)) || '-' || '31'||'.'||'12'||'.'|| cast(T.Y AS VARCHAR(4))) AS P, " & vbCrLf & _
          " SUM(T.REMAINS) AS ALLREMAINS, " & vbCrLf & _
          " SUM(T.DOC) AS DOCCOUNT, " & vbCrLf & _
          " SUM(T.SUM_RETAILNCU) AS SUMRET, " & vbCrLf & _
          " SUM(T.SUM_PROVIDER) AS SUMPROV " & vbCrLf & _
          "FROM " & vbCrLf & _
          "(SELECT " & vbCrLf & _
          "  SUM ( M.BALANCE ) AS REMAINS, " & vbCrLf & _
          "  ACT.USR$DOCNUMBER, " & vbCrLf & _
          "  IIF(NOT ACT.USR$DOCNUMBER IS NULL,1,0) as DOC, " & vbCrLf & _
          "  EXTRACT(MONTH FROM C.USR$INV_DATERECEIVE) as M, " & vbCrLf & _
          "  EXTRACT(YEAR FROM C.USR$INV_DATERECEIVE) as Y, " & vbCrLf & _
          "  SUM ( M.BALANCE * CAST ( C.USR$INV_COSTRETAILNCU AS DOUBLE PRECISION ) ) AS SUM_RETAILNCU, " & vbCrLf & _
          "  SUM ( M.BALANCE * CAST ( C.USR$INV_COSTPROVIDER AS DOUBLE PRECISION ) ) AS SUM_PROVIDER " & vbCrLf & _
          " " & vbCrLf & _
          "FROM " & vbCrLf & _
          "  ( SELECT " & vbCrLf & _
          "    M.CARDKEY, " & vbCrLf & _
          "    M.CONTACTKEY, " & vbCrLf & _
          "    M.BALANCE " & vbCrLf & _
          "  FROM " & vbCrLf & _
          "    INV_BALANCE M " & vbCrLf & _
          "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND         CON.LB  >=  :SubLB AND         CON.RB  <=  :SubRB " & vbCrLf & _
          "    JOIN GD_GOOD G ON ( G.ID  =  M.GOODKEY ) " & vbCrLf & _
          "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
          "  WHERE " & vbCrLf & _
          "    M.BALANCE  <>  0 " & vbCrLf & _
          "    AND ( GG.LB  >=  :LB AND     GG.RB  <=  :RB ) " & vbCrLf & _
          "UNION ALL " & vbCrLf & _
          "SELECT " & vbCrLf & _
          "    M.CARDKEY, " & vbCrLf & _
          "    M.CONTACTKEY, " & vbCrLf & _
          "    SUM ( M.CREDIT - M.DEBIT ) AS BALANCE " & vbCrLf & _
          "  FROM " & vbCrLf & _
          "    INV_MOVEMENT M " & vbCrLf & _
          "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND         CON.LB  >=  :SubLB AND         CON.RB  <=  :SubRB " & vbCrLf & _
          "    JOIN GD_GOOD G ON ( G.ID  =  M.GOODKEY ) " & vbCrLf & _
          "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
          "  WHERE " & vbCrLf & _
          "    M.DISABLED  =  0 " & vbCrLf & _
          "    AND M.MOVEMENTDATE  >  :REMAINSDATE " & vbCrLf & _
          "    AND ( GG.LB  >=  :LB AND     GG.RB  <=  :RB ) " & vbCrLf & _
          "GROUP BY " & vbCrLf & _
          "  1, 2 ) M " & vbCrLf & _
          "    LEFT JOIN INV_CARD C ON C.ID  =  M.CARDKEY " & vbCrLf & _
          "    LEFT JOIN GD_GOOD G ON ( G.ID  =  C.GOODKEY ) " & vbCrLf & _
          "    JOIN GD_CONTACT CON ON M.CONTACTKEY  =  CON.ID AND       CON.LB  >=  :SubLB AND       CON.RB  <=  :SubRB " & vbCrLf & _
          "    LEFT JOIN GD_GOODGROUP GG ON ( G.GROUPKEY  =  GG.ID ) " & vbCrLf & _
          "    LEFT JOIN USR$CN_ACTVALUATION ACT ON C.USR$CN_ACTVALUATION  =  ACT.ID " & vbCrLf & _
          " " & vbCrLf & _
          " " & vbCrLf & _
          "WHERE " & vbCrLf & _
          "  M.BALANCE  <>  0 " & vbCrLf & _
          "  AND ( GG.LB  >=  :LB AND   GG.RB  <=  :RB ) " & vbCrLf & _
          "  /*AND ((G.ALIAS <> ACT.USR$DOCNUMBER))*/ " & vbCrLf & _
          " " & vbCrLf & _
          "GROUP BY " & vbCrLf & _
          "  C.USR$CN_ACTVALUATION, " & vbCrLf & _
          "  ACT.USR$DOCNUMBER, " & vbCrLf & _
          "  C.USR$INV_DATERECEIVE " & vbCrLf & _
          "HAVING " & vbCrLf & _
          "  SUM ( M.BALANCE )  >  0) T " & vbCrLf & _
          "GROUP BY T.Y , 1, 3 " & vbCrLf & _
          "ORDER BY T.Y , 1, 3 "
          qpR.ParamByName("REMAINSDATE").asDateTime = onDate
          qpR.ParamByName("SubLB").asInteger = ibSQL.FieldByName("LB").asInteger
          qpR.ParamByName("SubRB").asInteger = ibSQL.FieldByName("RB").asInteger
          qpR.ParamByName("LB").asInteger = ibGroup.FieldByName("LB").asInteger
          qpR.ParamByName("RB").asInteger = ibGroup.FieldByName("RB").asInteger
          qpR.Open
        
          Set rp_Main147135178_2119873798 = BaseQueryList
        End Function
        
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147135176_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147135177_2119873798
    Fields: 
      PARENT: "147053281_2119873798 TgdcExplorer"
      NAME: "Конфискат"
      DESCRIPTION: ~
      USERGROUPNAME: "147135176_2119873798"
      EDITIONDATE: 2023-06-20T11:21:36+02:00
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 147135177_2119873798
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Сведения об остатках имущества прошлых лет"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: "147135175_2119873798 Исследователь\\Торговля\\00.Конфискат\\Отчеты конфискат"
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "147135178_2119873798 rp_Main147135178_2119873798"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147135176_2119873798 TgdcExplorer\\Конфискат"
      SERVERKEY: ~
      TEMPLATEKEY: "147135243_2119873798 Конфискат. Сведения об остатках имущества прошлых лет"
      EDITIONDATE: 2023-06-20T13:49:46+02:00