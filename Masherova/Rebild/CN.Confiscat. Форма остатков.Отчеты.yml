%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 147061274_2091642366
  Name: "CN.Confiscat. Форма остатков.Отчеты"
  Caption: "CN.Confiscat. Форма остатков.Отчеты"
  Version: "1.0.0.12"
  Optional: False
  Internal: True
  MD5: F837AA359A5D9BEBEA6D0378E22938FE
Uses: 
  - "147061263_2091642366 CN.Confiscat. Форма остатков"
Objects: 
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147061058_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147061062_2091642366
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_frmInvViewRemains147061050_2091642366)"
      DESCRIPTION: ~
      USERGROUPNAME: "147061058_2091642366"
      EDITIONDATE: 2023-05-03T15:49:29+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 147061057_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147061062_2091642366
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_frmInvViewRemains147061050_2091642366"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2023-05-03T15:49:29+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147061052_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147061062_2091642366
    Fields: 
      PARENT: ~
      NAME: "gdc_frmInvViewRemains147061050_2091642366"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "147061057_2091642366 Локальные макросы"
      OBJECTNAME: "gdc_frmInvViewRemains147061050_2091642366"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "147061058_2091642366 Отчеты(gdc_frmInvViewRemains147061050_2091642366)"
      SUBTYPE: ""
      EDITIONDATE: 2023-05-03T15:49:29+03:00
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 147061168_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147061062_2091642366
    Fields: 
      NAME: "Остатки конфискат"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2023-07-17T17:10:13+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="45049,6634700579" ReportOptions.Description.Text="" ReportOptions.LastChange="45049,6634700579" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C3200000020446174615365743D22474443474F4F4447524F55502220446174615365744E616D653D22474443474F4F4447524F55502200010C3400000020446174615365743D22474443494E5652454D41494E532220446174615365744E616D653D22474443494E5652454D41494E53220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="42,330736" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="3,023624" Top="9,070872" Width="715,842982" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РєРё РЅР° РґР°С‚Сѓ "/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="31,370099" Left="0" Top="120,94496" Width="718,1107" Stretched="True">
              <TfrxMemoView Name="Memo6" Left="370,39394" Top="0" Width="52,91342" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє"/>
              <TfrxMemoView Name="Memo2" Left="3,77953" Top="0" Width="332,59864" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ"/>
              <TfrxMemoView Name="Memo4" Left="336,37817" Top="0" Width="34,01577" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р•Рґ. РёР·Рј."/>
              <TfrxMemoView Name="Memo8" Left="423,30736" Top="0" Width="64,25201" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ Р°РєС‚Р°"/>
              <TfrxMemoView Name="Memo10" Left="487,55937" Top="0" Width="52,91342" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР° РїРѕСЃС‚."/>
              <TfrxMemoView Name="Memo12" Left="540,47279" Top="0" Width="52,91342" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР° РІ (С†. РїРѕСЃС‚)"/>
              <TfrxMemoView Name="Memo14" Left="593,38621" Top="0" Width="52,91342" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР° СЂРѕР·РЅ."/>
              <TfrxMemoView Name="Memo15" Left="646,29963" Top="0" Width="52,91342" Height="30,23624" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР° РІ (СЂРѕР·РЅ.)"/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Height="17,007885" Left="0" Top="173,85838" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="GDCINVREMAINS" DataSetName="GDCINVREMAINS" RowCount="0" Stretched="True">
              <TfrxMemoView Name="Memo3" Left="3,77953" Top="0" Width="332,59864" Height="15,11812" ShowHint="False" DataField="NAMEGOOD" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;NAMEGOOD&#34;]"/>
              <TfrxMemoView Name="Memo5" Left="336,37817" Top="0" Width="34,01577" Height="15,11812" ShowHint="False" DataField="VALUENAME" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;VALUENAME&#34;]"/>
              <TfrxMemoView Name="Memo7" Left="370,39394" Top="0" Width="52,91342" Height="15,11812" ShowHint="False" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;REMAINS&#34;]"/>
              <TfrxMemoView Name="Memo9" Left="423,32313" Top="0" Width="64,25201" Height="15,11812" ShowHint="False" DataField="C_USR$CN_ACTVALUATION2752427231" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;C_USR$CN_ACTVALUATION2752427231&#34;]"/>
              <TfrxMemoView Name="Memo11" Left="487,55937" Top="0" Width="52,91342" Height="15,11812" ShowHint="False" DataField="USR$INV_COSTPROVIDER" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;USR$INV_COSTPROVIDER&#34;]"/>
              <TfrxMemoView Name="Memo13" Left="540,47279" Top="0" Width="52,91342" Height="15,11812" ShowHint="False" DataField="S_USR$INV_COSTPROVIDER" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;S_USR$INV_COSTPROVIDER&#34;]"/>
              <TfrxMemoView Name="Memo16" Left="593,38621" Top="0" Width="52,91342" Height="15,11812" ShowHint="False" DataField="USR$INV_COSTRETAILNCU" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;USR$INV_COSTRETAILNCU&#34;]"/>
              <TfrxMemoView Name="Memo17" Left="646,29963" Top="0" Width="52,91342" Height="15,11812" ShowHint="False" DataField="S_USR$INV_COSTRETAILNCU" DataSetName="GDCINVREMAINS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GDCINVREMAINS.&#34;S_USR$INV_COSTRETAILNCU&#34;]"/>
            </TfrxMasterData>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147061063_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147061062_2091642366
    Fields: 
      NAME: "rp_Main147061063_2091642366"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147061052_2091642366 gdc_frmInvViewRemains147061050_2091642366"
      OBJECTNAME: "gdc_frmInvViewRemains147061050_2091642366"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2023-07-17T17:10:15+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147061063_2091642366
        RP_MAIN147061063_2091642366_FINDFIELD
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QJAAAAT1dORVJGT1JNCQAAAE9XTkVSRk9STQAAAAAAAAAAAAAAAAsAAAAAAAAAAAAA
        AABGTlNUUFJTVAMAAABJU0YaAAAAw/Dz7+/o8O7i4PL8IO/uIODq8iDu9uXt6ugAAAAAAAAAAAAA
        AAAGAAAAAAAAAAAAAAAARk5TVEZMUFI=
      SCRIPT: | 
        Function rp_Main147061063_2091642366(OwnerForm, isF)
          BaseQueryList.Clear
          set rp_Main147061063_2091642366 = OwnerForm.WindowQuery
          set qry = rp_Main147061063_2091642366.QueryByName("GDCINVREMAINS")
          if not(rp_Main147061063_2091642366_FindField(qry, "NAME") and _
            rp_Main147061063_2091642366_FindField(qry, "C_USR$CN_ACTVALUATION2752427231") and _
            rp_Main147061063_2091642366_FindField(qry, "NAMEGOOD") and _
            rp_Main147061063_2091642366_FindField(qry, "VALUENAME") and _
            rp_Main147061063_2091642366_FindField(qry, "REMAINS") and _
            rp_Main147061063_2091642366_FindField(qry, "USR$INV_COSTRETAILNCU")) _
          then
            Exception.Raise "Exception", "Для построения отчета необходимо выбрать след признаки: " + vbCrLf + _
              " подразделение, счет, наименование товара, единица измерения, " + vbCrLf + _
              " остаток, розничная цена! "  + vbCrLf
          end if
        
          qry.IndexFields = "NAME;C_USR$CN_ACTVALUATION2752427231;NAMEGOOD"
        
        
          
        end function
        
        function rp_Main147061063_2091642366_FindField(qry, FieldName)
          rp_Main147061063_2091642366_FindField = False
          for I = 0 to qry.FieldCount - 1
            if StrComp(qry.Fields(I).FieldName, FieldName, 1) = 0 then
              rp_Main147061063_2091642366_FindField = True
              Exit Function
            end if
          next
          
          dim TagSet
          set TagSet = BaseQueryList.Query(BaseQueryList.Add("Tag", 1))
          call TagSet.AddField("grByAct", "ftBoolean", 0, False)
          TagSet.Open
          TagSet.Insert
          TagSet.FieldByName("grByAct").AsVariant = True
          TagSet.Post
          
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 147061062_2091642366
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Остатки"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "147061063_2091642366 rp_Main147061063_2091642366"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147061058_2091642366 Отчеты(gdc_frmInvViewRemains147061050_2091642366)"
      SERVERKEY: ~
      TEMPLATEKEY: "147061168_2091642366 Остатки конфискат"
      EDITIONDATE: 2023-07-17T17:10:15+03:00