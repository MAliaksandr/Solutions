%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 148688196_821911878
  Name: "09.Контрольная лента.Отчет.Касса"
  Caption: "09.Контрольная лента.Отчет.Касса"
  Version: "1.0.0.6"
  Optional: False
  Internal: True
  MD5: 29DBE93CE19A5945E6BF00CBB3B5DD24
Uses: 
  - "147019071_301427377 GS.PositiveCheck. Отчёты"
Objects: 
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 148688081_821911878
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 148687785_821911878
    Fields: 
      NAME: "09. Контрольная лента"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2022-04-08T16:46:43+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44659,5047532176" ReportOptions.Description.Text="" ReportOptions.LastChange="44659,5047532176" ScriptLanguage="PascalScript" ScriptText.Text="var s, grSumRet, qGrRet, sret: Real;&#13;&#10;qret:integer;                                  &#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  s:=s+&#60;QLINE.&#34;SUMNCU&#34;&#62;;&#13;&#10;  &#13;&#10;   if &#60;QLINE.&#34;SUMNCU&#34;&#62;&#60;0 then&#13;&#10;     begin&#13;&#10;     qret :=qret+1;                        &#13;&#10;     sret := sret + &#60;QLINE.&#34;SUMNCU&#34;&#62;;&#13;&#10;&#13;&#10;     qGrRet :=qGrRet+1;                        &#13;&#10;     grSumRet := grSumRet + &#60;QLINE.&#34;SUMNCU&#34;&#62;         &#13;&#10;     end             &#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   qGrRet :=0;&#13;&#10;   grSumRet := 0&#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  GroupFooter1.Visible := True;    &#13;&#10;  if (&#60;TITLE.&#34;DAYBEGIN&#34;&#62;=&#60;TITLE.&#34;DAYEND&#34;&#62;) then&#13;&#10;   GroupFooter1.Visible := False;                                                          &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C1C00000020446174615365743D22512220446174615365744E616D653D22512200010C2400000020446174615365743D22514C494E452220446174615365744E616D653D22514C494E452200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="2" ColumnWidth="95" ColumnPositions.Text="0&#13;&#10;95" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="26,45671" Left="0" Top="18,89765" Width="718,1107">
              <TfrxMemoView Name="Memo1" Left="1" Top="0" Width="714,33117" Height="26,45671" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[COMPANYNAME]&#13;&#10;РљРЎРђ в„–[Q.&#34;USR$SERIALNUMBER&#34;]   Р Р•Р“.в„– [Q.&#34;USR$REGISTERNUMBER&#34;]"/>
            </TfrxReportTitle>
            <TfrxMasterData Name="MasterData1" Height="23,89765" Left="0" Top="192,75603" Width="359,05535" ColumnWidth="0" ColumnGap="0" DataSet="Q" DataSetName="Q" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
              <TfrxMemoView Name="Memo2" Left="18,89765" Top="0" Width="340,1577" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="3" Frame.Typ="4" ParentFont="False" Text="[Q.&#34;FR_ACTION&#34;]"/>
              <TfrxMemoView Name="Memo3" Left="264,5671" Top="12,33859" Width="94,48825" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" Text="[Q.&#34;EDITIONDATE&#34;] [Q.&#34;EDITIONTIME&#34;]"/>
              <TfrxMemoView Name="Memo4" Left="0,77953" Top="12,55906" Width="359,05535" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РљР°СЃСЃРёСЂ:[ &#60;Q.&#34;CONTNAME&#34;&#62;]"/>
              <TfrxMemoView Name="Memo11" Left="0,4094" Top="0" Width="18,89765" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line#]"/>
            </TfrxMasterData>
            <TfrxDetailData Name="DetailData1" Height="11,33859" Left="0" Top="283,46475" Width="359,05535" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="QLINE" DataSetName="QLINE" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
              <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="188,9765" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[QLINE.&#34;GOODNAME&#34;]"/>
              <TfrxMemoView Name="Memo13" Left="241,68522" Top="0" Width="37,7953" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" DataField="QUANTITY" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QLINE.&#34;QUANTITY&#34;]"/>
              <TfrxMemoView Name="Memo14" Left="188,7718" Top="0" Width="52,91342" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" DataField="KIND_NAME" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QLINE.&#34;KIND_NAME&#34;]"/>
              <TfrxMemoView Name="Memo15" Left="278,65368" Top="0" Width="41,57483" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" DataField="DISCOUNTNCU" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QLINE.&#34;DISCOUNTNCU&#34;]"/>
              <TfrxMemoView Name="Memo16" Left="320,26005" Top="0" Width="37,7953" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" DataField="SUMNCU" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[QLINE.&#34;SUMNCU&#34;]"/>
            </TfrxDetailData>
            <TfrxHeader Name="Header1" Height="3,77953" Left="0" Top="166,29932" Width="359,05535"/>
            <TfrxHeader Name="Header2" Height="23,67718" Left="0" Top="238,11039" Width="359,05535">
              <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="359,05535" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[QLINE.&#34;CLIENT&#34;]"/>
              <TfrxMemoView Name="Memo7" Left="241,68522" Top="11,55906" Width="37,7953" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРѕР»-РІРѕ"/>
              <TfrxMemoView Name="Memo8" Left="188,7718" Top="11,55906" Width="52,91342" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРёРї"/>
              <TfrxMemoView Name="Memo9" Left="278,65368" Top="11,55906" Width="41,57483" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="СЃРєРёРґРєР°"/>
              <TfrxMemoView Name="Memo10" Left="320,26005" Top="11,55906" Width="37,7953" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РёС‚РѕРіРѕ"/>
              <TfrxMemoView Name="Memo19" Left="0" Top="12,33859" Width="188,9765" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[QLINE.&#34;TYPENAME&#34;] # [QLINE.&#34;ORDERNUMBER&#34;]"/>
            </TfrxHeader>
            <TfrxFooter Name="Footer2" Height="11,33859" Left="0" Top="317,48052" Width="359,05535">
              <TfrxMemoView Name="Memo12" Left="0" Top="0" Width="226,7718" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="РС‚РѕРіРѕ РїРѕ С‡РµРєСѓ в„– [QLINE.&#34;ORDERNUMBER&#34;]"/>
              <TfrxMemoView Name="Memo17" Left="241,88992" Top="0" Width="37,7953" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Color="15790320" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QLINE.&#34;QUANTITY&#34;&#62;,DetailData1)]"/>
              <TfrxMemoView Name="Memo18" Left="279,68522" Top="0" Width="41,57483" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Color="15790320" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QLINE.&#34;DISCOUNTNCU&#34;&#62;,DetailData1)]"/>
              <TfrxMemoView Name="Memo20" Left="321,26005" Top="0" Width="37,7953" Height="11,33859" ShowHint="False" StretchMode="smMaxHeight" Color="15790320" DataSet="QLINE" DataSetName="QLINE" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QLINE.&#34;SUMNCU&#34;&#62;,DetailData1)]"/>
            </TfrxFooter>
            <TfrxPageHeader Name="PageHeader1" Height="15,11812" Left="0" Top="68,03154" Width="718,1107">
              <TfrxMemoView Name="Memo21" Left="623,62245" Top="0" Width="94,48825" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="12632256" Font.Height="-8" Font.Name="Arial" Font.Style="2" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [Page#]"/>
              <TfrxMemoView Name="Memo22" Left="0" Top="0" Width="718,1107" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="РљРѕРЅС‚СЂРѕР»СЊРЅР°СЏ Р»РµРЅС‚Р° Р·Р° РїРµСЂРёРѕРґ СЃ [TITLE.&#34;DAYBEGIN&#34;] РїРѕ [TITLE.&#34;DAYEND&#34;]  РїРѕ [TITLE.&#34;Department&#34;]"/>
            </TfrxPageHeader>
            <TfrxGroupHeader Name="GroupHeader1" Height="0" Left="0" Top="143,62214" Width="359,05535" OnBeforePrint="GroupHeader1OnBeforePrint" AllowSplit="True" Condition="Q.&#34;EDITIONDATE&#34;"/>
            <TfrxGroupFooter Name="GroupFooter1" Height="49,13389" Left="0" Top="351,49629" Width="359,05535" OnBeforePrint="GroupFooter1OnBeforePrint">
              <TfrxMemoView Name="Memo30" Left="309,14193" Top="0" Width="26,45671" Height="11,33859" ShowHint="False" AutoWidth="True" Color="15790320" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;QLINE.&#34;SUMNCU&#34;&#62;,DetailData1)]"/>
              <TfrxMemoView Name="Memo31" Left="82,37013" Top="0" Width="222,99227" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕРІР°СЏ СЃСѓРјРјР° Р·Р° РґРµРЅСЊ [Q.&#34;EDITIONDATE&#34;]:"/>
              <TfrxMemoView Name="Memo32" Left="324,26005" Top="35,69295" Width="34,01577" Height="15,11812" ShowHint="False" AutoWidth="True" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[grSumRet]"/>
              <TfrxMemoView Name="Memo33" Left="191,9765" Top="13,89765" Width="117,16543" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’ С‚РѕРј С‡РёСЃР»Рµ РІРѕР·РІСЂР°С‚РѕРІ:"/>
              <TfrxMemoView Name="Memo34" Left="244,88992" Top="24,7953" Width="83,14966" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РєРѕР»РёС‡РµСЃС‚РІРѕ С‡РµРєРѕРІ -"/>
              <TfrxMemoView Name="Memo35" Left="244,88992" Top="35,69295" Width="79,37013" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="СЃСѓРјРјР° РІРѕР·РІСЂР°С‚Р° -"/>
              <TfrxMemoView Name="Memo36" Left="328,03958" Top="24,7953" Width="30,23624" Height="11,33859" ShowHint="False" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[qGrRet]"/>
            </TfrxGroupFooter>
            <TfrxReportSummary Name="ReportSummary1" Height="79,37013" Left="0" Top="461,10266" Width="718,1107">
              <TfrxMemoView Name="Memo23" Left="272,12616" Top="8" Width="18,89765" Height="11,33859" ShowHint="False" AutoWidth="True" Color="15790320" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[s]"/>
              <TfrxMemoView Name="Memo24" Left="188,9765" Top="8" Width="83,14966" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕРІР°СЏ СЃСѓРјРјР°:"/>
              <TfrxMemoView Name="Memo25" Left="321,26005" Top="43,69295" Width="34,01577" Height="15,11812" ShowHint="False" AutoWidth="True" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[sret]"/>
              <TfrxMemoView Name="Memo26" Left="188,9765" Top="21,89765" Width="117,16543" Height="11,33859" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’ С‚РѕРј С‡РёСЃР»Рµ РІРѕР·РІСЂР°С‚РѕРІ:"/>
              <TfrxMemoView Name="Memo27" Left="241,88992" Top="32,7953" Width="83,14966" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РєРѕР»РёС‡РµСЃС‚РІРѕ С‡РµРєРѕРІ -"/>
              <TfrxMemoView Name="Memo28" Left="241,88992" Top="43,69295" Width="79,37013" Height="15,11812" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="СЃСѓРјРјР° РІРѕР·РІСЂР°С‚Р° -"/>
              <TfrxMemoView Name="Memo29" Left="325,03958" Top="32,7953" Width="30,23624" Height="11,33859" ShowHint="False" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="8388608" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" ParentFont="False" VAlign="vaCenter" Text="[qret]"/>
            </TfrxReportSummary>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 148687786_821911878
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 148687785_821911878
    Fields: 
      NAME: "rp_Main148687786_821911878"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2022-04-08T16:46:44+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN148687786_821911878
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAUEVSSU9EBgAAAM/l8Oju5AAAAAAAAAAAAAAAAAwAAAAAAAAAAAIAAABeUkZO
        U1RGTFBS
      SCRIPT: | 
        Option Explicit
        Function rp_Main148687786_821911878(period)
          BaseQueryList.Clear
        
          Dim q
          Set q = BaseQueryList.Query(BaseQueryList.Add("q", 0))
          q.SQL = "SELECT " & _
            " (case fl.USR$ACTIONLISTKEY " & _
            "   when :frOpen then 1 " & _
            "   when :frCloseCh then iif(l.USR$ORDERKEY is null, 8, 2) " & _
            "   when :frCloseDay then 9 " & _
            "  end) as FRtype, " & _
            " CAST(l.EDITIONDATE as DATE) as EDITIONDATE, " & _
            " CAST(l.EDITIONDATE as TIME) as EDITIONTIME, " & _
            " l.USR$ORDERKEY, " & _
            " fl.USR$ACTIONLISTKEY, " & _
            " fl.USR$DESCRIPTION, " & _
            "  iif(fl.USR$ACTIONLISTKEY = :frOpen,AL.USR$NAME,IIF(fl.USR$ACTIONLISTKEY = :frCloseDay,'Закрытие фискальной смены','')) AS  fr_action, " & _
            " fl.EDITORKEY, " & _
            " CON.NAME as CONTNAME, " & _
            " FRS.USR$CASHNUMBER, " & _
            " FRS.USR$REGISTERNUMBER, " & _
            " FRS.USR$SERIALNUMBER, " & _
            " IIF(fl.USR$ACTIONLISTKEY=:frCloseDay, FRS.USR$SUM, 0) as FISCALSUM " & _
            "  " & _
            "FROM USR$MN_FR_ACTIONLOG fl " & _
            "JOIN USR$MN_ACTIONLOG l on l.ID = fl.USR$ACTIONLOGKEY " & _
            "LEFT JOIN USR$MN_FR_ACTIONLIST AL ON AL.ID  =  fl.USR$ACTIONLISTKEY " & _
            "LEFT JOIN USR$MN_FR_SHIFTS FRS on FRS.USR$DATE = CAST(fl.EDITIONDATE as DATE)  " & _
            "LEFT JOIN GD_CONTACT CON ON CON.ID = fl.EDITORKEY " & _
            "where " & _
            "al.ID in (:frOpen ,:frCloseDay, :frCloseCh) " & _
            "and CAST(l.EDITIONDATE as DATE) between :db and :de " & _
            "order by 2, 1 "
          q.ParamByName("frOpen").asInteger = gdcBaseManager.GetIDBYRUIDString("149456219_248252873")
          q.ParamByName("frCloseCh").asInteger = gdcBaseManager.GetIDBYRUIDString("149456765_248252873")
          q.ParamByName("frCloseDay").asInteger = gdcBaseManager.GetIDBYRUIDString("149456724_248252873")
          q.ParamByName("db").asDateTime = period(0)
          q.ParamByName("de").asDateTime = period(1)
          q.Open
          
          Dim ql
          Set ql = BaseQueryList.Query(BaseQueryList.Add("qline", 0))
          ql.SQL = _
          "select " & _
          "  IIF(COALESCE(o.USR$RETURN, 0) <> 1, 'Чек продажи', 'Чек возврата' ) AS TypeName, " & _
          "  o.DOCUMENTKEY as orderkey, " & _
          "  g.name as goodname, " & _
          "  con.name as conname, CHL.USR$NUMBER as ORDERNUMBER, " & _
          "  o.USR$B_CLIENTID, " & _
          "  o.USR$B_CLIENTNAME as CLIENT, " & _
          "  kt.USR$NAME as kind_name, " & _
          "  SUM(IIF(o.USR$RETURN = 1, -obk.QTYPOS, obk.QTYPOS)) as quantity, " & _
          "  SUM(IIF(o.USR$RETURN = 1, -obk.SUMDISCPOS, obk.SUMDISCPOS)) as discountncu, " & _
          "  SUM(round(IIF(o.USR$RETURN = 1, -obk.SUMPOS, obk.SUMPOS), 2)) SumNcu " & _
          "from " & _
          "  USR$MN_ORDER o " & _
          "  JOIN gd_document d on d.ID = o.DOCUMENTKEY " & _
          "  LEFT JOIN USR$ORDER_BY_KINDTYPE(o.DOCUMENTKEY) obk ON 1 = 1 " & _
          "  LEFT JOIN USR$CHECKLIST CHL ON  o.DOCUMENTKEY  =  CHL.USR$ORDERKEY " & _
          "  LEFT JOIN gd_contact con on con.id = o.USR$DEPOTKEY " & _
          "  JOIN USR$MN_ORDERLINE ol ON ol.DOCUMENTKEY = obk.ORDERLINEKEY " & _
          "  JOIN GD_GOOD g on g.id = ol.USR$GOODKEY " & _
          "  JOIN GD_GOODGROUP gr on gr.id = g.GROUPKEY " & _
          "  LEFT JOIN  usr$mn_kindtype kt on obk.KINDTYPEKEY = kt.id " & _
          " " & _
          "WHERE 1 = 1 " & _
          "  AND o.USR$LOGICDATE between :db and :de " & _
          "  and o.usr$vip = 0 " & _
          "  GROUP BY " & _
          "  1,2,3,4,5,6,7, 8 " & _
          "HAVING SUM(obk.QTYPOS) <> 0 "
          ql.ParamByName("db").asDateTime = period(0)
          ql.ParamByName("de").asDateTime = period(1)
          ql.Open
          
          dim Title
          set Title = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          call Title.AddField("DAYBEGIN", "FtDate", 0, 0)
          call Title.AddField("DAYEND", "FtDate", 0, 0)
          call Title.AddField("Department", "ftString", 60, 0)
          Title.Open
          Title.Append
          Title.FieldByName("DAYBEGIN").AsVariant = period(0)
          Title.FieldByName("DAYEND").AsVariant = period(1)
          Title.FieldByName("Department").asString = ql.FieldByName("conname").asString
          Title.Post
          
          BaseQueryList.AddMasterDetail "q", "USR$ORDERKEY", "qline", "orderkey"
        
          Set rp_Main148687786_821911878 = BaseQueryList
        End Function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 148687785_821911878
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "09. Контрольная лента"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: "147246024_431138819 Исследователь\\Ресторан\\02. Отчёты"
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "148687786_821911878 rp_Main148687786_821911878"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147094279_157767347 Отчеты по общепиту"
      SERVERKEY: ~
      TEMPLATEKEY: "148688081_821911878 09. Контрольная лента"
      EDITIONDATE: 2022-04-08T16:46:44+03:00