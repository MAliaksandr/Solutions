%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 147394461_806803480
  Name: "WESTA.Блокировка номеров"
  Caption: "WESTA.Блокировка номеров"
  Version: "1.0.0.31"
  Optional: False
  Internal: True
  MD5: E3D512CC2A8BA620931406B9B8C6EF09
Uses: 
  - "147753351_73094925 GS.Общие.Метаданные.Домены"
  - "147022838_800897192 GS.Санаторий.П.Документы.Бронирование"
  - "147364159_796152036 GS.Санаторий.Отдел продаж.Исследователь"
  - "147383320_789097196 VESTA.Санаторий.П.Документы.Бронирование.Интерфейс ч2"
Objects: 
  - 
    Properties: 
      Class: "TgdcException"
      RUID: 147394976_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      EXCEPTIONMESSAGE: ""
      EXCEPTIONNAME: "USR$SAN_E_BLOCKROOM"
      LMESSAGE: ~
      SYSTEM_FLAG: 0
      EDITIONDATE: 2017-05-07T16:09:29+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcGenerator"
      RUID: 147394459_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      GENERATORNAME: "USR$SUN_G_RESERVEDROOM"
      RDB$GENERATOR_ID: 24
      RDB$GENERATOR_NAME: "USR$SUN_G_RESERVEDROOM         "
      EDITIONDATE: 2017-05-06T18:17:33+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcPrimeTable"
      RUID: 147394453_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      BRANCHKEY: ~
      DESCRIPTION: "Занятые номера"
      EXTENDEDFIELDS: ~
      LISTFIELD: ~
      LNAME: "Занятые номера"
      LSHORTNAME: "Занятые номера"
      REFERENCEKEY: ~
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      EDITIONDATE: 2017-05-06T18:12:46+03:00
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394475_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "CASCADE"
      DESCRIPTION: "Заявка"
      FIELDNAME: "USR$REQUESTKEY"
      FIELDSOURCE: "USR$GS_DDOCUMENT"
      FIELDSOURCEKEY: "147035010_9802323 Документ, USR$GS_DDOCUMENT"
      FORMAT: ~
      GDCLASSNAME: "TgdcDocument"
      GDSUBTYPE: ~
      LNAME: "Заявка"
      LSHORTNAME: "Заявка"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "NUMBER"
      REFRELATIONNAME: "GD_DOCUMENT"
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:34:31+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394471_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "Занят по дату"
      FIELDNAME: "USR$DATEEND"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Занят по дату"
      LSHORTNAME: "Занят по дату"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:31:48+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394469_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "Занят с даты"
      FIELDNAME: "USR$DATEBEGIN"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Занят с даты"
      LSHORTNAME: "Занят с даты"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:31:10+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394467_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "RESTRICT"
      DESCRIPTION: "Номер"
      FIELDNAME: "USR$ROOMKEY"
      FIELDSOURCE: "USR$HT_D_NUMBERKEY"
      FIELDSOURCEKEY: "147009413_1661751803 HT. Номер гостиницы, USR$HT_D_NUMBERKEY"
      FORMAT: ~
      GDCLASSNAME: "TgdcAttrUserDefined"
      GDSUBTYPE: "USR$HT_NUMBER"
      LNAME: "Номер"
      LSHORTNAME: "Номер"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$NAME"
      REFRELATIONNAME: "USR$HT_NUMBER"
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:30:22+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 147394691_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "154996723_1440956890 GLOBAL\\DFM\\Tgdc_dlgAttrUserDefined"
      NAME: "USR$SAN_RESERVEDROOMS"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T21:01:17+03:00
      BLOB_DATA: | 
        object gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS: Tgdc_dlgAttrUserDefined
          HorzScrollBar.Range = 0
          VertScrollBar.Range = 0
          ActiveControl = nil
          BorderStyle = bsDialog
          ClientHeight = 211
          ClientWidth = 475
          PixelsPerInch = 96
          TextHeight = 13
          object btnAccess: TButton
            Top = 180
          end
          object btnNew: TButton
            Top = 180
          end
          object btnHelp: TButton
            Top = 180
          end
          object btnOK: TButton
            Top = 180
          end
          object btnCancel: TButton
            Top = 180
          end
          object pnlMain: TPanel
            Height = 163
            Anchors = []
            object usrg_PageControl: TPageControl
              Tag = 0
              Left = 0
              Top = 0
              Width = 475
              Height = 163
              Cursor = crDefault
              Hint = ''
              HelpContext = 0
              ActivePage = usrg_tsCommon
              Align = alClient
              Anchors = [akLeft, akTop, akRight, akBottom]
              Constraints.MaxHeight = 0
              Constraints.MaxWidth = 0
              Constraints.MinHeight = 0
              Constraints.MinWidth = 0
              DockSite = False
              DragCursor = crDrag
              DragKind = dkDrag
              DragMode = dmManual
              Enabled = True
              HotTrack = False
              Images = nil
              MultiLine = False
              OwnerDraw = False
              ParentBiDiMode = True
              ParentFont = True
              ParentShowHint = True
              PopupMenu = nil
              RaggedRight = False
              ScrollOpposite = False
              Style = tsTabs
              TabHeight = 0
              TabOrder = 0
              TabPosition = tpTop
              TabStop = True
              TabWidth = 0
              Visible = True
              object usrg_tsCommon: TTabSheet
                Tag = 0
                Cursor = crDefault
                Hint = ''
                HelpContext = 0
                BorderWidth = 0
                Caption = 'Основные'
                DragMode = dmManual
                Enabled = True
                Highlighted = False
                ImageIndex = 0
                Constraints.MaxHeight = 0
                Constraints.MaxWidth = 0
                Constraints.MinHeight = 0
                Constraints.MinWidth = 0
                ParentFont = True
                ParentShowHint = True
                PopupMenu = nil
                TabVisible = True
                object usrat_gsIBLookupComboBox_USR_ROOMKEY_Label: TLabel
                end
                object usrat_xDateDBEdit_USR_DATEBEGIN_Label: TLabel
                end
                object usrat_xDateDBEdit_USR_DATEEND_Label: TLabel
                end
                object usrat_gsIBLookupComboBox_USR_REQUESTKEY_Label: TLabel
                end
                object usrat_gsIBLookupComboBox_USR_RESERVATIONKEY_Label: TLabel
                end
                object usrat_gsIBLookupComboBox_USR_ROOMKEY: TgsIBLookupComboBox
                end
                object usrat_xDateDBEdit_USR_DATEBEGIN: TxDateDBEdit
                end
                object usrat_xDateDBEdit_USR_DATEEND: TxDateDBEdit
                end
                object usrat_gsIBLookupComboBox_USR_REQUESTKEY: TgsIBLookupComboBox
                end
                object usrat_gsIBLookupComboBox_USR_RESERVATIONKEY: TgsIBLookupComboBox
                  TabOrder = 4
                end
              end
              object usrg_tsInvisible: TTabSheet
                Tag = 0
                Cursor = crDefault
                Hint = ''
                HelpContext = 0
                BorderWidth = 0
                Caption = 'Атрибуты'
                DragMode = dmManual
                Enabled = True
                Highlighted = False
                ImageIndex = 0
                Constraints.MaxHeight = 0
                Constraints.MaxWidth = 0
                Constraints.MinHeight = 0
                Constraints.MinWidth = 0
                ParentFont = True
                ParentShowHint = True
                PopupMenu = nil
                TabVisible = False
                object atAttributes: TatContainer
                  Width = 467
                  Height = 135
                  object usrat_DBEdit_Z_USR_RESERVATIONKEY_USR_NUMBER_Label: TLabel
                    Top = 58
                  end
                  object usrat_DBEdit_Z_USR_ROOMKEY_USR_NAME_Label: TLabel
                    Top = 36
                  end
                  object usrat_DBEdit_Z_USR_RESERVATIONKEY_USR_NUMBER: TDBEdit
                    Top = 54
                    TabOrder = 1
                  end
                  object usrat_DBEdit_Z_USR_ROOMKEY_USR_NAME: TDBEdit
                    Top = 32
                    TabOrder = 0
                  end
                end
              end
            end
          end
          object alBase: TActionList
            Left = 46
            Top = 15
            object actNew: TAction
            end
            object actHelp: TAction
            end
            object actSecurity: TAction
            end
            object actOk: TAction
            end
            object actCancel: TAction
            end
            object actNextRecord: TAction
            end
            object actPrevRecord: TAction
            end
            object actApply: TAction
            end
            object actFirstRecord: TAction
            end
            object actLastRecord: TAction
            end
            object actProperty: TAction
            end
            object actCopySettingsFromUser: TAction
            end
            object actAddToSetting: TAction
            end
            object actDocumentType: TAction
            end
            object actDistributeUserSettings: TAction
            end
            object actHistory: TAction
            end
          end
          object dsgdcBase: TDataSource
            Left = 16
            Top = 15
          end
          object pm_dlgG: TPopupMenu
            Left = 152
            Top = 216
            object actSecurity1: TMenuItem
            end
            object actHistory1: TMenuItem
            end
            object N1: TMenuItem
            end
            object sepFirst: TMenuItem
            end
            object actNextRecord1: TMenuItem
            end
            object actPrevRecord1: TMenuItem
            end
            object actFirstRecord1: TMenuItem
            end
            object actLastRecord1: TMenuItem
            end
            object sepSecond: TMenuItem
            end
            object actApply1: TMenuItem
            end
            object sepThird: TMenuItem
            end
            object actProperty1: TMenuItem
            end
            object actCopySettings1: TMenuItem
            end
            object nAddToSetting1: TMenuItem
            end
          end
          object ibtrCommon: TIBTransaction
            Params.Strings = (
              'read_committed'
              'rec_version'
              'nowait')
            Left = 440
            Top = 216
          end
        end
        
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 147394656_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "396903548_1523996594 GLOBAL\\DFM\\Tgdc_frmAttrUserDefined"
      NAME: "USR$SAN_RESERVEDROOMS"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T19:18:52+03:00
      BLOB_DATA: | 
        object gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS: Tgdc_frmAttrUserDefined
          ActiveControl = nil
          PixelsPerInch = 96
          TextHeight = 13
          object sbMain: TStatusBar
            Panels = <
              item
                Text = 'Нет фильтрации'
                Width = 836
              end
              item
                Width = 160
              end>
          end
          object TBDockTop: TTBDock
            object tbMainToolbar: TTBToolbar
              SavedAtRunTime = True
              object tbiNew: TTBItem
              end
              object tbiEdit: TTBItem
              end
              object tbiDelete: TTBItem
              end
              object tbiDuplicate: TTBItem
              end
              object tbiReduction: TTBItem
              end
              object tbsiMainOne: TTBSeparatorItem
              end
              object tbiEditInGrid: TTBItem
              end
              object tbiCopy: TTBItem
              end
              object tbiCut: TTBItem
              end
              object tbiPaste: TTBItem
              end
              object tbsiMainOneAndHalf: TTBSeparatorItem
              end
              object tbiLoadFromFile: TTBItem
              end
              object tbiSaveToFile: TTBItem
              end
              object tbsiMainTwo: TTBSeparatorItem
              end
              object tbiFind: TTBItem
              end
              object tbiFilter: TTBItem
              end
              object tbiPrint: TTBItem
              end
              object tbiOnlySelected: TTBItem
              end
              object tbiLinkObject: TTBItem
              end
              object tbsiMainThreeAndAHalf: TTBSeparatorItem
              end
              object tbiHelp: TTBItem
              end
            end
            object tbMainCustom: TTBToolbar
              SavedAtRunTime = True
            end
            object tbMainMenu: TTBToolbar
              SavedAtRunTime = True
              object tbsiMainMenuObject: TTBSubmenuItem
                object tbi_mm_New: TTBItem
                end
                object tbi_mm_Edit: TTBItem
                end
                object tbi_mm_Delete: TTBItem
                end
                object tbi_mm_Duplicate: TTBItem
                end
                object tbi_mm_Reduction: TTBItem
                end
                object tbi_mm_sep1_1: TTBSeparatorItem
                end
                object tbi_mm_Copy: TTBItem
                end
                object tbi_mm_Cut: TTBItem
                end
                object tbi_mm_Paste: TTBItem
                end
                object tbi_mm_sep2_2_: TTBSeparatorItem
                end
                object tbi_mm_AddToSelected: TTBItem
                end
                object tbi_mm_RemoveFromSelected: TTBItem
                end
                object tbi_mm_sep2_1: TTBSeparatorItem
                end
                object tbi_mm_Load: TTBItem
                end
                object tbi_mm_Save: TTBItem
                end
                object tbi_mm_sep3_1: TTBSeparatorItem
                end
                object tbi_mm_Commit: TTBItem
                end
                object tbi_mm_Rollback: TTBItem
                end
                object tbi_mm_sep4_1: TTBSeparatorItem
                end
                object tbi_mm_Find: TTBItem
                end
                object tbi_mm_Filter: TTBItem
                end
                object tbi_mm_Print: TTBItem
                end
                object tbi_mm_Macro: TTBItem
                end
                object tbi_mm_OnlySelected: TTBItem
                end
                object tbi_mm_LinkObject: TTBItem
                end
                object tbi_mm_sep5_1: TTBSeparatorItem
                end
                object tbi_mm_MainToSetting: TTBItem
                end
                object tbi_mm_sep5_2_: TTBSeparatorItem
                end
                object tbi_mm_CopySettings: TTBItem
                end
                object tbiDistributeSettings: TTBItem
                end
                object tbiDontSaveSettings: TTBItem
                end
              end
              object tbsiMainMenuHelp: TTBSubmenuItem
                object tbiMainMenuHelp: TTBItem
                end
              end
            end
            object tbMainInvariant: TTBToolbar
              SavedAtRunTime = True
              object tbiCommit: TTBItem
              end
              object tbiRollback: TTBItem
              end
              object tbsiMainThree: TTBSeparatorItem
              end
              object tbiMacros: TTBItem
              end
            end
            object tbChooseMain: TTBToolbar
              SavedAtRunTime = True
              object tbiSelectAll: TTBItem
              end
              object tbiUnSelectAll: TTBItem
              end
              object tbiClearSelection: TTBItem
              end
            end
          end
          object TBDockLeft: TTBDock
          end
          object TBDockRight: TTBDock
          end
          object TBDockBottom: TTBDock
          end
          object pnlWorkArea: TPanel
            object spChoose: TSplitter
              Top = 530
              Width = 996
            end
            object pnlMain: TPanel
              object pnlSearchMain: TPanel
                Height = 435
                object sbSearchMain: TScrollBox
                  Height = 408
                end
                object pnlSearchMainButton: TPanel
                  object btnSearchMain: TButton
                  end
                  object btnSearchMainClose: TButton
                  end
                  object chbxFuzzyMatch: TCheckBox
                  end
                end
              end
              object usrg_pnlGrids: TPanel
                Tag = 0
                Left = 0
                Top = 0
                Width = 996
                Height = 534
                Cursor = crDefault
                Hint = ''
                HelpContext = 0
                Align = alClient
                Alignment = taCenter
                Anchors = [akLeft, akTop, akRight, akBottom]
                AutoSize = False
                BevelInner = bvNone
                BevelOuter = bvRaised
                BevelWidth = 1
                BorderWidth = 0
                BorderStyle = bsNone
                Caption = ''
                Color = clBtnFace
                Constraints.MaxHeight = 0
                Constraints.MaxWidth = 0
                Constraints.MinHeight = 0
                Constraints.MinWidth = 0
                UseDockManager = True
                DockSite = False
                DragCursor = crDrag
                DragKind = dkDrag
                DragMode = dmManual
                Enabled = True
                FullRepaint = True
                Locked = False
                ParentBiDiMode = True
                ParentColor = False
                ParentCtl3D = True
                ParentFont = True
                ParentShowHint = True
                PopupMenu = nil
                TabOrder = 1
                TabStop = False
                Visible = True
                object usrg_spltGrids: TSplitter
                  Tag = 0
                  Left = 1
                  Top = 201
                  Width = 994
                  Height = 3
                  Cursor = crVSplit
                  Hint = ''
                  Align = alTop
                  AutoSnap = True
                  Beveled = False
                  Constraints.MaxHeight = 0
                  Constraints.MaxWidth = 0
                  Constraints.MinHeight = 0
                  Constraints.MinWidth = 0
                  MinSize = 30
                  ParentColor = True
                  ResizeStyle = rsPattern
                  Visible = True
                end
                object ibgrMain: TgsIBGrid
                  Left = 1
                  Top = 1
                  Width = 994
                  Height = 200
                  Align = alTop
                  Anchors = [akLeft, akTop, akRight]
                  TabOrder = 0
                  Expands = <>
                  Conditions = <>
                  ColumnEditors = <>
                  Aliases = <>
                  Columns = <
                    item
                      Expanded = False
                      FieldName = 'Z_USR$ROOMKEY_USR$NAME'
                      ReadOnly = False
                      Title.Caption = 'Номер'
                      Width = 130
                      Visible = True
                    end
                    item
                      Expanded = False
                      FieldName = 'USR$DATEBEGIN'
                      ReadOnly = False
                      Title.Caption = 'Занят с даты'
                      Width = 130
                      Visible = True
                    end
                    item
                      Expanded = False
                      FieldName = 'USR$DATEEND'
                      ReadOnly = False
                      Title.Caption = 'Занят по дату'
                      Width = 130
                      Visible = True
                    end
                    item
                      Expanded = False
                      FieldName = 'Z_USR$RESERVATONKEY_USR$NUMBER'
                      ReadOnly = False
                      Title.Caption = 'Бронирование'
                      Width = 130
                      Visible = True
                    end
                    item
                      Expanded = False
                      FieldName = 'Z_USR$REQUESTKEY_NUMBER'
                      ReadOnly = False
                      Title.Caption = 'Заявка'
                      Width = 124
                      Visible = True
                    end
                    item
                      Expanded = False
                      FieldName = 'ID'
                      Title.Caption = 'Идентификатор'
                      Width = -1
                      Visible = False
                    end
                    item
                      Expanded = False
                      FieldName = 'EDITIONDATE'
                      Title.Caption = 'Дата модификации'
                      Width = -1
                      Visible = False
                    end
                    item
                      Expanded = False
                      FieldName = 'USR$ROOMKEY'
                      ReadOnly = False
                      Title.Caption = 'Номер'
                      Width = -1
                      Visible = False
                    end
                    item
                      Expanded = False
                      FieldName = 'USR$RESERVATONKEY'
                      ReadOnly = False
                      Title.Caption = 'Бронирование'
                      Width = -1
                      Visible = False
                    end
                    item
                      Expanded = False
                      FieldName = 'USR$REQUESTKEY'
                      ReadOnly = False
                      Title.Caption = 'Заявка'
                      Width = -1
                      Visible = False
                    end
                    item
                      Expanded = False
                      FieldName = 'Z_USR$REQUESTKEY_DOCUMENTDATE'
                      ReadOnly = False
                      Title.Caption = 'Дата'
                      Width = -1
                      Visible = False
                    end>
                end
                object usrg_grRoomPlace: TgsIBGrid
                  Tag = 0
                  Left = 1
                  Top = 204
                  Width = 994
                  Height = 329
                  Cursor = crDefault
                  Hint = ''
                  HelpContext = 0
                  TabStop = True
                  Align = alClient
                  Anchors = [akLeft, akTop, akRight, akBottom]
                  BorderStyle = bsSingle
                  Constraints.MaxHeight = 0
                  Constraints.MaxWidth = 0
                  Constraints.MinHeight = 0
                  Constraints.MinWidth = 0
                  DataSource = usrg_dsRoomPlace
                  DefaultDrawing = True
                  DragCursor = crDrag
                  DragKind = dkDrag
                  DragMode = dmManual
                  Enabled = True
                  ImeMode = imDontCare
                  ImeName = ''
                  Options = [dgEditing, dgTitles, dgIndicator, dgColumnResize, dgColLines, dgTabs, dgConfirmDelete, dgCancelOnExit]
                  ParentBiDiMode = True
                  ParentColor = False
                  ParentCtl3D = True
                  ParentFont = True
                  ParentShowHint = True
                  PopupMenu = nil
                  ReadOnly = False
                  TabOrder = 1
                  Visible = True
                  TableColor = clWindow
                  SelectedColor = clHighlight
                  TitleColor = clBtnFace
                  RefreshType = rtCloseOpen
                  Striped = True
                  StripeOdd = 15201271
                  StripeEven = 14084071
                  InternalMenuKind = imkWithSeparator
                  Expands = <>
                  ExpandsActive = False
                  ExpandsSeparate = False
                  TitlesExpanding = False
                  Conditions = <>
                  ConditionsActive = False
                  CheckBox.DisplayField = ''
                  CheckBox.FieldName = ''
                  CheckBox.Visible = False
                  CheckBox.FirstColumn = False
                  ScaleColumns = False
                  MinColWidth = 40
                  ToolBar = nil
                  FinishDrawing = True
                  RememberPosition = True
                  SaveSettings = True
                  ColumnEditors = <>
                  Aliases = <>
                  ShowFooter = False
                  ShowTotals = True
                end
              end
            end
            object pnChoose: TPanel
              Top = 435
              Width = 996
              object pnButtonChoose: TPanel
                Left = 891
                object btnCancelChoose: TButton
                end
                object btnOkChoose: TButton
                end
                object btnDeleteChoose: TButton
                end
              end
              object ibgrChoose: TgsIBGrid
                Width = 891
                Expands = <>
                Conditions = <>
                ColumnEditors = <>
                Aliases = <>
              end
              object pnlChooseCaption: TPanel
                Width = 996
              end
            end
          end
          object alMain: TActionList
            Left = 92
            Top = 79
            object actNew: TAction
            end
            object actEdit: TAction
            end
            object actDelete: TAction
            end
            object actDuplicate: TAction
            end
            object actHlp: TAction
            end
            object actPrint: TAction
            end
            object actCut: TAction
            end
            object actCopy: TAction
            end
            object actPaste: TAction
            end
            object actCommit: TAction
            end
            object actRollback: TAction
            end
            object actMacros: TAction
            end
            object actFind: TAction
            end
            object actMainReduction: TAction
            end
            object actFilter: TAction
            end
            object actProperties: TAction
            end
            object actLoadFromFile: TAction
            end
            object actSaveToFile: TAction
            end
            object actSearchMain: TAction
            end
            object actSearchMainClose: TAction
            end
            object actOnlySelected: TAction
            end
            object actAddToSelected: TAction
            end
            object actRemoveFromSelected: TAction
            end
            object actQExport: TAction
            end
            object actMainToSetting: TAction
            end
            object actChooseOk: TAction
            end
            object actDeleteChoose: TAction
            end
            object actCopySettingsFromUser: TAction
            end
            object actSelectAll: TAction
            end
            object actUnSelectAll: TAction
            end
            object actClearSelection: TAction
            end
            object actEditInGrid: TAction
            end
            object actLinkObject: TAction
            end
            object actDistributeSettings: TAction
            end
            object actDontSaveSettings: TAction
            end
          end
          object pmMain: TPopupMenu
            Left = 130
            Top = 204
            object nNew_OLD: TMenuItem
            end
            object nEdit_OLD: TMenuItem
            end
            object nDel_OLD: TMenuItem
            end
            object nDublicate_OLD: TMenuItem
            end
            object nProperties_OLD: TMenuItem
            end
            object nQExport_OLD: TMenuItem
            end
            object nSeparator1_OLD: TMenuItem
            end
            object actCopy1_OLD: TMenuItem
            end
            object actCut1_OLD: TMenuItem
            end
            object actPaste1_OLD: TMenuItem
            end
            object nSepartor2_OLD: TMenuItem
            end
            object nFind_OLD: TMenuItem
            end
            object nReduction_OLD: TMenuItem
            end
            object nSeparator3_OLD: TMenuItem
            end
            object actAddToSelected1: TMenuItem
            end
            object actRemoveFromSelected1: TMenuItem
            end
            object sprSetting: TMenuItem
            end
            object miMainToSetting: TMenuItem
            end
          end
          object dsMain: TDataSource
            Left = 92
            Top = 204
          end
          object gdMacrosMenu: TgdMacrosMenu
            Left = 249
            Top = 111
          end
          object dsChoose: TDataSource
            Left = 153
            Top = 306
          end
          object pmFind: TPopupMenu
            Left = 17
            Top = 78
            object miRemoveFromSearch: TMenuItem
            end
          end
          object gdcAttrUserDefined: TgdcAttrUserDefined
            Left = 122
            Top = 79
          end
          object usrg_gdcRoomPlace: TgdcAttrUserDefined
            Tag = 0
            ForcedRefresh = False
            AutoCalcFields = True
            ObjectView = False
            AllowStreamedActive = False
            SubType = 'USR$SAN_RESERVEDROOMPLACE'
            MasterSource = dsMain
            MasterField = 'ID'
            DetailField = 'Parent'
            SubSet = 'ByParent'
            SetTable = ''
            NameInScript = 'gdcRoomPlace'
            Active = False
            CachedUpdates = False
            Filtered = False
            Left = 506
            Top = 321
          end
          object usrg_dsRoomPlace: TDataSource
            Tag = 0
            AutoEdit = True
            DataSet = usrg_gdcRoomPlace
            Enabled = True
            Left = 579
            Top = 323
          end
        end
        
  - 
    Properties: 
      Class: "TgdcStorageFolder"
      RUID: 147394679_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "990010_17 USER - Administrator"
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS(Tgdc_frmAttrUserDefined)"
      CURR_DATA: ~
      DATA_TYPE: "F"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T19:09:23+03:00
      BLOB_DATA: ~
  - 
    Properties: 
      Class: "TgdcStorageFolder"
      RUID: 147394680_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "147394679_806803480 USER - Administrator\\gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS(Tgdc_frmAttrUserDefined)"
      NAME: "ibgrMain(TgsIBGrid)"
      CURR_DATA: ~
      DATA_TYPE: "F"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T19:09:23+03:00
      BLOB_DATA: ~
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 147394681_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "147394680_806803480 USER - Administrator\\gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS(Tgdc_frmAttrUserDefined)\\ibgrMain(TgsIBGrid)"
      NAME: "data"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2021-07-20T19:46:40+03:00
      BLOB_DATA: !!binary > 
        VFBGMAYNR1JJRF9TVFJFQU1fNAEGBlRhaG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABghjbFdp
        bmRvdwEGBlRhaG9tYQYPY2xIaWdobGlnaHRUZXh0AvUAAggAAgEABgtjbEhpZ2hsaWdodAEGBlRh
        aG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABgljbEJ0bkZhY2UJBgkkMDBFN0YzRjcGCSQwMEQ2
        RTdFNw4ACAgOAAgOAQhFeHBhbmRlZAgJRmllbGROYW1lBhZaX1VTUiRST09NS0VZX1VTUiROQU1F
        CFJlYWRPbmx5CA1UaXRsZS5DYXB0aW9uBgXN7uzl8AVXaWR0aAJ/B1Zpc2libGUJAAEIRXhwYW5k
        ZWQICUZpZWxkTmFtZQYNVVNSJERBVEVCRUdJTghSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYMx+Dt
        //Ig8SDk4PL7BVdpZHRoA4IAB1Zpc2libGUJAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYLVVNSJERB
        VEVFTkQIUmVhZE9ubHkIDVRpdGxlLkNhcHRpb24GDcfg7f/yIO/uIOTg8vMFV2lkdGgDggAHVmlz
        aWJsZQkAAQhFeHBhbmRlZAgJRmllbGROYW1lBhdaX1VTUiRSRVFVRVNUS0VZX05VTUJFUghSZWFk
        T25seQgNVGl0bGUuQ2FwdGlvbgYGx+D/4urgBVdpZHRoAnwHVmlzaWJsZQkAAQhFeHBhbmRlZAgJ
        RmllbGROYW1lBgJJRA1UaXRsZS5DYXB0aW9uBg3I5OXt8uj06Org8u7wBVdpZHRoAlYHVmlzaWJs
        ZQkAAQhFeHBhbmRlZAgJRmllbGROYW1lBgtFRElUSU9OREFURQ1UaXRsZS5DYXB0aW9uBhDE4PLg
        IOzu5Oj06Org9ujoBVdpZHRoAnAHVmlzaWJsZQkAAQhFeHBhbmRlZAgJRmllbGROYW1lBg5VU1Ik
        UkVRVUVTVEtFWQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYGx+D/4urgBVdpZHRoAkAHVmlzaWJs
        ZQkAAQhFeHBhbmRlZAgJRmllbGROYW1lBgtVU1IkUk9PTUtFWQhSZWFkT25seQgNVGl0bGUuQ2Fw
        dGlvbgYFze7s5fAFV2lkdGgCQAdWaXNpYmxlCQABCEV4cGFuZGVkCAlGaWVsZE5hbWUGElVTUiRS
        RVNFUlZBVElPTktFWQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYMwfDu7ejw7uLg7ejlBVdpZHRo
        AkwHVmlzaWJsZQkAAQhFeHBhbmRlZAgJRmllbGROYW1lBh1aX1VTUiRSRVFVRVNUS0VZX0RPQ1VN
        RU5UREFURQhSZWFkT25seQgNVGl0bGUuQ2FwdGlvbgYExODy4AVXaWR0aAL/B1Zpc2libGUIAAEI
        RXhwYW5kZWQICUZpZWxkTmFtZQYfWl9VU1IkUkVTRVJWQVRJT05LRVlfVVNSJE5VTUJFUghSZWFk
        T25seQgNVGl0bGUuQ2FwdGlvbgYTze7s5fAg7+7k8uLl8Obk5e3o/wVXaWR0aAL/B1Zpc2libGUI
        AAAICLQeCQg=
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147394690_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS)"
      DESCRIPTION: ~
      USERGROUPNAME: "147394690_806803480"
      EDITIONDATE: 2017-05-06T19:23:37+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 147394689_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:23:37+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394687_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "147394689_806803480 Локальные макросы"
      OBJECTNAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "147394690_806803480 Отчеты(gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMS)"
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:23:37+03:00
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147394654_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS)"
      DESCRIPTION: ~
      USERGROUPNAME: "147394654_806803480"
      EDITIONDATE: 2017-05-06T19:15:45+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 147394653_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:15:44+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394513_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: ~
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "147394653_806803480 Локальные макросы"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "147394654_806803480 Отчеты(gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS)"
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:15:45+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394716_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      NAME: "usrg_grRoomPlaceOnDblClick"
      COMMENT: ~
      EVENT: "ONDBLCLICK"
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "EVENTS"
      MODULECODE: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:33:00+03:00
      DISPLAYSCRIPT: | 
        USRG_GRROOMPLACEONDBLCLICK
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAU0VOREVSBgAAAFNFTkRFUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGTlNU
        RkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub usrg_grRoomPlaceOnDblClick(ByVal Sender)
        '*** Данный код необходим для вызова встроенного обработчика ***
        '*** В случае его удаления возможно нарушение работы системы ***
          Call   Inherited(Sender, "OnDblClick", Array(Sender))
        '*** конец кода поддержки встроенного обработчика            ***
          if Sender.OwnerForm.GetComponent("usrg_gdcRoomPlace").ID > 0 then
            call Sender.OwnerForm.GetComponent("usrg_gdcRoomPlace").EditDialog ("")
          end if
        End Sub
        
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394713_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      PARENT: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      NAME: "usrg_grRoomPlace"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: ~
      OBJECTNAME: "usrg_grRoomPlace"
      OBJECTTYPE: 0
      REPORTGROUPKEY: ~
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:32:59+03:00
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394714_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394453_806803480
    Fields: 
      DISABLE: 0
      EVENTNAME: "ONDBLCLICK"
      FUNCTIONKEY: "147394716_806803480 usrg_grRoomPlaceOnDblClick"
      OBJECTKEY: "147394713_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS\\usrg_grRoomPlace"
      OBJECTNAME: "usrg_grRoomPlace"
      PARENTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      EDITIONDATE: 2017-05-06T19:33:00+03:00
  - 
    Properties: 
      Class: "TgdcPrimeTable"
      RUID: 147394491_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      BRANCHKEY: ~
      DESCRIPTION: "Занятые места в номере"
      EXTENDEDFIELDS: ~
      LISTFIELD: ~
      LNAME: "Занятые места в номере"
      LSHORTNAME: "Занятые места в номере"
      REFERENCEKEY: ~
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      EDITIONDATE: 2017-05-06T18:51:01+03:00
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394502_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "По дату"
      FIELDNAME: "USR$DATEEND"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "По дату"
      LSHORTNAME: "По дату"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T19:02:05+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394707_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "RESTRICT"
      DESCRIPTION: "Место в номере"
      FIELDNAME: "USR$PLACEKEY"
      FIELDSOURCE: "USR$HT_D_ROOMPLACEKEY"
      FIELDSOURCEKEY: "147015563_1780606072 HT. Место в номере, USR$HT_D_ROOMPLACEKEY"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Место в номере"
      LSHORTNAME: "Место в номере"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$NAME"
      REFRELATIONNAME: "USR$HT_ROOMPLACE"
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T19:30:30+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394706_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "С даты"
      FIELDNAME: "USR$DATEBEGIN"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "С даты"
      LSHORTNAME: "С даты"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T19:29:57+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcField"
      RUID: 147394495_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      ALIGNMENT: "L"
      CHARSET: ~
      COLLATION: ~
      COLWIDTH: 20
      DESCRIPTION: "Занятые номера"
      FCHARLENGTH: ~
      FFIELDTYPE: 8
      FIELDNAME: "USR$SAN_D_RESERVEDROOM"
      FLAG: ~
      FLENGTH: 4
      FORMAT: ~
      FPRECISION: 0
      FSCALE: 0
      FSUBTYPE: 0
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Занятые номера"
      READONLY: 0
      REFCONDITION: ~
      REFLISTFIELD: "USR$DATEBEGIN"
      REFLISTLNAME: "Занят с даты"
      REFLNAME: "Занятые номера"
      REFTABLE: "USR$SAN_RESERVEDROOMS"
      SEGLENGTH: ~
      SETCONDITION: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SETLISTLNAME: ~
      SETTABLE: ~
      SETTABLEKEY: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:52:51+03:00
      DISABLED: 0
      CHECKSOURCE: ~
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      NUMERATION: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394494_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "CASCADE"
      DESCRIPTION: "Номер"
      FIELDNAME: "USR$MASTERKEY"
      FIELDSOURCE: "USR$SAN_D_RESERVEDROOM"
      FIELDSOURCEKEY: "147394495_806803480 Занятые номера, USR$SAN_D_RESERVEDROOM"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Номер"
      LSHORTNAME: "Номер"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$DATEBEGIN"
      REFRELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T18:52:02+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 147394696_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: "154996723_1440956890 GLOBAL\\DFM\\Tgdc_dlgAttrUserDefined"
      NAME: "USR$SAN_RESERVEDROOMPLACE"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T21:03:39+03:00
      BLOB_DATA: | 
        object gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE: Tgdc_dlgAttrUserDefined
          HorzScrollBar.Range = 0
          VertScrollBar.Range = 0
          ActiveControl = nil
          BorderStyle = bsDialog
          ClientHeight = 221
          ClientWidth = 475
          PixelsPerInch = 96
          TextHeight = 13
          object btnAccess: TButton
            Top = 190
          end
          object btnNew: TButton
            Top = 190
          end
          object btnHelp: TButton
            Top = 190
          end
          object btnOK: TButton
            Top = 190
          end
          object btnCancel: TButton
            Top = 190
          end
          object pnlMain: TPanel
            Height = 170
            Anchors = [akLeft, akTop]
            object usrg_PageControl: TPageControl
              Tag = 0
              Left = 0
              Top = 0
              Width = 475
              Height = 170
              Cursor = crDefault
              Hint = ''
              HelpContext = 0
              ActivePage = usrg_ttsCommon
              Align = alClient
              Anchors = [akLeft, akTop, akRight, akBottom]
              Constraints.MaxHeight = 0
              Constraints.MaxWidth = 0
              Constraints.MinHeight = 0
              Constraints.MinWidth = 0
              DockSite = False
              DragCursor = crDrag
              DragKind = dkDrag
              DragMode = dmManual
              Enabled = True
              HotTrack = False
              Images = nil
              MultiLine = False
              OwnerDraw = False
              ParentBiDiMode = True
              ParentFont = True
              ParentShowHint = True
              PopupMenu = nil
              RaggedRight = False
              ScrollOpposite = False
              Style = tsTabs
              TabHeight = 0
              TabOrder = 0
              TabPosition = tpTop
              TabStop = True
              TabWidth = 0
              Visible = True
              object usrg_ttsCommon: TTabSheet
                Tag = 0
                Cursor = crDefault
                Hint = ''
                HelpContext = 0
                BorderWidth = 0
                Caption = 'Основные'
                DragMode = dmManual
                Enabled = True
                Highlighted = False
                ImageIndex = 0
                Constraints.MaxHeight = 0
                Constraints.MaxWidth = 0
                Constraints.MinHeight = 0
                Constraints.MinWidth = 0
                ParentFont = True
                ParentShowHint = True
                PopupMenu = nil
                TabVisible = True
                object usrat_gsIBLookupComboBox_USR_MASTERKEY_Label: TLabel
                  Top = 10
                end
                object usrat_gsIBLookupComboBox_USR_PLACEKEY_Label: TLabel
                  Top = 33
                end
                object usrat_xDateDBEdit_USR_DATEBEGIN_Label: TLabel
                  Top = 56
                end
                object usrat_xDateDBEdit_USR_DATEEND_Label: TLabel
                  Top = 79
                end
                object usrat_gsIBLookupComboBox_USR_RESERVATIONKEY_Label: TLabel
                  Top = 102
                end
                object usrat_gsIBLookupComboBox_USR_MASTERKEY: TgsIBLookupComboBox
                  Top = 6
                  TabOrder = 0
                end
                object usrat_gsIBLookupComboBox_USR_PLACEKEY: TgsIBLookupComboBox
                  Top = 29
                  TabOrder = 1
                end
                object usrat_xDateDBEdit_USR_DATEBEGIN: TxDateDBEdit
                  Top = 52
                  TabOrder = 2
                end
                object usrat_xDateDBEdit_USR_DATEEND: TxDateDBEdit
                  Top = 75
                  TabOrder = 3
                end
                object usrat_gsIBLookupComboBox_USR_RESERVATIONKEY: TgsIBLookupComboBox
                  Top = 98
                  TabOrder = 4
                end
              end
              object usrg_ttsInvisible: TTabSheet
                Tag = 0
                Cursor = crDefault
                Hint = ''
                HelpContext = 0
                BorderWidth = 0
                Caption = 'Атрибуты'
                DragMode = dmManual
                Enabled = True
                Highlighted = False
                ImageIndex = 0
                Constraints.MaxHeight = 0
                Constraints.MaxWidth = 0
                Constraints.MinHeight = 0
                Constraints.MinWidth = 0
                ParentFont = True
                ParentShowHint = True
                PopupMenu = nil
                TabVisible = False
                object atAttributes: TatContainer
                  Width = 467
                  Height = 142
                  object usrat_xDateDBEdit_Z_USR_MASTERKEY_USR_DATEBEGIN_Label: TLabel
                  end
                  object usrat_DBEdit_Z_USR_PLACEKEY_USR_NAME_Label: TLabel
                    Top = 31
                  end
                  object usrat_DBEdit_Z_USR_RESERVATIONKEY_USR_NUMBER_Label: TLabel
                    Top = 54
                  end
                  object usrat_xDateDBEdit_Z_USR_MASTERKEY_USR_DATEBEGIN: TxDateDBEdit
                  end
                  object usrat_DBEdit_Z_USR_PLACEKEY_USR_NAME: TDBEdit
                    Top = 27
                    TabOrder = 1
                  end
                  object usrat_DBEdit_Z_USR_RESERVATIONKEY_USR_NUMBER: TDBEdit
                    Top = 50
                    TabOrder = 2
                  end
                end
              end
            end
          end
          object alBase: TActionList
            Left = 398
            Top = 95
            object actNew: TAction
            end
            object actHelp: TAction
            end
            object actSecurity: TAction
            end
            object actOk: TAction
            end
            object actCancel: TAction
            end
            object actNextRecord: TAction
            end
            object actPrevRecord: TAction
            end
            object actApply: TAction
            end
            object actFirstRecord: TAction
            end
            object actLastRecord: TAction
            end
            object actProperty: TAction
            end
            object actCopySettingsFromUser: TAction
            end
            object actAddToSetting: TAction
            end
            object actDocumentType: TAction
            end
            object actDistributeUserSettings: TAction
            end
            object actHistory: TAction
            end
          end
          object dsgdcBase: TDataSource
            Left = 344
            Top = 159
          end
          object pm_dlgG: TPopupMenu
            Left = 152
            Top = 216
            object actSecurity1: TMenuItem
            end
            object actHistory1: TMenuItem
            end
            object N1: TMenuItem
            end
            object sepFirst: TMenuItem
            end
            object actNextRecord1: TMenuItem
            end
            object actPrevRecord1: TMenuItem
            end
            object actFirstRecord1: TMenuItem
            end
            object actLastRecord1: TMenuItem
            end
            object sepSecond: TMenuItem
            end
            object actApply1: TMenuItem
            end
            object sepThird: TMenuItem
            end
            object actProperty1: TMenuItem
            end
            object actCopySettings1: TMenuItem
            end
            object nAddToSetting1: TMenuItem
            end
          end
          object ibtrCommon: TIBTransaction
            Params.Strings = (
              'read_committed'
              'rec_version'
              'nowait')
            Left = 440
            Top = 216
          end
        end
        
  - 
    Properties: 
      Class: "TgdcReportGroup"
      RUID: 147394695_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: ~
      NAME: "Отчеты(gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE)"
      DESCRIPTION: ~
      USERGROUPNAME: "147394695_806803480"
      EDITIONDATE: 2017-05-06T19:26:11+03:00
  - 
    Properties: 
      Class: "TgdcMacrosGroup"
      RUID: 147394694_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: ~
      NAME: "Локальные макросы"
      CLASSNAME: ""
      ISGLOBAL: 0
      OBJECTNAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTPARENT: ~
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:26:10+03:00
      DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394517_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: ~
      NAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "147394694_806803480 Локальные макросы"
      OBJECTNAME: "gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "147394695_806803480 Отчеты(gdc_dlgAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE)"
      SUBTYPE: ""
      EDITIONDATE: 2017-05-06T19:26:11+03:00
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394515_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: ~
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      CLASSNAME: ""
      DESCRIPTION: ~
      MACROSGROUPKEY: "149597774_820098289 Локальные макросы"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTTYPE: 0
      REPORTGROUPKEY: "149597775_820098289 Отчеты(gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE)"
      SUBTYPE: ""
      EDITIONDATE: 2017-06-22T13:41:39+03:00
  - 
    Properties: 
      Class: "TgdcDelphiObject"
      RUID: 147394645_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      PARENT: "147275685_124484738 TgdcBase\\TgdcAttrUserDefined"
      NAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      CLASSNAME: "TgdcAttrUserDefined"
      DESCRIPTION: ~
      MACROSGROUPKEY: ~
      OBJECTNAME: ""
      OBJECTTYPE: 1
      REPORTGROUPKEY: ~
      SUBTYPE: "USR_SAN_RESERVEDROOMPLACE"
      EDITIONDATE: 2017-05-06T19:13:50+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394651_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      NAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACEGetWhereClause"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "METHOD"
      MODULECODE: "147394645_806803480 TgdcBase\\TgdcAttrUserDefined\\TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTNAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:14:17+03:00
      DISPLAYSCRIPT: | 
        TGDCATTRUSERDEFINEDUSR_SAN_RESERVEDROOMPLACEGETWHERECLAUSE
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QEAAAAU0VMRgQAAABTRUxGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEZOU1RGTFBS
      SCRIPT: | 
        Option Explicit
        Function TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACEGetWhereClause(Self)
          dim Res
          Res = Inherited(Self, "GetWhereClause", Array(Self))
        
          if Self.HasSubSet("ByParent") then
            if Res = "" then
              Res = " WHERE "
            else
              Res = Res & " AND "
            end if
            Res = Res & " z.USR$MASTERKEY = :Parent "
          end if
          
          TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACEGetWhereClause = Res
        End Function
        
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394649_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      DISABLE: 0
      EVENTNAME: "GETWHERECLAUSE"
      FUNCTIONKEY: "147394651_806803480 TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACEGetWhereClause"
      OBJECTKEY: "147394645_806803480 TgdcBase\\TgdcAttrUserDefined\\TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTNAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      PARENTNAME: "TgdcAttrUserDefined"
      EDITIONDATE: 2017-05-06T19:14:17+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394648_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      NAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACECheckSubSet"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "METHOD"
      MODULECODE: "147394645_806803480 TgdcBase\\TgdcAttrUserDefined\\TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTNAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:13:51+03:00
      DISPLAYSCRIPT: | 
        TGDCATTRUSERDEFINEDUSR_SAN_RESERVEDROOMPLACECHECKSUBSET
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QEAAAAU0VMRgQAAABTRUxGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEZOU1RQUlNU
        BwAAAEFTVUJTRVQHAAAAQVNVQlNFVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGTlNURkxQUg==
      SCRIPT: | 
        Option Explicit
        Function TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACECheckSubSet(Self, ASubSet)
        '*** Данный код необходим для вызова кода определенного в gdc-классе.***
        '*** При его удаления  возможно нарушение  правильной работы системы.***
          TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACECheckSubSet = _
            Inherited(Self, "CheckSubSet", Array(Self, ASubSet))  or (ASubSet = "ByParent")
        '***               Конец кода поддержки gdc-класса.                  ***
        End Function
        
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394646_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394491_806803480
    Fields: 
      DISABLE: 0
      EVENTNAME: "CHECKSUBSET"
      FUNCTIONKEY: "147394648_806803480 TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACECheckSubSet"
      OBJECTKEY: "147394645_806803480 TgdcBase\\TgdcAttrUserDefined\\TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      OBJECTNAME: "TgdcAttrUserDefinedUSR_SAN_RESERVEDROOMPLACE"
      PARENTNAME: "TgdcAttrUserDefined"
      EDITIONDATE: 2017-05-06T19:13:51+03:00
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147394625_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$BI_USR$SAN_RESERVEDROOMS   "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 1
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      TRIGGERNAME: "USR$BI_USR$SAN_RESERVEDROOMS"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-06T18:18:55+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS 
        BEGIN 
          IF (NEW.id IS NULL) THEN 
            NEW.id = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
        END
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147394639_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$BI_USR$SAN_RESERV2746947821"
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 1
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$BI_USR$SAN_RESERV2746947821"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-06T19:35:07+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS 
        BEGIN 
          IF (NEW.id IS NULL) THEN
            NEW.id = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
        END
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147394490_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEEND"
      INDEXNAME: "USR$SAN_X_RESERVEDROOMS_DE"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_RESERVEDROOMS_DE     "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_RESERVEDROOMS          "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-06T19:40:03+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147394489_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEBEGIN"
      INDEXNAME: "USR$SAN_X_RESERVEDROOMS_DB"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_RESERVEDROOMS_DB     "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_RESERVEDROOMS          "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-06T19:40:14+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147394778_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEEND"
      INDEXNAME: "USR$SAN_X_RESERVEDROOMPLACEDE"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_RESERVEDROOMPLACEDE  "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_RESERVEDROOMPLACE      "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-06T19:41:18+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147394777_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEBEGIN"
      INDEXNAME: "USR$SAN_X_RESERVEDROOMPLACEDB"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_RESERVEDROOMPLACEDB  "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_RESERVEDROOMPLACE      "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-06T19:41:27+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcStorageFolder"
      RUID: 147394704_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394705_806803480
    Fields: 
      PARENT: "147394679_806803480 USER - Administrator\\gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS(Tgdc_frmAttrUserDefined)"
      NAME: "usrg_grRoomPlace(TgsIBGrid)"
      CURR_DATA: ~
      DATA_TYPE: "F"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-05-06T19:23:03+03:00
      BLOB_DATA: ~
  - 
    Properties: 
      Class: "TgdcStorageValue"
      RUID: 147394705_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      PARENT: "147394704_806803480 USER - Administrator\\gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS(Tgdc_frmAttrUserDefined)\\usrg_grRoomPlace(TgsIBGrid)"
      NAME: "data"
      CURR_DATA: ~
      DATA_TYPE: "B"
      DATETIME_DATA: ~
      INT_DATA: ~
      STR_DATA: ~
      EDITIONDATE: 2017-08-08T14:26:36+03:00
      BLOB_DATA: !!binary > 
        VFBGMAYNR1JJRF9TVFJFQU1fNAEGBlRhaG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABghjbFdp
        bmRvdwEGBlRhaG9tYQYPY2xIaWdobGlnaHRUZXh0AvUAAggAAgEABgtjbEhpZ2hsaWdodAEGBlRh
        aG9tYQYMY2xXaW5kb3dUZXh0AvUAAggAAgEABgljbEJ0bkZhY2UJBgkkMDBFN0YzRjcGCSQwMEQ2
        RTdFNw4ACAgOAAgOAQhFeHBhbmRlZAgJRmllbGROYW1lBg1VU1IkREFURUJFR0lODVRpdGxlLkNh
        cHRpb24GBtEg5ODy+wVXaWR0aAOCAAdWaXNpYmxlCQABCEV4cGFuZGVkCAlGaWVsZE5hbWUGC1VT
        UiREQVRFRU5EDVRpdGxlLkNhcHRpb24GB8/uIOTg8vMFV2lkdGgDggAHVmlzaWJsZQkAAQhFeHBh
        bmRlZAgJRmllbGROYW1lBhdaX1VTUiRQTEFDRUtFWV9VU1IkTkFNRQ1UaXRsZS5DYXB0aW9uBgXM
        5fHy7gVXaWR0aAJmB1Zpc2libGUJAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYCSUQIUmVhZE9ubHkJ
        DVRpdGxlLkNhcHRpb24GDcjk5e3y6PTo6uDy7vAFV2lkdGgCVgdWaXNpYmxlCQABCEV4cGFuZGVk
        CAlGaWVsZE5hbWUGElVTUiRSRVFVRVNUTElORUtFWQ1UaXRsZS5DYXB0aW9uBgzH4P/i6uAgKO/u
        5ykFV2lkdGgCYgdWaXNpYmxlCQABCEV4cGFuZGVkCAlGaWVsZE5hbWUGC0VESVRJT05EQVRFCFJl
        YWRPbmx5CQ1UaXRsZS5DYXB0aW9uBhDE4PLgIOzu5Oj06Org9ujoBVdpZHRoAnAHVmlzaWJsZQkA
        AQhFeHBhbmRlZAgJRmllbGROYW1lBg1VU1IkTUFTVEVSS0VZDVRpdGxlLkNhcHRpb24GBc3u7OXw
        BVdpZHRoAv8HVmlzaWJsZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBh1aX1VTUiRNQVNURVJLRVlf
        VVNSJERBVEVCRUdJTg1UaXRsZS5DYXB0aW9uBgzH4O3/8iDxIOTg8vsFV2lkdGgC/wdWaXNpYmxl
        CAABCEV4cGFuZGVkCAlGaWVsZE5hbWUGDFVTUiRQTEFDRUtFWQ1UaXRsZS5DYXB0aW9uBg7M5fHy
        7iDiIO3u7OXw5QVXaWR0aAL/B1Zpc2libGUIAAEIRXhwYW5kZWQICUZpZWxkTmFtZQYbWl9VU1Ik
        UkVRVUVTVExJTkVLRVlfTlVNQkVSDVRpdGxlLkNhcHRpb24GBc3u7OXwBVdpZHRoAv8HVmlzaWJs
        ZQgAAQhFeHBhbmRlZAgJRmllbGROYW1lBh9aX1VTUiRSRVFVRVNUTElORUtFWV8yMjE0MzE3MzYz
        DVRpdGxlLkNhcHRpb24GBMTg8uAFV2lkdGgC/wdWaXNpYmxlCAAACAi9DAkI
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147394794_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "CASCADE"
      DESCRIPTION: "Бронирование"
      FIELDNAME: "USR$RESERVATIONKEY"
      FIELDSOURCE: "USR$HT_D_RESERVATIONKEY"
      FIELDSOURCEKEY: "147015737_1683050467 Hotel. Документ бронирования, USR$HT_D_RESERVATIONKEY"
      FORMAT: ~
      GDCLASSNAME: "TgdcAttrUserDefined"
      GDSUBTYPE: "USR$HT_RESERVATION"
      LNAME: "Бронирование"
      LSHORTNAME: "Бронирование"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$NUMBER"
      REFRELATIONNAME: "USR$HT_RESERVATION"
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-06T20:54:45+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147394506_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_BIU_RESERVEDROOMPLACE  "
      RDB$TRIGGER_SEQUENCE: 6
      RDB$TRIGGER_TYPE: 17
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$SAN_BIU_RESERVEDROOMPLACE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-08T22:43:17+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE ID INTEGER;
        BEGIN
          IF (UPDATING) THEN
            IF (new.USR$DATEBEGIN = old.USR$DATEBEGIN AND
                new.USR$DATEEND = old.USR$DATEEND AND
                new.USR$MASTERKEY = old.USR$MASTERKEY AND
                new.USR$PLACEKEY = old.USR$PLACEKEY) THEN
              EXIT;
        
        
          SELECT FIRST 1 rr.ID, rr.USR$DATEBEGIN, rr.USR$DATEEND
          FROM USR$SAN_RESERVEDROOMPLACE rr
          WHERE rr.ID <> new.ID
            AND rr.USR$MASTERKEY = new.USR$MASTERKEY
            AND rr.USR$PLACEKEY = new.USR$PLACEKEY
            AND rr.USR$DATEEND > new.USR$DATEBEGIN
            AND rr.USR$DATEBEGIN < new.USR$DATEEND
          INTO :ID, :DB, :DE ;
        
          IF (NOT (ID IS NULL)) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM
              'Место в номере уже занято на период ' ||
               CAST(DB AS VARCHAR(10)) || '-' || CAST(DE AS VARCHAR(10)) || '!';
        
        END
         
         
         
         
         
         
         
         
         
         
           
        
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147394477_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_BIU_RESERVEDROOMS      "
      RDB$TRIGGER_SEQUENCE: 6
      RDB$TRIGGER_TYPE: 17
      RELATIONKEY: "147394453_806803480 Занятые номера, USR$SAN_RESERVEDROOMS"
      RELATIONNAME: "USR$SAN_RESERVEDROOMS"
      TRIGGERNAME: "USR$SAN_BIU_RESERVEDROOMS"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-12T19:27:52+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE ID INTEGER;
        DECLARE ROOMNAME VARCHAR(60);
        BEGIN
          IF ((new.USR$DATEBEGIN IS NULL) OR (new.USR$DATEEND IS NULL)) THEN EXIT;
            
          IF (UPDATING) THEN
            IF (new.USR$DATEBEGIN = old.USR$DATEBEGIN AND new.USR$DATEEND = old.USR$DATEEND AND new.USR$ROOMKEY = old.USR$ROOMKEY) THEN
              EXIT;
              
        
          SELECT FIRST 1 rr.ID, rr.USR$DATEBEGIN, rr.USR$DATEEND, COALESCE(room.USR$NAME, '')
          FROM USR$SAN_RESERVEDROOMS rr
          LEFT JOIN USR$HT_NUMBER room ON room.ID = rr.USR$ROOMKEY
          WHERE rr.ID <> new.ID
            AND rr.USR$ROOMKEY = new.USR$ROOMKEY
            AND rr.USR$DATEEND  >  new.USR$DATEBEGIN
            AND rr.USR$DATEBEGIN < new.USR$DATEEND
          INTO :ID, :DB, :DE, :ROOMNAME ;
            
          IF (NOT (ID IS NULL)) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM
              'Номер ' || ROOMNAME || ' уже занят другим брониованием за ' ||
               CAST(DB AS VARCHAR(10)) || '-' || CAST(DE AS VARCHAR(10)) || '!';
        
        END
         
         
         
         
         
         
         
         
          
          
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394659_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394657_806803480
    Fields: 
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnCreate"
      COMMENT: ~
      EVENT: "ONCREATE"
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "EVENTS"
      MODULECODE: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:22:02+03:00
      DISPLAYSCRIPT: | 
        GDC_FRMATTRUSERDEFINEDUSR_SAN_RESERVEDROOMSONCREATE
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAU0VOREVSBgAAAFNFTkRFUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGTlNU
        RkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnCreate(ByVal Sender)
        '*** Данный код необходим для вызова встроенного обработчика ***
        '*** В случае его удаления возможно нарушение работы системы ***
          Call   Inherited(Sender, "OnCreate", Array(Sender))
        '*** конец кода поддержки встроенного обработчика            ***
          Sender.GetComponent("usrg_gdcRoomPlace").Close
          Sender.GetComponent("usrg_gdcRoomPlace").ReadTransaction = Sender.gdcObject.ReadTransaction
          Sender.GetComponent("usrg_gdcRoomPlace").Open
        End Sub
        
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394657_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      DISABLE: 0
      EVENTNAME: "ONCREATE"
      FUNCTIONKEY: "147394659_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnCreate"
      OBJECTKEY: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      PARENTNAME: ~
      EDITIONDATE: 2017-05-06T19:22:02+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394662_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394660_806803480
    Fields: 
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnLoadSettingsAfterCreate"
      COMMENT: ~
      EVENT: "ONLOADSETTINGSAFTERCREATE"
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "EVENTS"
      MODULECODE: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:20:49+03:00
      DISPLAYSCRIPT: | 
        GDC_FRMATTRUSERDEFINEDUSR_SAN_RESERVEDROOMSONLOADSETTINGSAFTERCREATE
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAU0VOREVSBgAAAFNFTkRFUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGTlNU
        RkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnLoadSettingsAfterCreate(ByVal Sender)
        '*** Данный код необходим для вызова встроенного обработчика ***
        '*** В случае его удаления возможно нарушение работы системы ***
          Call   Inherited(Sender, "OnLoadSettingsAfterCreate", Array(Sender))
        '*** конец кода поддержки встроенного обработчика            ***
          call Sender.LoadGrid(Sender.GetComponent("usrg_grRoomPlace"))
        End Sub
        
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394660_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      DISABLE: 0
      EVENTNAME: "ONLOADSETTINGSAFTERCREATE"
      FUNCTIONKEY: "147394662_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnLoadSettingsAfterCreate"
      OBJECTKEY: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      PARENTNAME: ~
      EDITIONDATE: 2017-05-06T19:20:49+03:00
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 147394665_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 147394663_806803480
    Fields: 
      NAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnSaveSettings"
      COMMENT: ~
      EVENT: "ONSAVESETTINGS"
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "EVENTS"
      MODULECODE: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2017-05-06T19:21:11+03:00
      DISPLAYSCRIPT: | 
        GDC_FRMATTRUSERDEFINEDUSR_SAN_RESERVEDROOMSONSAVESETTINGS
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAU0VOREVSBgAAAFNFTkRFUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGTlNU
        RkxQUg==
      SCRIPT: | 
        Option Explicit
        Sub gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnSaveSettings(ByVal Sender)
        '*** Данный код необходим для вызова встроенного обработчика ***
        '*** В случае его удаления возможно нарушение работы системы ***
          Call   Inherited(Sender, "OnSaveSettings", Array(Sender))
        '*** конец кода поддержки встроенного обработчика            ***
          call Sender.SaveGrid(Sender.GetComponent("usrg_grRoomPlace"))
        
        End Sub
        
  - 
    Properties: 
      Class: "TgdcEvent"
      RUID: 147394663_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      DISABLE: 0
      EVENTNAME: "ONSAVESETTINGS"
      FUNCTIONKEY: "147394665_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMSOnSaveSettings"
      OBJECTKEY: "147394513_806803480 gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      OBJECTNAME: "gdc_frmAttrUserDefinedUSR_SAN_RESERVEDROOMS"
      PARENTNAME: ~
      EDITIONDATE: 2017-05-06T19:21:11+03:00
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147395822_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "RESTRICT"
      DESCRIPTION: "Место в номере"
      FIELDNAME: "USR$PLACEKEY"
      FIELDSOURCE: "USR$HT_D_ROOMPLACEKEY"
      FIELDSOURCEKEY: "147015563_1780606072 HT. Место в номере, USR$HT_D_ROOMPLACEKEY"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Место в номере"
      LSHORTNAME: "Место в номере"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$NAME"
      REFRELATIONNAME: "USR$HT_ROOMPLACE"
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-08T21:32:58+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147395820_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "RESTRICT"
      DESCRIPTION: "Номер"
      FIELDNAME: "USR$ROOMKEY"
      FIELDSOURCE: "USR$HT_D_NUMBERKEY"
      FIELDSOURCEKEY: "147009413_1661751803 HT. Номер гостиницы, USR$HT_D_NUMBERKEY"
      FORMAT: ~
      GDCLASSNAME: "TgdcAttrUserDefined"
      GDSUBTYPE: "USR$HT_NUMBER"
      LNAME: "Номер"
      LSHORTNAME: "Номер"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "USR$NAME"
      REFRELATIONNAME: "USR$HT_NUMBER"
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-08T21:34:18+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147395819_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "По дату"
      FIELDNAME: "USR$DATEEND"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "По дату"
      LSHORTNAME: "По дату"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-08T21:34:28+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147395818_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "С даты"
      FIELDNAME: "USR$DATEBEGIN"
      FIELDSOURCE: "DDATE"
      FIELDSOURCEKEY: "147000160_486813904 Дата, DDATE"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "С даты"
      LSHORTNAME: "С даты"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-08T21:34:37+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147395848_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "CASCADE"
      DESCRIPTION: "Заявка (поз)"
      FIELDNAME: "USR$REQUESTLINEKEY"
      FIELDSOURCE: "USR$GS_DDOCUMENT"
      FIELDSOURCEKEY: "147035010_9802323 Документ, USR$GS_DDOCUMENT"
      FORMAT: ~
      GDCLASSNAME: "TgdcDocument"
      GDSUBTYPE: ~
      LNAME: "Заявка (поз)"
      LSHORTNAME: "Заявка (поз)"
      NULLFLAG: 1
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "NUMBER"
      REFRELATIONNAME: "GD_DOCUMENT"
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-09T20:45:39+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395868_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AU_REQUESTLINE         "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 4
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      TRIGGERNAME: "USR$SAN_AU_REQUESTLINE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-16T21:56:46+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE RRKey INTEGER;
        DECLARE OldRRKey INTEGER;
        DECLARE RRPlKey INTEGER;
        DECLARE C INTEGER;
        BEGIN
          IF ((new.USR$DATEBEGIN = old.USR$DATEBEGIN)
             AND (new.USR$DATEEND = old.USR$DATEEND)
             AND (new.USR$ROOMKEY = old.USR$ROOMKEY)
             AND (new.USR$PLACEKEY = old.USR$PLACEKEY)
             AND (new.MASTERKEY = old.MASTERKEY))THEN
          EXIT;
        
        
          /*ИД блокировки номера и места в номере*/
          SELECT rp.ID , rp.USR$MASTERKEY
          FROM USR$SAN_RESERVEDROOMPLACE rp
          WHERE rp.USR$REQUESTLINEKEY = new.DOCUMENTKEY
          INTO :RRPlKey, :RRKey;
          
          /*найдем блокировку номера.
          Старого номера, тк он мог смениться*/
          IF (RRKey IS NULL) THEN
            SELECT FIRST 1 rr.ID
            FROM USR$SAN_RESERVEDROOMS rr
            WHERE rr.USR$REQUESTKEY = old.MASTERKEY
              AND rr.USR$ROOMKEY = old.USR$ROOMKEY
              AND rr.USR$DATEBEGIN <= old.USR$DATEBEGIN
              AND rr.USR$DATEEND >= old.USR$DATEEND
            INTO :RRKey;
          
          IF (RRKey IS NULL) THEN
            SELECT FIRST 1 rr.ID
            FROM USR$SAN_RESERVEDROOMS rr
            WHERE rr.USR$REQUESTKEY = old.MASTERKEY
              AND rr.USR$ROOMKEY = old.USR$ROOMKEY
            INTO :RRKey;
        
          IF (NOT (RRKey IS NULL)) THEN
          BEGIN
            /*позже пересоздадим с тем же ид
            сейчас этот код вызовет разделение интервала, если можно разделить*/
            DELETE FROM USR$SAN_RESERVEDROOMPLACE rp WHERE rp.ID = :RRPlKey;
              
            /*а сколько мест блокировано в старом интервале
            (интервалы могли размножиться при удалении блокировки места*/
            SELECT COUNT(rp.ID)
            FROM USR$SAN_RESERVEDROOMPLACE rp
            WHERE rp.USR$MASTERKEY = :RRKey
            INTO :C;
        
            C = COALESCE(C, 0);
        
           /*если в интервале было занято только одно место (которое только что удалили),
             можно смело перебивать номер в шапке блокировки
             иначе нужно найти или создать блокировку для нового номера*/
           IF (C = 0) THEN
             DELETE FROM USR$SAN_RESERVEDROOMS r
             WHERE r.ID = :RRKey;
        
        
            RRKey = NULL;
          END
          /* если сейчас RRKey не заполнен, это может значить следующее:
          1) номер не сменился, но блокировка для него почему-то не существует
          2) номер сменился, и нужно найти блокировку нового номера, что заблокировать места в нем*/
          IF (RRKey IS NULL) THEN
            SELECT FIRST 1 rr.ID
            FROM USR$SAN_RESERVEDROOMS rr
            WHERE rr.USR$REQUESTKEY = new.MASTERKEY
              AND rr.USR$ROOMKEY = new.USR$ROOMKEY
              AND rr.USR$DATEBEGIN < new.USR$DATEEND
              AND rr.USR$DATEEND > new.USR$DATEBEGIN
            INTO :RRKey;
        
        
          /*создадим блокировку номера, если ее нет*/
          IF (RRKey IS NULL) THEN
          BEGIN
            RRKey = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
        
            INSERT INTO USR$SAN_RESERVEDROOMS (
              ID, USR$ROOMKEY, /*USR$DATEBEGIN, USR$DATEEND, */USR$REQUESTKEY)
            VALUES (
              :RRKey, new.USR$ROOMKEY, /*new.USR$DATEBEGIN, new.USR$DATEEND, */ new.MASTERKEY);
          END
          ELSE
          BEGIN
           /* UPDATE USR$SAN_RESERVEDROOMS
            SET USR$DATEBEGIN  = NULL, USR$DATEEND = NULL
            WHERE ID = :RRKey;   */
            
            /*объединяем с близкими интервалами, если надо*/
            FOR
              SELECT FIRST 1 rr.ID
              FROM USR$SAN_RESERVEDROOMS rr
              WHERE rr.USR$REQUESTKEY = new.MASTERKEY
                AND rr.USR$ROOMKEY = new.USR$ROOMKEY
                AND rr.USR$DATEBEGIN < new.USR$DATEEND
                AND rr.USR$DATEEND > new.USR$DATEBEGIN
                AND rr.ID <> :RRKey
            INTO :OldRRKey
            DO
            BEGIN
              UPDATE USR$SAN_RESERVEDROOMS rr
              SET rr.USR$DATEBEGIN  = NULL, rr.USR$DATEEND = NULL
              WHERE rr.ID = :OldRRKey;
              
              /*заблокировать выполнение SAN_RESERVEDROOMPLACE.AfterUpdate*/
              RDB$SET_CONTEXT('USER_TRANSACTION', 'SAN_RESERVEDROOMPLACE_BLOCK_AU', 1);
              
              UPDATE USR$SAN_RESERVEDROOMPLACE rp
              SET rp.USR$MASTERKEY = :RRKey
              WHERE rp.USR$MASTERKEY = :OldRRKey;
              
              RDB$SET_CONTEXT('USER_TRANSACTION', 'SAN_RESERVEDROOMPLACE_BLOCK_AU', NULL);
              
              DELETE FROM USR$SAN_RESERVEDROOMS rr
              WHERE rr.ID = :OldRRKey;
            END
          END
        
          /*блокируем место в номере*/
          IF (RRPlKey IS NULL ) THEN
            RRPlKey = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
        
          UPDATE OR INSERT INTO USR$SAN_RESERVEDROOMPLACE (
                ID, USR$MASTERKEY, USR$PLACEKEY, USR$DATEBEGIN, USR$DATEEND, USR$REQUESTLINEKEY)
          VALUES (
                :RRPlKey, :RRKey, new.USR$PLACEKEY, new.USR$DATEBEGIN, new.USR$DATEEND, new.DOCUMENTKEY)
          MATCHING(ID);
        
        END
         
         
         
         
         
         
         
         
         
         
         
         
          
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
          
         
          
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395864_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AI_REQUESTLINE_RR      "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 2
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      TRIGGERNAME: "USR$SAN_AI_REQUESTLINE_RR"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-16T06:54:45+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE RRKey INTEGER;
        BEGIN
          /*блокировка номера для заявки и номера*/
          SELECT FIRST 1 rr.ID
          FROM USR$SAN_RESERVEDROOMS rr
          WHERE rr.USR$REQUESTKEY = new.MASTERKEY
            AND rr.USR$ROOMKEY = new.USR$ROOMKEY
            AND rr.USR$DATEBEGIN < new.USR$DATEEND
            AND rr.USR$DATEEND > new.USR$DATEBEGIN
          INTO :RRKey;
          
          /*создадим блокировку номера, если ее нет*/
          IF (RRKey IS NULL) THEN
          BEGIN
            RRKey = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
            
            INSERT INTO USR$SAN_RESERVEDROOMS (
              ID, USR$ROOMKEY, USR$DATEBEGIN, USR$DATEEND, USR$REQUESTKEY)
            VALUES (
              :RRKey, new.USR$ROOMKEY, new.USR$DATEBEGIN, new.USR$DATEEND, new.MASTERKEY);
          END
          ELSE
          BEGIN
            /*UPDATE USR$SAN_RESERVEDROOMS
            SET USR$DATEBEGIN  = NULL, USR$DATEEND = NULL
            WHERE ID = :RRKey;   */
          END
          
          /*блокируем место в номере*/
          INSERT INTO USR$SAN_RESERVEDROOMPLACE (
                 USR$MASTERKEY, USR$PLACEKEY, USR$DATEBEGIN, USR$DATEEND, USR$REQUESTLINEKEY)
          VALUES (
                 :RRKey, new.USR$PLACEKEY, new.USR$DATEBEGIN, new.USR$DATEEND, new.DOCUMENTKEY);
        
        END
         
         
         
            
         
         
          
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395853_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AU_RESERVEDROOMPLACE   "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 4
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$SAN_AU_RESERVEDROOMPLACE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T22:47:27+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE IsBlocked INTEGER;
        BEGIN
        
          IF   ((new.USR$DATEBEGIN = old.USR$DATEBEGIN)
            AND (new.USR$DATEEND = old.USR$DATEEND)
            AND (new.USR$MASTERKEY = old.USR$MASTERKEY) ) THEN EXIT;
          IsBlocked = RDB$GET_CONTEXT('USER_TRANSACTION', 'SAN_RESERVEDROOMPLACE_BLOCK_AU');
          IF (new.USR$MASTERKEY <> old.USR$MASTERKEY AND (IsBlocked IS NULL)) THEN
          BEGIN
            SELECT
              MIN(rp.USR$DATEBEGIN) AS DB,
              MAX(rp.USR$DATEEND) AS DE
            FROM USR$SAN_RESERVEDROOMPLACE rp
            WHERE rp.USR$MASTERKEY = old.USR$MASTERKEY
            INTO :DB, :DE;
        
            UPDATE USR$SAN_RESERVEDROOMS rr
               SET rr.USR$DATEBEGIN = :DB,
                   rr.USR$DATEEND = :DE
            WHERE rr.ID = old.USR$MASTERKEY;
            DB = NULL;
            DE = NULL;
          END
          
          SELECT
            MIN(rp.USR$DATEBEGIN) AS DB,
            MAX(rp.USR$DATEEND) AS DE
          FROM USR$SAN_RESERVEDROOMPLACE rp
          WHERE rp.USR$MASTERKEY = new.USR$MASTERKEY
          INTO :DB, :DE;
        
          UPDATE USR$SAN_RESERVEDROOMS rr
             SET rr.USR$DATEBEGIN = :DB,
                 rr.USR$DATEEND = :DE
          WHERE rr.ID = new.USR$MASTERKEY;
        END
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395847_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AI_RESERVEDROOMPLACE   "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 2
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$SAN_AI_RESERVEDROOMPLACE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T22:49:10+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        BEGIN
        
          SELECT
            MIN(rp.USR$DATEBEGIN) AS DB,
            MAX(rp.USR$DATEEND) AS DE
          FROM USR$SAN_RESERVEDROOMPLACE rp
          WHERE rp.USR$MASTERKEY = new.USR$MASTERKEY
          INTO :DB, :DE;
        
          UPDATE USR$SAN_RESERVEDROOMS rr
             SET rr.USR$DATEBEGIN = :DB,
                 rr.USR$DATEEND = :DE
          WHERE rr.ID = new.USR$MASTERKEY;
          
          
        END
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395835_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_BIU_REQUESTLINE        "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 17
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      TRIGGERNAME: "USR$SAN_BIU_REQUESTLINE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-05-13T05:53:18+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE ReqDB DATE;
        DECLARE ReqDE DATE;
        DECLARE RoomKey INTEGER;
        DECLARE PlaceKey INTEGER;
        DECLARE RoomKeyForPlace INTEGER;
        DECLARE IsAdd INTEGER;
        DECLARE PlaceName VARCHAR(60);
        DECLARE DelKey INTEGER;
        DECLARE StateKey INTEGER;
        BEGIN
          /*IF (NOT  ((new.USR$DATEBEGIN IS NULL)
             OR (new.USR$DATEEND IS NULL)
             OR (new.USR$ROOMKEY IS NULL)
             OR (new.USR$PLACEKEY IS NULL))) THEN
          EXIT;    */
          
        
          IF (NOT (new.USR$RESERVATIONKEY IS NULL)) THEN
          BEGIN
            SELECT
              r.USR$DATEBEGIN,
              r.USR$DATEEND,
              req.USR$DATEBEGIN,
              req.USR$DATEEND,
              r.USR$NUMBERKEY,
              r.USR$ROOMPLACEKEY,
              COALESCE(r.USR$STATEKEY, 0)
            FROM USR$HT_RESERVATION r
            LEFT JOIN USR$SAN_REQUEST req ON req.DOCUMENTKEY = r.USR$REQUESTKEY
            WHERE r.ID = new.USR$RESERVATIONKEY
            INTO :DB, :DE, :ReqDB, :ReqDE, :RoomKey, :PlaceKey, :StateKey;
            
            /*статус - отменена*/
            SELECT ID FROM GD_RUID WHERE XID = 147020052 AND DBID = 1683050467 INTO :DelKey;
            
            IF (StateKey = COALESCE(DelKey,0) ) THEN EXIT;
          END
        
          IF (new.USR$DATEBEGIN IS NULL) THEN
            new.USR$DATEBEGIN = COALESCE(DB, ReqDB, current_date);
        
          IF (new.USR$DATEEND IS NULL) THEN
            new.USR$DATEEND = COALESCE(DE, ReqDE, current_date);
        
          IF (new.USR$ROOMKEY IS NULL) THEN
             new.USR$ROOMKEY = :RoomKey;
        
          IF (new.USR$DATEBEGIN >= new.USR$DATEEND) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM 'дата начала должна быть меньше даты окончания!' ;
        
          RoomKeyForPlace = NULL;
          IF (NOT (new.USR$PLACEKEY IS NULL)) THEN
          BEGIN
            /*если указано место. найти, какому номеру оно принадлежит*/
            SELECT p.USR$ROOMKEY
            FROM USR$HT_ROOMPLACE p
            WHERE p.ID = new.USR$PLACEKEY
            INTO :RoomKeyForPlace;
        
            /*указано место, но не указан номер - возьмем номер из места*/
            IF ( new.USR$ROOMKEY IS NULL) THEN  new.USR$ROOMKEY = RoomKeyForPlace;
        
            /*если новое место в номере принадлежит другому номеру - обнулить место*/
            IF ( RoomKeyForPlace <> new.USR$ROOMKEY) THEN
              new.USR$PLACEKEY = NULL;
        
          END
        
          /*контроль заполненности и корректности номера и места*/
          IF (new.USR$ROOMKEY IS NULL) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM 'Номер должен быть заполнен!' ;
        
          /*если место не выбрано, выбрать из свободных*/
          IF (new.USR$PLACEKEY IS NULL) THEN
            new.USR$PLACEKEY = PlaceKey;
        
          IF (NOT (new.USR$PLACEKEY IS NULL)) THEN
            IF( EXISTS(SELECT nst.ID
                       FROM USR$SAN_RESERVEDROOMPLACE nst
                       WHERE nst.USR$PLACEKEY = new.USR$PLACEKEY
                         AND nst.USR$REQUESTLINEKEY <> new.DOCUMENTKEY
                         AND nst.USR$DATEEND > new.USR$DATEBEGIN
                         AND nst.USR$DATEBEGIN < new.USR$DATEEND ) ) THEN
                new.USR$PLACEKEY = NULL;
        
          IF (new.USR$PLACEKEY IS NULL) THEN
            SELECT FIRST 1 p.ID,  COALESCE(p.USR$ISADDITIONAL, 0), p.USR$NAME
            FROM  USR$HT_ROOMPLACE p
            WHERE p.USR$ROOMKEY =  new.USR$ROOMKEY
              AND (NOT EXISTS(SELECT nst.ID
                              FROM USR$SAN_RESERVEDROOMPLACE nst
                                  WHERE nst.USR$PLACEKEY = p.ID
                                    AND nst.USR$REQUESTLINEKEY <>  new.DOCUMENTKEY
                                    AND nst.USR$DATEEND > new.USR$DATEBEGIN
                                    AND nst.USR$DATEBEGIN < new.USR$DATEEND ) )
            ORDER BY 2, 3
            INTO new.USR$PLACEKEY, :IsAdd, :PlaceName  ;
        
          IF  (new.USR$PLACEKEY IS NULL) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM 'нет свободных мест в номере!' ;
        END
        
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147400336_810532285
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEEND"
      INDEXNAME: "USR$SAN_X_REQUESTLINE_DE"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_REQUESTLINE_DE       "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_REQUESTLINE            "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-13T01:56:18+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147400335_810532285
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$DATEBEGIN"
      INDEXNAME: "USR$SAN_X_REQUESTLINE_DB"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_REQUESTLINE_DB       "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_REQUESTLINE            "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-13T01:56:29+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcGenerator"
      RUID: 147400366_810532285
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      GENERATORNAME: "USR$SUN_G_RESERVATION_NUM"
      RDB$GENERATOR_ID: 25
      RDB$GENERATOR_NAME: "USR$SUN_G_RESERVATION_NUM      "
      EDITIONDATE: 2017-05-13T02:21:39+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147400421_810532285
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "Общий ИД"
      FIELDNAME: "USR$NUM"
      FIELDSOURCE: "DINTEGER"
      FIELDSOURCEKEY: "147000096_486813904 Целое число, DINTEGER"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Общий ИД"
      LSHORTNAME: "Общий ИД"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147015430_1683050467 Бронирование, USR$HT_RESERVATION"
      RELATIONNAME: "USR$HT_RESERVATION"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-13T05:58:38+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147402422_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "ИД поз. заявки (для синхронизации блокировки мест)"
      FIELDNAME: "USR$REQUESTLINEKEY"
      FIELDSOURCE: "DINTEGER"
      FIELDSOURCEKEY: "147000096_486813904 Целое число, DINTEGER"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "ИД поз. заявки"
      LSHORTNAME: "ИД поз. заявки"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147015430_1683050467 Бронирование, USR$HT_RESERVATION"
      RELATIONNAME: "USR$HT_RESERVATION"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-05-15T15:59:05+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395054_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$HT_BIU_RESERVATION_PL      "
      RDB$TRIGGER_SEQUENCE: 6
      RDB$TRIGGER_TYPE: 17
      RELATIONKEY: "147015430_1683050467 Бронирование, USR$HT_RESERVATION"
      RELATIONNAME: "USR$HT_RESERVATION"
      TRIGGERNAME: "USR$HT_BIU_RESERVATION_PL"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-11-21T23:39:51+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE RoomKeyForPlace INTEGER;
        DECLARE IsAdd INTEGER;
        DECLARE PlaceName VARCHAR(60);
        DECLARE ReqLineKey INTEGER;
        DECLARE EarlyCheckOutKey INTEGER;
        BEGIN
        
          IF (new.USR$NUM IS NULL) THEN
            new.USR$NUM = GEN_ID(USR$SUN_G_RESERVATION_NUM, 1);
            
          IF (UPDATING) THEN
          BEGIN
            SELECT FIRST 1 DOCUMENTKEY
            FROM USR$SAN_REQUESTLINE
            WHERE USR$RESERVATIONKEY = new.ID
            INTO :ReqLineKey;
            
            IF (new.USR$REQUESTLINEKEY IS NULL) THEN new.USR$REQUESTLINEKEY = :ReqLineKey;
          END
          ELSE
            ReqLineKey = new.USR$REQUESTLINEKEY;
            
         /*
          IF (NOT ReqLineKey IS NULL) THEN
            IF (EXISTS(
              SELECT *
              FROM USR$HT_RESERVATION r
              WHERE r.USR$REQUESTLINEKEY =  :ReqLineKey
                AND r.ID <> new.ID
                 )) THEN
              ReqLineKey = NULL;  */
        
        
          RoomKeyForPlace = NULL;
          IF (NOT (new.USR$ROOMPLACEKEY IS NULL)) THEN
          BEGIN
          
          
            /*если указано место. найти, какому номеру оно принадлежит*/
            SELECT p.USR$ROOMKEY
            FROM USR$HT_ROOMPLACE p
            WHERE p.ID = new.USR$ROOMPLACEKEY
            INTO :RoomKeyForPlace;
            
            /*указано место, но не указан номер - возьмем номер из места*/
            IF ( new.USR$NUMBERKEY IS NULL) THEN  new.USR$NUMBERKEY = RoomKeyForPlace;
        
            /*если новое место в номере принадлежит другому номеру - обнулить место*/
            IF ( RoomKeyForPlace <> new.USR$NUMBERKEY) THEN
              new.USR$ROOMPLACEKEY = NULL;
        
            /*проверить, что место в номере не занято*/
            IF ((INSERTING ) OR (UPDATING AND (new.USR$ROOMPLACEKEY <> old.USR$ROOMPLACEKEY))) THEN
            BEGIN
        
        
        
              IF (NOT (ReqLineKey IS NULL)) THEN
              BEGIN
                IF( EXISTS(SELECT nst.ID
                           FROM USR$SAN_RESERVEDROOMPLACE nst
                          WHERE nst.USR$PLACEKEY = new.USR$ROOMPLACEKEY
                            AND nst.USR$REQUESTLINEKEY <> :ReqLineKey
                            AND nst.USR$DATEEND > new.USR$DATEBEGIN
                            AND nst.USR$DATEBEGIN < new.USR$DATEEND ) ) THEN
                  new.USR$ROOMPLACEKEY = NULL;
              END
              ELSE
              BEGIN
                IF( EXISTS(SELECT nst.ID
                           FROM USR$SAN_RESERVEDROOMPLACE nst
                          WHERE nst.USR$PLACEKEY = new.USR$ROOMPLACEKEY
                            AND nst.USR$DATEEND > new.USR$DATEBEGIN
                            AND nst.USR$DATEBEGIN < new.USR$DATEEND ) ) THEN
                  new.USR$ROOMPLACEKEY = NULL;
              END
            END
          END
          
          /*контроль заполненности и корректности номера и места*/
          IF (new.USR$NUMBERKEY IS NULL) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM 'Номер должен быть заполнен!' ;
            
          IF (ReqLineKey IS NULL) THEN ReqLineKey = -1;
        
          /*если место не выбрано, выбрать из свободных*/
          IF (new.USR$ROOMPLACEKEY IS NULL) THEN
          BEGIN
            SELECT FIRST 1 p.ID, COALESCE(p.USR$ISADDITIONAL, 0), p.USR$NAME
            FROM  USR$HT_ROOMPLACE p
            WHERE p.USR$ROOMKEY =  new.USR$NUMBERKEY
              AND (NOT EXISTS(SELECT nst.ID
                              FROM USR$SAN_RESERVEDROOMPLACE nst
                                  WHERE nst.USR$PLACEKEY = p.ID
                                    AND nst.USR$REQUESTLINEKEY <> :ReqLineKey
                                    AND nst.USR$DATEEND > new.USR$DATEBEGIN
                                    AND nst.USR$DATEBEGIN < new.USR$DATEEND) )
            ORDER BY 2,3
            INTO new.USR$ROOMPLACEKEY, :IsAdd, :PlaceName   ;
            
            IF (IsAdd IS NULL) THEN IsAdd = 0;
            new.USR$ISADDITIONALPLACE = IsAdd;
          END
          IF  (new.USR$ROOMPLACEKEY IS NULL) THEN
            EXCEPTION USR$SAN_E_BLOCKROOM 'нет свободных мест в номере!' ;
            
            
          IF    (UPDATING
             AND ( NOT new.USR$STATEKEY IS NULL)
             AND new.USR$DATEENDPLANNED IS NULL) THEN
          BEGIN
            /*статус - выселена досрочно*/
            SELECT ID FROM GD_RUID WHERE XID = 147491476 AND DBID = 809241643 INTO :EarlyCheckOutKey;
            
            /* дата запланированного выезда. Запоминаем ее при досрочном выезде*/
            IF    (new.USR$STATEKEY = EarlyCheckOutKey ) THEN new.USR$DATEENDPLANNED = old.USR$DATEEND;
          END
        END
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
          
         
         
         
         
         
          
         
           
         
         
         
         
         
         
         
         
          
         
         
          
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147402425_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$REQUESTLINEKEY"
      INDEXNAME: "USR$HT_X_RESERVATION_RLK"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$HT_X_RESERVATION_RLK       "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$HT_RESERVATION             "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147015430_1683050467 Бронирование, USR$HT_RESERVATION"
      RELATIONNAME: "USR$HT_RESERVATION"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2017-05-15T17:13:29+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcStoredProc"
      RUID: 147405884_812879283
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      PROCEDURENAME: "USR$SAN_P_RESERVEDROOMPLACE_INT"
      EDITIONDATE: 2017-05-17T23:02:56+03:00
      PROCEDURESOURCE: | 
        CREATE OR ALTER PROCEDURE USR$SAN_P_RESERVEDROOMPLACE_INT (
            MASTERKEY INTEGER)
        RETURNS ( 
            DB DATE,
            DE DATE)
         AS
        DECLARE IntDB DATE;
        DECLARE IntDE DATE;
        BEGIN 
          DE = NULL;
          FOR
            SELECT
              rp.USR$DATEBEGIN,
              rp.USR$DATEEND
            FROM USR$SAN_RESERVEDROOMPLACE rp
            WHERE rp.USR$MASTERKEY = :MasterKey
            ORDER BY 1,2
            INTO :IntDB, :IntDE
          DO
           IF (NOT (DE IS NULL)) THEN  /*первый проход - ничего не делаем*/
           BEGIN
             IF (DE <= IntDB) THEN
             BEGIN
               SUSPEND;
               DB = IntDB;
               DE = IntDE;
             END
             ELSE
               IF (DE < IntDE) THEN
                 DE = IntDE;
             END
           ELSE
           BEGIN
             DB = IntDB;
             DE = IntDE;
           END
           
           /*вернуть результаты последнего прохода*/
           IF (NOT (DE IS NULL)) THEN
           BEGIN
             IF (DE < IntDE) THEN
               DE = IntDE;
             SUSPEND;
           END
        END
      RDB$DESCRIPTION: | 
        занятые интервалы в USR$SAN_RESERVEDROOMPLACE . Используется при удалении записи для разделения интервалов
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147395856_806993203
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AD_RESERVEDROOMPLACE   "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 6
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$SAN_AD_RESERVEDROOMPLACE"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T22:49:00+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE AfterRRKey INTEGER;
        DECLARE CountRRLineKey INTEGER;
        DECLARE RoomKey INTEGER;
        DECLARE RequestKey INTEGER;
        DECLARE MinDB DATE;
        DECLARE MaxDE DATE;
        DECLARE IntDB DATE;
        DECLARE IntDE DATE;
        BEGIN
        
        
          SELECT rr.USR$ROOMKEY, rr.USR$REQUESTKEY
          FROM USR$SAN_RESERVEDROOMS rr
          WHERE rr.ID = old.USR$MASTERKEY
          INTO :RoomKey, :RequestKey;
        
          IF (RoomKey IS NULL) THEN EXIT;
        
          SELECT
            MIN(rp.USR$DATEBEGIN) AS DB,
            MAX(rp.USR$DATEEND) AS DE
          FROM USR$SAN_RESERVEDROOMPLACE rp
          WHERE rp.USR$MASTERKEY = old.USR$MASTERKEY
          INTO :MinDB, :MaxDE;
          
          DB = NULL;
          DE = NULL;
        
          /*цикл по интервалам, на которые можно разделить исходный интервал*/
          FOR
            SELECT DB, DE
            FROM USR$SAN_P_RESERVEDROOMPLACE_INT( old.USR$MASTERKEY)
            INTO :IntDB, :IntDE
          DO
          BEGIN
            IF ( NOT (DB IS NULL) ) THEN /*в первый проход ничего не делаем */
            BEGIN
        
              /*можно разделить reservedrooms на две части*/
              AfterRRKey = GEN_ID(USR$SUN_G_RESERVEDROOM, 1);
              
              /*укорачиваем слева существующий интервал*/
              UPDATE USR$SAN_RESERVEDROOMS rr
                 SET rr.USR$DATEBEGIN = :DE,
                       rr.USR$DATEEND = :MaxDE
               WHERE rr.ID = old.USR$MASTERKEY;
              
              
              /*создаем новый интервал*/
              INSERT INTO USR$SAN_RESERVEDROOMS (
                ID, USR$ROOMKEY, USR$DATEBEGIN, USR$DATEEND, USR$REQUESTKEY)
              VALUES (
                :AfterRRKey, :RoomKey, :DB, :DE, :RequestKey);
        
              /*заблокировать выполнение SAN_RESERVEDROOMPLACE.AfterUpdate*/
              RDB$SET_CONTEXT('USER_TRANSACTION', 'SAN_RESERVEDROOMPLACE_BLOCK_AU', 1);
        
              /*перепривязать блокировки мест к новому интервалу*/
              UPDATE USR$SAN_RESERVEDROOMPLACE rp
              SET rp.USR$MASTERKEY = :AfterRRKey
              WHERE rp.USR$MASTERKEY = old.USR$MASTERKEY
                AND rp.USR$DATEBEGIN >= :DB
                AND rp.USR$DATEEND <= :DE;
        
              RDB$SET_CONTEXT('USER_TRANSACTION', 'SAN_RESERVEDROOMPLACE_BLOCK_AU', NULL);
        
            END
            DB = IntDB;
            DE = IntDE;
          END
          /* последний проход*/
          IF (NOT (DB IS NULL)) THEN
            UPDATE USR$SAN_RESERVEDROOMS rr
            SET rr.USR$DATEBEGIN = :DB,
                rr.USR$DATEEND = :DE
            WHERE rr.ID = old.USR$MASTERKEY;
            
          /*удалить пустые блокировки номера*/
         SElECT
           COUNT(rp.ID)
         FROM USR$SAN_RESERVEDROOMPLACE rp
         WHERE rp.USR$MASTERKEY = old.USR$MASTERKEY
         INTO :CountRRLineKey ;
         
         IF (CountRRLineKey IS NULL) THEN CountRRLineKey = 0;
         IF (CountRRLineKey = 0) THEN
           DELETE FROM USR$SAN_RESERVEDROOMS WHERE ID = old.USR$MASTERKEY;
        END
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147406586_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AU_REQUEST_DEL         "
      RDB$TRIGGER_SEQUENCE: 2
      RDB$TRIGGER_TYPE: 4
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      TRIGGERNAME: "USR$SAN_AU_REQUEST_DEL"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-07-18T09:51:53+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DelKey INTEGER;
        DECLARE SettledKey INTEGER;
        DECLARE EvictedKey INTEGER;
        BEGIN
          IF (COALESCE(new.USR$STATEKEY , 0) = COALESCE(old.USR$STATEKEY, 0)) THEN  EXIT;
          IF (new.USR$STATEKEY IS NULL) THEN EXIT;
        
          /*статус - отменена*/
          SELECT ID FROM GD_RUID WHERE XID = 147020052 AND DBID = 1683050467 INTO :DelKey;
          
          IF (new.USR$STATEKEY <> DelKey ) THEN EXIT;
          
          UPDATE USR$HT_RESERVATION res
          SET res.USR$STATEKEY = :DelKey
          WHERE res.USR$REQUESTKEY = new.DOCUMENTKEY;
          
          DELETE FROM USR$SAN_RESERVEDROOMS WHERE USR$REQUESTKEY = new.DOCUMENTKEY;
          
        END
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147430141_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: ~
      FIELDNAME: "USR$BYQUOTA"
      FIELDSOURCE: "DBOOLEAN"
      FIELDSOURCEKEY: "147000135_486813904 Логическое, DBOOLEAN"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Создана по квоте"
      LSHORTNAME: "Создана по квоте"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-07-13T18:05:31+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: | 
        DEFAULT '0'
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147430149_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: "RESTRICT"
      DESCRIPTION: "Клиент(квота)"
      FIELDNAME: "USR$QUOTA_CONTACTKEY"
      FIELDSOURCE: "USR$INV_DCONT"
      FIELDSOURCEKEY: "147012439_486813904 Контакт, USR$INV_DCONT"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Клиент(квота)"
      LSHORTNAME: "Клиент(квота)"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: "NAME"
      REFRELATIONNAME: "GD_CONTACT"
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2017-07-13T19:08:01+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147430145_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_BU_REQUEST             "
      RDB$TRIGGER_SEQUENCE: 0
      RDB$TRIGGER_TYPE: 3
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      TRIGGERNAME: "USR$SAN_BU_REQUEST"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2017-07-13T20:01:03+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE QuotaKey INTEGER;
        BEGIN
          IF (COALESCE(new.USR$STATEKEY , 0) = COALESCE(old.USR$STATEKEY, 0)) THEN  EXIT;
          
           /*статус - квота*/
          SELECT ID FROM GD_RUID WHERE XID = 147023417 AND DBID = 704999368 INTO :QuotaKey;
          IF (QuotaKey IS NULL) THEN EXIT;
        
          IF ( old.USR$STATEKEY = QuotaKey ) THEN
          BEGIN
            new.USR$BYQUOTA = 1;
            new.USR$QUOTA_CONTACTKEY = old.USR$CONTACTKEY;
          END
        END
  - 
    Properties: 
      Class: "TgdcTableField"
      RUID: 147502972_953823374
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      ALIGNMENT: "L"
      COLWIDTH: 20
      CROSSFIELD: ~
      CROSSFIELDKEY: ~
      CROSSTABLE: ~
      CROSSTABLEKEY: ~
      DELETERULE: ~
      DESCRIPTION: "Дата реактирования"
      FIELDNAME: "USR$EDITIONDATE"
      FIELDSOURCE: "DTIMESTAMP"
      FIELDSOURCEKEY: "147000167_31587988 Дата и время, DTIMESTAMP"
      FORMAT: ~
      GDCLASSNAME: ~
      GDSUBTYPE: ~
      LNAME: "Дата реактирования"
      LSHORTNAME: "Дата реактирования"
      NULLFLAG: ~
      READONLY: 0
      REFCROSSRELATION: ~
      REFLISTFIELD: ~
      REFRELATIONNAME: ~
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      RELATIONTYPE: "T"
      SEMCATEGORY: ~
      SETLISTFIELD: ~
      SETLISTFIELDKEY: ~
      SOURCENULLFLAG: ~
      STRINGLENGTH: ~
      VISIBLE: 1
      EDITIONDATE: 2018-01-15T18:47:44+03:00
      COMPUTED_VALUE: ~
      DEFSOURCE: ~
      OBJECTS: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147394810_806803480
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$HT_AIU_RESERVATION_RR      "
      RDB$TRIGGER_SEQUENCE: 6
      RDB$TRIGGER_TYPE: 18
      RELATIONKEY: "147015430_1683050467 Бронирование, USR$HT_RESERVATION"
      RELATIONNAME: "USR$HT_RESERVATION"
      TRIGGERNAME: "USR$HT_AIU_RESERVATION_RR"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T22:57:13+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DelKey INTEGER;
        DECLARE CheckOutKey INTEGER;
        DECLARE ReqLKey INTEGER;
        DECLARE MasterKey INTEGER;
        BEGIN
           IF (new.USR$DATEEND <> old.USR$DATEEND) THEN
              UPDATE USR$SAN_MEDICAL_HISTORY
              SET USR$ISSUEDATE = (SELECT DATEEND FROM USR$SAN_P_GETRACEDATES (new.ID))
              WHERE USR$ISSUEDATE IS NULL AND DOCUMENTKEY = (SELECT FIRST 1 SC.USR$MEDHISTORYKEY FROM USR$SAN_SANATORIUMCARD SC WHERE SC.USR$PERMITKEY = new.ID);
        
          SELECT FIRST 1 DOCUMENTKEY, MASTERKEY
          FROM USR$SAN_REQUESTLINE WHERE USR$RESERVATIONKEY = new.ID
          INTO :ReqLKey, :MasterKey;
        
          IF (NOT MasterKey IS NULL) THEN
            UPDATE USR$SAN_REQUEST SET USR$EDITIONDATE = current_timestamp
            WHERE DOCUMENTKEY = :MasterKey;
        
          IF (COALESCE(new.USR$STATEKEY , 0) <> COALESCE(old.USR$STATEKEY, 0)) THEN
            IF (NOT (new.USR$STATEKEY IS NULL)) THEN
            BEGIN
              /*статус - отменена*/
              SELECT ID FROM GD_RUID WHERE XID = 147020052 AND DBID = 1683050467 INTO :DelKey;
        
              IF (new.USR$STATEKEY = DelKey ) THEN
              BEGIN
        
                DELETE FROM USR$SAN_RESERVEDROOMPLACE WHERE USR$REQUESTLINEKEY = :ReqLKey;
                EXIT;
              END
            END
        
        
          /* временный костыль для досрочно выселенных заявок*/
          IF (UPDATING) THEN
          BEGIN
            /*статус - выселена*/
            SELECT ID FROM GD_RUID WHERE XID = 147020054 AND DBID = 1683050467 INTO :CheckOutKey;
            IF   ((new.USR$DATEBEGIN = old.USR$DATEBEGIN)
              AND (new.USR$DATEEND = old.USR$DATEEND)
              AND (new.USR$NUMBERKEY = old.USR$NUMBERKEY)
              AND (new.USR$ROOMPLACEKEY = old.USR$ROOMPLACEKEY)
              AND (new.USR$STATEKEY = :CheckOutKey)) THEN EXIT;
          END
          /*закомментировала, потому что при добавлении брони по груп. заявке USR$RESERVATIONKEY еще не присоен и не происходит обновление дат в позициях заявки
          IF   ((new.USR$DATEBEGIN = old.USR$DATEBEGIN)
            AND (new.USR$DATEEND = old.USR$DATEEND)
            AND (new.USR$NUMBERKEY = old.USR$NUMBERKEY)
            AND (new.USR$ROOMPLACEKEY = old.USR$ROOMPLACEKEY)
            AND (NOT(new.USR$REQUESTLINEKEY IS NULL))) THEN EXIT;   */
          /*синхронизация с позицией заявки,
            тк она отвечает за блокировку номеров*/
          UPDATE USR$SAN_REQUESTLINE reql
          SET reql.USR$DATEBEGIN = new.USR$DATEBEGIN,
              reql.USR$DATEEND = new.USR$DATEEND,
              reql.USR$ROOMKEY = new.USR$NUMBERKEY,
              reql.USR$PLACEKEY = new.USR$ROOMPLACEKEY
          WHERE reql.USR$RESERVATIONKEY = new.ID;
        END
        
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147399079_809241643
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AIUD_REQUESTLINE_DD    "
      RDB$TRIGGER_SEQUENCE: 1
      RDB$TRIGGER_TYPE: 114
      RELATIONKEY: "147188920_779589892 Заявка(позиция), USR$SAN_REQUESTLINE"
      RELATIONNAME: "USR$SAN_REQUESTLINE"
      TRIGGERNAME: "USR$SAN_AIUD_REQUESTLINE_DD"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T19:41:30+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE DB DATE;
        DECLARE DE DATE;
        DECLARE ReqID INTEGER;
        DECLARE CountNight INTEGER;
        BEGIN
        
          IF (DELETING) THEN
            ReqID = old.MASTERKEY;
          ELSE
            ReqID = new.MASTERKEY;
            
          UPDATE USR$SAN_REQUEST rr
          SET rr.USR$EDITIONDATE = current_timestamp
          WHERE rr.DOCUMENTKEY = :ReqID;
            
          /*растянуть даты в заявке*/
          IF (UPDATING) THEN
            IF (old.USR$DATEBEGIN = new.USR$DATEBEGIN AND old.USR$DATEEND = new.USR$DATEEND AND old.MASTERKEY = new.MASTERKEY) THEN
              EXIT;
              
        
          SELECT
            MIN(reql.USR$DATEBEGIN) AS DB,
            MAX(reql.USR$DATEEND) AS DE
          FROM USR$SAN_REQUESTLINE reql
          WHERE reql.MASTERKEY = :ReqID
          INTO :DB, :DE;
        
          IF (NOT ((DB IS NULL) OR (DE IS NULL))) THEN
          BEGIN
            CountNight = DE - DB;
            UPDATE USR$SAN_REQUEST rr
               SET rr.USR$DATEBEGIN = :DB,
                   rr.USR$DATEEND = :DE,
                   rr.USR$COUNTNIGHT = :CountNight
            WHERE rr.DOCUMENTKEY = :ReqID;
          END
        END
          
         
         
          
          
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147502975_953823374
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_BIU_REQUEST            "
      RDB$TRIGGER_SEQUENCE: 1
      RDB$TRIGGER_TYPE: 17
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      TRIGGERNAME: "USR$SAN_BIU_REQUEST"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T18:56:14+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        BEGIN
          new.USR$EDITIONDATE = current_timestamp;
        END
  - 
    Properties: 
      Class: "TgdcIndex"
      RUID: 147502981_953823374
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      FIELDSLIST: "USR$EDITIONDATE"
      INDEXNAME: "USR$SAN_X_REQUEST_ED"
      INDEX_INACTIVE: 0
      RDB$FOREIGN_KEY: ~
      RDB$INDEX_NAME: "USR$SAN_X_REQUEST_ED           "
      RDB$INDEX_TYPE: 0
      RDB$RELATION_NAME: "USR$SAN_REQUEST                "
      RDB$SEGMENT_COUNT: 1
      RELATIONKEY: "147188917_779589892 Заявка, USR$SAN_REQUEST"
      RELATIONNAME: "USR$SAN_REQUEST"
      UNIQUE_FLAG: 0
      EDITIONDATE: 2018-01-15T23:00:26+03:00
      RDB$DESCRIPTION: ~
  - 
    Properties: 
      Class: "TgdcTrigger"
      RUID: 147502980_953823374
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      RDB$FLAGS: 1
      RDB$TRIGGER_INACTIVE: 0
      RDB$TRIGGER_NAME: "USR$SAN_AIUD_RESERVEDROOMPL_ED "
      RDB$TRIGGER_SEQUENCE: 1
      RDB$TRIGGER_TYPE: 114
      RELATIONKEY: "147394491_806803480 Занятые места в номере, USR$SAN_RESERVEDROOMPLACE"
      RELATIONNAME: "USR$SAN_RESERVEDROOMPLACE"
      TRIGGERNAME: "USR$SAN_AIUD_RESERVEDROOMPL_ED"
      TRIGGER_INACTIVE: 0
      EDITIONDATE: 2018-01-15T22:49:27+03:00
      RDB$DESCRIPTION: ~
      RDB$TRIGGER_SOURCE: | 
        AS
        DECLARE ID INTEGER;
        DECLARE MasterKey INTEGER;
        BEGIN
          /*чтобы перебился эдишндэйт в шапке*/
          IF (DELETING) THEN
            ID = old.USR$REQUESTLINEKEY;
          ELSE
            ID = new.USR$REQUESTLINEKEY;
            
          IF (ID IS NULL) THEN EXIT;
          
          SELECT MASTERKEY FROM USR$SAN_REQUESTLINE  WHERE DOCUMENTKEY = :ID
          INTO :MasterKey;
          
          IF (MasterKey IS NULL) THEN EXIT;
          UPDATE USR$SAN_REQUEST SET USR$EDITIONDATE = current_timestamp WHERE DOCUMENTKEY = :MasterKey ;
        END
          