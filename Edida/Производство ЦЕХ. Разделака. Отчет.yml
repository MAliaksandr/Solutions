%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 152553946_1162798582
  Name: "Производство ЦЕХ. Разделака. Отчет"
  Caption: "Производство ЦЕХ. Разделака. Отчет"
  Version: "1.0.0.1"
  Optional: False
  Internal: True
  MD5: AC703FB5F6817FD51E19AE6A18415503
Uses: 
  - "147068733_311980179 GS new. Общепит бэк. Документы. Разделка туш"
Objects: 
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 152553792_1162798582
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 152553647_1162798582
    Fields: 
      NAME: "Производство ЦЕХ. Разделка туш"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2019-03-20T12:44:26+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="43544,5129508565" ReportOptions.Description.Text="" ReportOptions.LastChange="43544,5129508565" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2000000020446174615365743D2247494E2220446174615365744E616D653D2247494E2200010C2200000020446174615365743D22474F55542220446174615365744E616D653D22474F55542200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="215,9" PaperHeight="279,4" PaperSize="1" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="49,13389" Left="0" Top="18,89765" Width="740,409927">
              <TfrxMemoView Name="Memo1" Left="0" Top="3,77953" Width="740,78788" Height="37,7953" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РћС‚С‡РµС‚ РїСЂРѕ РїСЂРѕРёР·РІРѕРґСЃС‚РІСѓ РЅР° РїРѕРґСЂР°Р·РґРµР»РµРЅРёРё Р¦Р•РҐ &#13;&#10;Р·Р° РїРµСЂРёРѕРґ c [TITLE.&#34;BeginDate&#34;] РїРѕ [TITLE.&#34;EndDate&#34;]"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="3,77953" Left="0" Top="128,50402" Width="740,409927"/>
            <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="64,25201" Left="0" ParentFont="False" Top="154,96073" Width="740,409927" Child="Child1" ColumnWidth="0" ColumnGap="0" DataSet="GOUT" DataSetName="GOUT" PrintIfDetailEmpty="True" RowCount="0">
              <TfrxMemoView Name="Memo2" Left="0" Top="26,45671" Width="283,46475" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ "/>
              <TfrxMemoView Name="Memo3" Left="283,46475" Top="26,45671" Width="113,3859" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ"/>
              <TfrxMemoView Name="Memo4" Left="396,85065" Top="26,45671" Width="113,3859" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РЎСѓРјРјР°"/>
              <TfrxMemoView Name="Memo5" Left="0,77953" Top="7,11812" Width="510,23655" Height="18,89765" ShowHint="False" Color="15000804" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="2" ParentFont="False" Text="РР·СЂР°СЃС…РѕРґРѕРІР°РЅРѕ"/>
              <TfrxMemoView Name="Memo6" Left="0" Top="45,35436" Width="283,46475" Height="18,89765" ShowHint="False" DataField="GOODNAME" DataSet="GOUT" DataSetName="GOUT" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[GOUT.&#34;GOODNAME&#34;]"/>
              <TfrxMemoView Name="Memo7" Left="283,46475" Top="45,35436" Width="113,3859" Height="18,89765" ShowHint="False" DataField="QOUT" DataSet="GOUT" DataSetName="GOUT" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[GOUT.&#34;QOUT&#34;]"/>
              <TfrxMemoView Name="Memo8" Left="396,85065" Top="45,35436" Width="113,3859" Height="18,89765" ShowHint="False" DataField="SUMOUT" DataSet="GOUT" DataSetName="GOUT" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[GOUT.&#34;SUMOUT&#34;]"/>
            </TfrxMasterData>
            <TfrxChild Name="Child1" Height="45,35436" Left="0" Top="241,88992" Width="740,409927">
              <TfrxMemoView Name="Memo9" Left="275,90569" Top="26,45671" Width="234,33086" Height="18,89765" ShowHint="False" Color="-2147483633" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ "/>
              <TfrxMemoView Name="Memo10" Left="510,23655" Top="26,45671" Width="113,3859" Height="18,89765" ShowHint="False" Color="-2147483633" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ"/>
              <TfrxMemoView Name="Memo11" Left="623,62245" Top="26,45671" Width="113,3859" Height="18,89765" ShowHint="False" Color="-2147483633" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РЎСѓРјРјР°"/>
              <TfrxMemoView Name="Memo15" Left="275,90569" Top="7,55906" Width="461,10266" Height="18,89765" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" Frame.Typ="15" ParentFont="False" Text="РџСЂРѕРёР·РІРµРґРµРЅРѕ"/>
            </TfrxChild>
            <TfrxDetailData Name="DetailData1" Height="15,11812" Left="0" Top="309,92146" Width="740,409927" ColumnWidth="0" ColumnGap="0" DataSet="GIN" DataSetName="GIN" RowCount="0">
              <TfrxMemoView Name="Memo12" Left="275,90569" Top="0" Width="234,33086" Height="15,11812" ShowHint="False" DataField="GOODNAME" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[GIN.&#34;GOODNAME&#34;]"/>
              <TfrxMemoView Name="Memo13" Left="510,23655" Top="0" Width="113,3859" Height="15,11812" ShowHint="False" DataField="QIN" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[GIN.&#34;QIN&#34;]"/>
              <TfrxMemoView Name="Memo14" Left="623,62245" Top="0" Width="113,3859" Height="15,11812" ShowHint="False" DataField="SUMIN" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[GIN.&#34;SUMIN&#34;]"/>
            </TfrxDetailData>
            <TfrxFooter Name="Footer1" Height="15,11812" Left="0" Top="347,71676" Width="740,409927">
              <TfrxMemoView Name="Memo16" Left="275,90569" Top="0" Width="234,33086" Height="15,11812" ShowHint="False" Color="15790320" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="РРўРћР“Рћ:"/>
              <TfrxMemoView Name="Memo17" Left="510,23655" Top="0" Width="113,3859" Height="15,11812" ShowHint="False" Color="15790320" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;GIN.&#34;QIN&#34;&#62;,DetailData1)]"/>
              <TfrxMemoView Name="Memo18" Left="623,62245" Top="0" Width="113,3859" Height="15,11812" ShowHint="False" Color="15790320" DataSet="GIN" DataSetName="GIN" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;GIN.&#34;SUMIN&#34;&#62;,DetailData1)]"/>
            </TfrxFooter>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 152553648_1162798582
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 152553647_1162798582
    Fields: 
      NAME: "rp_Main147038026_349443673152553648_1162798582"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "147030050_348847816 gdc_frmInvDocument147030029_348847816"
      OBJECTNAME: "gdc_frmInvDocument147030029_348847816"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2019-03-20T12:44:28+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN147038026_349443673152553648_1162798582
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QGAAAAUEVSSU9EBgAAAM/l8Oju5AAAAAAAAAAAAAAAAAwAAAAAAAAAAAIAAABeUkZO
        U1RGTFBS
      SCRIPT: | 
        function rp_Main147038026_349443673152553648_1162798582(period)
        
          BaseQueryList.Clear
          dim q, q1
          set q = BaseQueryList.Query(BaseQueryList.Add("GOUT",FALSE))
          q.SQL = _
            "/* РАСХОД ПО РАЗДЕЛКЕ ЗА ПЕРИОД*/ " & _
            "SELECT " & _
            "M.GOODKEY, " & _
            "G.NAME AS GOODNAME, " & _
            "SUM(M.Q) AS QOUT, " & _
            "SUM(M.sumout) AS SUMOUT " & _
            "FROM ( " & _
            "    SELECT " & _
            "    C.GOODKEY, " & _
            "    CHL.OUTQUANTITY AS Q, " & _
            "    sum(ROUND(C.USR$INV_COSTACCNCU * CHL.OUTQUANTITY,2))  AS sumout " & _
            "    FROM GD_DOCUMENT D " & _
            "    JOIN USR$MN_CHOPPING CH ON CH.DOCUMENTKEY = D.ID " & _
            "    LEFT JOIN USR$MN_CHOPPINGLINE CHL ON D.ID  =  CHL.MASTERKEY AND CHL.OUTQUANTITY>0 " & _
            "    LEFT JOIN INV_CARD C ON C.ID  =  CHL.FROMCARDKEY " & _
            "    WHERE " & _
            "    D.DOCUMENTDATE BETWEEN :DB AND :DE " & _
            "    GROUP BY 1,2 ) m " & _
            "LEFT JOIN GD_GOOD G  ON G.ID  =  M.GOODKEY " & _
            "GROUP BY 1,2 "
            q.ParamByName("DB").asDateTime = period(0)
            q.ParamByName("DE").asDateTime = period(1)
            q.Open
        
        
          set q1 = BaseQueryList.Query(BaseQueryList.Add("Gin",FALSE))
          q1.SQL = _
            "/* ПОСТУПЛЕНИЕ ПО РАЗДЕЛКЕ*/ " & _
            "SELECT " & _
            "M.OUTGOODKEY, " & _
            "M.GOODKEY, " & _
            "G.NAME AS GOODNAME, " & _
            "SUM(M.Q) AS QIN, " & _
            "SUM(M.sumIN) AS SUMIN " & _
            "FROM ( " & _
            "   SELECT " & _
            "      COUT.GOODKEY AS OUTGOODKEY, " & _
            "      C.GOODKEY, " & _
            "      CHL.INQUANTITY AS Q, " & _
            "    SUM(ROUND(C.USR$INV_COSTACCNCU* CHL.INQUANTITY,2))  AS sumIN " & _
            "    FROM GD_DOCUMENT D " & _
            "    JOIN USR$MN_CHOPPING CH ON CH.DOCUMENTKEY = D.ID " & _
            "    LEFT JOIN USR$MN_CHOPPINGLINE CHL ON D.ID  =  CHL.MASTERKEY AND CHL.INQUANTITY>0 " & _
            "    LEFT JOIN INV_CARD C ON C.ID  =  CHL.FROMCARDKEY " & _
            "    LEFT JOIN USR$MN_CHOPPINGLINE CHLOUT ON CHLOUT.DOCUMENTKEY  =  C.USR$INV_ADDLINEKEY " & _
            "    LEFT JOIN INV_CARD Cout ON Cout.ID  =  CHLOUT.FROMCARDKEY " & _
            "    WHERE " & _
            "    C.GOODKEY IS NOT NULL AND " & _
            "    D.DOCUMENTDATE BETWEEN :DB AND :DE " & _
            "   /* AND COUT.GOODKEY = :OUTGOODKEY*/ " & _
            "    GROUP BY 1,2,3 ) M " & _
            "LEFT JOIN GD_GOOD G  ON G.ID  =  m.GOODKEY " & _
            "GROUP BY 1,2,3 " & _
            "ORDER BY G.NAME "
            q1.ParamByName("DB").asDateTime = period(0)
            q1.ParamByName("DE").asDateTime = period(1)
            q1.Open
            
          call BaseQueryList.AddMasterDetail("GOUT", "GOODKEY", "Gin", "OUTGOODKEY;GOODNAME")
             
         ' set qcon = BaseQueryList.Query(BaseQueryList.Add("comp",0))
        '  qcon.SQL = "SELECT con.name, p.NICKNAME, p.rank FROM gd_contact con JOIN gd_people p on con.id = p.contactkey WHERE id = :id "
        '  qcon.ParamByName("id").AsInteger = Contactkey(0)
        '  qcon.Open
        '
        '
        '  set qbuh = BaseQueryList.Query(BaseQueryList.Add("buh",0))
        '  qbuh.SQL = "SELECT con.name, p.NICKNAME, p.rank FROM gd_contact con JOIN gd_people p on con.id = p.contactkey WHERE id = :id "
        '  qbuh.ParamByName("id").AsInteger = buhkey(0)
        '  qbuh.Open
        '
        '  set qMatOtv = BaseQueryList.Query(BaseQueryList.Add("MatOtv",0))
        '  qMatOtv.SQL = "SELECT con.name, p.NICKNAME, p.rank FROM gd_contact con JOIN gd_people p on con.id = p.contactkey WHERE id = :id "
        '  qMatOtv.ParamByName("id").AsInteger = MatOtvKey(0)
        '  qMatOtv.Open
        
          dim Title
          set Title = BaseQueryList.Query(BaseQueryList.Add("Title", 1))
          call Title.AddField("BeginDate", "ftDate", 0, False)
          call Title.AddField("EndDate", "ftDate", 0, False)
          Title.Open
          Title.Insert
          Title.FieldByName("BeginDate").AsDateTime = period(0)
          Title.FieldByName("EndDate").AsDateTime = period(1)
          Title.Post
        
          set rp_Main147038026_349443673152553648_1162798582 = BaseQueryList
          
        end function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 152553647_1162798582
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "Произодство ЦЕХ"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: ~
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "152553648_1162798582 rp_Main147038026_349443673152553648_1162798582"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147030056_348847816 Отчеты(gdc_frmInvDocument147030029_348847816)"
      SERVERKEY: ~
      TEMPLATEKEY: "152553792_1162798582 Производство ЦЕХ. Разделка туш"
      EDITIONDATE: 2019-03-20T12:44:28+03:00