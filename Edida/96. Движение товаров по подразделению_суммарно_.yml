%YAML 1.1
--- 
StructureVersion: "1.0"
Properties: 
  RUID: 167529382_1652141406
  Name: "96. Движение товаров по подразделению(суммарно)"
  Caption: "96. Движение товаров по подразделению "
  Version: "1.0.0.2"
  Optional: False
  Internal: True
  MD5: 3E58A22C71C6B81A1D5585732D11778A
Uses: 
  - "147978914_215642201 Торговля - evt_object"
Objects: 
  - 
    Properties: 
      Class: "TgdcTemplate"
      RUID: 167529322_1652141406
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 167529312_1652141406
    Fields: 
      NAME: "96.Движение товаров по подразделению(суммарно)"
      DESCRIPTION: ~
      TEMPLATETYPE: "FR4"
      EDITIONDATE: 2021-07-17T11:34:59+03:00
      TEMPLATEDATA: | 
        <?xml version="1.0" encoding="utf-8"?>
        <Tgs_fr4SingleReport Version="4.15.13" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="43584,4481242014" ReportOptions.Description.Text="" ReportOptions.LastChange="43584,4481242014" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2E00000020446174615365743D224445504152544D454E542220446174615365744E616D653D224445504152544D454E542200010C1C00000020446174615365743D22512220446174615365744E616D653D22512200010C2400000020446174615365743D225449544C452220446174615365744E616D653D225449544C45220000095661726961626C65730100055374796C650100">
          <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
          <TfrxReportPage Name="Page1" PaperWidth="215,9" PaperHeight="279,4" PaperSize="1" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
            <TfrxReportTitle Name="ReportTitle1" Height="45,35436" Left="0" Top="18,89765" Width="740,409927">
              <TfrxMemoView Name="Memo1" Left="0" Top="3,77953" Width="740,78788" Height="41,57483" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Р”РІРёР¶РµРЅРёРµ С‚РѕРІР°СЂРѕРІ РїРѕ РїРѕРґСЂР°Р·РґРµР»РµРЅРёСЋ [DEPARTMENT.&#34;NAME&#34;]&#13;&#10;Р·Р° РїРµСЂРёРѕРґ СЃ [TITLE.&#34;BeginDate&#34;] РїРѕ [TITLE.&#34;EndDate&#34;]"/>
            </TfrxReportTitle>
            <TfrxHeader Name="Header1" Height="41,57483" Left="0" Top="124,72449" Width="740,409927">
              <TfrxMemoView Name="Memo3" Left="0" Top="3,77953" Width="340,1577" Height="37,7953" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ"/>
              <TfrxMemoView Name="Memo4" Left="396,85065" Top="22,67718" Width="52,91342" Height="18,89765" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
              <TfrxMemoView Name="Memo5" Left="340,17347" Top="3,77953" Width="56,69295" Height="37,7953" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР°"/>
              <TfrxMemoView Name="Memo2" Left="449,76407" Top="22,67718" Width="71,81107" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°"/>
              <TfrxMemoView Name="Memo16" Left="396,85065" Top="3,77953" Width="124,72449" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћС‚РіСЂСѓР¶РµРЅРѕ"/>
              <TfrxMemoView Name="Memo17" Left="521,57514" Top="22,67718" Width="52,91342" Height="18,89765" ShowHint="False" Color="15790320" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
              <TfrxMemoView Name="Memo18" Left="574,48856" Top="22,67718" Width="71,81107" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°"/>
              <TfrxMemoView Name="Memo19" Left="521,57514" Top="3,77953" Width="124,72449" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’РѕР·РІСЂР°С‚"/>
            </TfrxHeader>
            <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="188,9765" Width="740,409927" ColumnWidth="0" ColumnGap="0" DataSetName="Q" RowCount="0">
              <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="340,1577" Height="18,89765" ShowHint="False" DataField="GOODNAME" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;GOODNAME&#34;]"/>
              <TfrxMemoView Name="Memo7" Left="396,85065" Top="0" Width="52,91342" Height="18,89765" ShowHint="False" Color="15790320" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;GMOVE&#34;]"/>
              <TfrxMemoView Name="Memo8" Left="340,17347" Top="0" Width="56,69295" Height="18,89765" ShowHint="False" DataField="SELLCOST" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;SELLCOST&#34;]"/>
              <TfrxMemoView Name="Memo9" Left="449,76407" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;Q.&#34;GMOVE&#34;&#62;*&#60;Q.&#34;SELLCOST&#34;&#62;]"/>
              <TfrxMemoView Name="Memo20" Left="521,57514" Top="0" Width="52,91342" Height="18,89765" ShowHint="False" Color="15790320" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Q.&#34;GRET&#34;]"/>
              <TfrxMemoView Name="Memo21" Left="574,48856" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;Q.&#34;GRET&#34;&#62;*&#60;Q.&#34;SELLCOST&#34;&#62;]"/>
            </TfrxMasterData>
            <TfrxFooter Name="Footer1" Height="26,45671" Left="0" Top="230,55133" Width="740,409927">
              <TfrxMemoView Name="Memo12" Left="0" Top="0" Width="396,85065" Height="26,45671" ShowHint="False" DataSetName="Q" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" VAlign="vaBottom" Text="РС‚РѕРіРѕ:"/>
              <TfrxMemoView Name="Memo13" Left="396,85065" Top="0" Width="52,91342" Height="26,45671" ShowHint="False" Color="15790320" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="[SUM(&#60;Q.&#34;GMOVE&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo10" Left="449,76407" Top="0" Width="71,81107" Height="26,45671" ShowHint="False" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="[SUM(&#60;Q.&#34;GMOVE&#34;&#62;*&#60;Q.&#34;SELLCOST&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo22" Left="521,57514" Top="0" Width="52,91342" Height="26,45671" ShowHint="False" Color="15790320" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="[SUM(&#60;Q.&#34;GRET&#34;&#62;,MasterData1)]"/>
              <TfrxMemoView Name="Memo23" Left="574,48856" Top="0" Width="71,81107" Height="26,45671" ShowHint="False" DataSetName="Q" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="[SUM(&#60;Q.&#34;GRET&#34;&#62;*&#60;Q.&#34;SELLCOST&#34;&#62;,MasterData1)]"/>
            </TfrxFooter>
          </TfrxReportPage>
        </Tgs_fr4SingleReport>
        
  - 
    Properties: 
      Class: "TgdcFunction"
      RUID: 167529313_1652141406
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
      HeadObject: 167529312_1652141406
    Fields: 
      NAME: "rp_Main152554775_1162798582167529313_1652141406"
      COMMENT: ~
      EVENT: ~
      FUNCTIONTYPE: ~
      GROUPNAME: ~
      INHERITEDRULE: 0
      LANGUAGE: "VBScript"
      LOCALNAME: ~
      MODIFYDATE: ~
      MODULE: "REPORTMAIN"
      MODULECODE: "1010001_17 APPLICATION"
      OBJECTNAME: "APPLICATION"
      OWNERNAME: ~
      PUBLICFUNCTION: 1
      SHORTCUT: ~
      USEDEBUGINFO: 0
      EDITIONDATE: 2021-07-17T11:59:36+03:00
      DISPLAYSCRIPT: | 
        RP_MAIN152554775_1162798582167529313_1652141406
        
      ENTEREDPARAMS: !!binary > 
        U0xQUlBSU1QEAAAAREVQVA0AAADP7uTw4Ofk5evl7ejlCgAAAGdkX2NvbnRhY3QEAAAAbmFtZQIA
        AABpZAcPAAAAY29udGFjdHR5cGUgPSA0AAAAAAIAAABeUkZOU1RQUlNUBgAAAFBFUklPRAYAAADP
        5fDo7uQAAAAAAAAAAAAAAAAMAAAAAAAAAAACAAAAXlJGTlNUUFJTVAIAAABHRw0AAADD8PPv7+Ag
        8u7i4PDgDAAAAGdkX2dvb2Rncm91cAQAAABuYW1lAgAAAGlkBwAAAAAAAAAAAgAAAF5BRk5TVEZM
        UFI=
      SCRIPT: | 
        Option Explicit
        Function rp_Main152554775_1162798582167529313_1652141406(dept, period, gg)
          BaseQueryList.Clear
          
          Dim q
          Set q = BaseQueryList.Query(BaseQueryList.Add("q", 0))
          q.SQL = _
            " select " & _
            " m.SELLCOST, " & _
            " m.GOODNAME, " & _
            " sum(m.GSPIS) as GSPIS, " & _
            " sum(m.PRODIUS) as PRODIUS, " & _
            " sum(m.GMOVE) as GMOVE, " & _
            " sum(m.GRET) as GRET " & _
            " from (SELECT " & _
            "    TODEPKEY, " & _
            "    fromdep, " & _
            "    ACCCOSTCARD, " & _
            "    SELLCOST, " & _
            "    GOODNAME, " & _
            "    GSPIS, " & _
            "    PRODIUS, " & _
            "    GMOVE, " & _
            "    GRET " & _
            " FROM USR$P_GETMOVEBYDEPT(:dept, :todept, :db,:de, :gg) " & _
            " where TODEPKEY<><RUID xID=""147047656"" dbID=""1087494377""/>) m " & _
            " group by 1,2 " & _
            " ORDER BY GOODNAME, SELLCOST "
        
          q.ParamByName("dept").asInteger = dept(0)
          q.ParamByName("todept").asInteger = 0
          q.ParamByName("db").asDateTime =period(0)
          q.ParamByName("de").asDateTime =period(1)
          q.ParamByName("gg").asInteger =gg(0)
          q.Open
          
          Dim Dep
          Set Dep = BaseQueryList.Query(BaseQueryList.Add("Department", 0))
          Dep.SQL = _
          "SELECT NAME FROM GD_CONTACT WHERE ID = " & dept(0)
          Dep.Open
          
          dim title
          set title = BaseQueryList.Query(BaseQueryList.Add("title", 1))
          call title.AddField("BeginDate", "ftDateTime", 0, 0)
          call title.AddField("EndDate", "ftDateTime", 0, 0)
          title.OPen
          title.Edit
          Title.FieldBYNAme("BeginDate").AsDateTime = period(0)
          Title.FieldBYNAme("EndDate").AsDateTime = period(1)
          title.Post
        
          Set rp_Main152554775_1162798582167529313_1652141406 = BaseQueryList
        End Function
        
  - 
    Properties: 
      Class: "TgdcReport"
      RUID: 167529312_1652141406
      AlwaysOverwrite: False
      DontRemove: False
      IncludeSiblings: False
    Fields: 
      NAME: "96. Движение товаров по подразделению(суммарно)"
      DESCRIPTION: ~
      DISPLAYINMENU: 1
      EVENTFORMULAKEY: ~
      FOLDERKEY: "147012342_52143670 Исследователь\\01. Общепит\\03. Производство"
      FRQREFRESH: 1
      GLOBALREPORTKEY: ~
      ISLOCALEXECUTE: 1
      ISREBUILD: 1
      MAINFORMULAKEY: "167529313_1652141406 rp_Main152554775_1162798582167529313_1652141406"
      MODALPREVIEW: 0
      PARAMFORMULAKEY: ~
      PREVIEW: 1
      REPORTGROUPKEY: "147094279_157767347 Отчеты по общепиту"
      SERVERKEY: ~
      TEMPLATEKEY: "167529322_1652141406 96.Движение товаров по подразделению(суммарно)"
      EDITIONDATE: 2021-07-17T11:59:36+03:00